!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()})(window,(function(){return (function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)})([(function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageEventToChild=t.waitForMessageQueue=t.sendMessageToParent=t.uninitializeCommunication=t.initializeCommunication=t.Communication=void 0;var o=n(4),i=n(7),a=n(3),s=function(){};t.Communication=s;var c=(function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e})();function l(e,t,n){t instanceof Function?n=t:t instanceof Array&&(r=t);var r;t=s.parentWindow,e=(function(e,t){return{id:c.nextMessageId++,func:e,timestamp:Date.now(),args:t||[]}})(e,r);i.GlobalVars.isFramelessWindow?s.currentWindow&&s.currentWindow.nativeInterface&&s.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(e)):(r=f(t),t&&r?t.postMessage(e,r):d(t).push(e)),n&&(c.callbacks[e.id]=n)}function u(e){var t,n;e&&e.data&&"object"==typeof e.data&&(function(e,t){return(!s.currentWindow||e!==s.currentWindow)&&(s.currentWindow&&s.currentWindow.location&&t&&t===s.currentWindow.location.origin||!!(o.validOriginRegExp.test(t.toLowerCase())||i.GlobalVars.additionalValidOriginsRegexp&&i.GlobalVars.additionalValidOriginsRegexp.test(t.toLowerCase())))})(t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin)&&(function(e,t){i.GlobalVars.isFramelessWindow||s.parentWindow&&!s.parentWindow.closed&&e!==s.parentWindow?s.childWindow&&!s.childWindow.closed&&e!==s.childWindow||(s.childWindow=e,s.childOrigin=t):(s.parentWindow=e,s.parentOrigin=t),s.parentWindow&&s.parentWindow.closed&&(s.parentWindow=null,s.parentOrigin=null),s.childWindow&&s.childWindow.closed&&(s.childWindow=null,s.childOrigin=null),m(s.parentWindow),m(s.childWindow)}(t,n),t===s.parentWindow?p(e):t===s.childWindow&&(function(e){var t,n;"id"in e.data&&"func"in e.data&&(t=e.data,e=(n=(0,a.callHandler)(t.func,t.args))[0],n=n[1],e&&void 0!==n?g(t.id,Array.isArray(n)?n:[n]):l(t.func,t.args,(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];s.childWindow&&(e=n.pop(),g(t.id,n,e))})))})(e))}function p(e){var t,n;"id"in e.data&&"number"==typeof e.data.id?(n=e.data,(t=c.callbacks[n.id])&&(t.apply(null,r(r([],n.args,!0),[n.isPartialResponse],!1)),(function(e){return!0===e.data.isPartialResponse})(e)||delete c.callbacks[n.id])):"func"in e.data&&"string"==typeof e.data.func&&(n=e.data,(0,a.callHandler)(n.func,n.args))}function d(e){return e===s.parentWindow?c.parentMessageQueue:e===s.childWindow?c.childMessageQueue:[]}function f(e){return e===s.parentWindow?s.parentOrigin:e===s.childWindow?s.childOrigin:null}function m(e){for(var t=f(e),n=d(e);e&&t&&0<n.length;)e.postMessage(n.shift(),t)}function g(e,t,n){var r=s.childWindow;t=(function(e,t,n){return{id:e,args:t||[],isPartialResponse:n}})(e,t,n),n=f(r);r&&n&&r.postMessage(t,n)}t.initializeCommunication=function(e,t){c.messageListener=function(e){return u(e)},s.currentWindow=s.currentWindow||window,s.parentWindow=s.currentWindow.parent!==s.currentWindow.self?s.currentWindow.parent:s.currentWindow.opener,(s.parentWindow||t)&&s.currentWindow.addEventListener("message",c.messageListener,!1),s.parentWindow||(i.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=p);try{s.parentOrigin="*",l("initialize",[o.version],e)}finally{s.parentOrigin=null}},t.uninitializeCommunication=function(){s.currentWindow.removeEventListener("message",c.messageListener,!1),s.parentWindow=null,s.parentOrigin=null,s.childWindow=null,s.childOrigin=null,c.parentMessageQueue=[],c.childMessageQueue=[],c.nextMessageId=0,c.callbacks={}},t.sendMessageToParent=l,t.waitForMessageQueue=function(e,t){var n=s.currentWindow.setInterval((function(){0===d(e).length&&(clearInterval(n),t())}),100)},t.sendMessageEventToChild=function(e,t){var n=s.childWindow;e=(function(e,t){return{func:e,args:t||[]}})(e,t),t=f(n);n&&t?n.postMessage(e,t):d(n).push(e)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processAdditionalValidOrigins=t.isApiSupportedOnMobile=t.isHostClientMobile=t.isAPISupportedByPlatform=t.ensureInitialized=void 0;var r=n(2),o=n(6),i=n(4),a=n(7),s=n(5);function c(e){return void 0===e&&(e=i.defaultSDKVersionForCompatCheck),e=(0,s.compareSDKVersions)(a.GlobalVars.clientSupportedSDKVersion,e),!isNaN(e)&&0<=e}function l(){return a.GlobalVars.hostClientType==r.HostClientType.android||a.GlobalVars.hostClientType==r.HostClientType.ios}t.ensureInitialized=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!a.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized");if(a.GlobalVars.frameContext&&e&&0<e.length){for(var n=!1,r=0;r<e.length;r++)if(e[r]===a.GlobalVars.frameContext){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+a.GlobalVars.frameContext+"' context")}},t.isAPISupportedByPlatform=c,t.isHostClientMobile=l,t.isApiSupportedOnMobile=function(e){return void 0===e&&(e=i.defaultSDKVersionForCompatCheck),l()?c(e)?null:{errorCode:o.ErrorCode.OLD_PLATFORM}:{errorCode:o.ErrorCode.NOT_SUPPORTED_ON_PLATFORM}},t.processAdditionalValidOrigins=function(e){e=a.GlobalVars.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&i.userOriginUrlValidationRegExp.test(e)})));var t={};e=e.filter((function(e){return!t[e]&&(t[e]=!0)}));a.GlobalVars.additionalValidOrigins=e,0<a.GlobalVars.additionalValidOrigins.length?a.GlobalVars.additionalValidOriginsRegexp=(0,s.generateRegExpFromUrls)(a.GlobalVars.additionalValidOrigins):a.GlobalVars.additionalValidOriginsRegexp=null}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelType=t.TaskModuleDimension=t.UserTeamRole=t.TeamType=t.FrameContexts=t.HostClientType=void 0,(function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"})(t.HostClientType||(t.HostClientType={})),(function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"})(t.FrameContexts||(t.FrameContexts={})),(function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"})(t.TeamType||(t.TeamType={})),(function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"})(t.UserTeamRole||(t.UserTeamRole={})),(function(e){e.Large="large",e.Medium="medium",e.Small="small"})(t.TaskModuleDimension||(t.TaskModuleDimension={})),(function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"})(t.ChannelType||(t.ChannelType={}))}),(function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerFocusEnterHandler=t.registerBackButtonHandler=t.handleThemeChange=t.registerOnThemeChangeHandler=t.removeHandler=t.registerHandler=t.callHandler=t.initializeHandlers=void 0;var o=n(8),i=n(0),a=(function(){function e(){}return e.handlers={},e})();function s(e){a.themeChangeHandler&&a.themeChangeHandler(e),i.Communication.childWindow&&(0,i.sendMessageEventToChild)("themeChange",[e])}function c(){a.backButtonPressHandler&&a.backButtonPressHandler()||(0,o.navigateBack)()}function l(e){a.focusEnterHandler&&a.focusEnterHandler(e)}function u(e){a.loadHandler&&a.loadHandler(e),i.Communication.childWindow&&(0,i.sendMessageEventToChild)("load",[e])}function p(){function e(){(0,i.sendMessageToParent)("readyToUnload",[])}a.beforeUnloadHandler&&a.beforeUnloadHandler(e)||e()}t.initializeHandlers=function(){a.handlers.themeChange=s,a.handlers.backButtonPress=c,a.handlers.load=u,a.handlers.beforeUnload=p,a.handlers.focusEnter=l},t.callHandler=function(e,t){return(e=a.handlers[e])?[!0,e.apply(this,t)]:[!1,void 0]},t.registerHandler=function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=[]),t?(a.handlers[e]=t,n&&(0,i.sendMessageToParent)("registerHandler",r([e],o,!0))):delete a.handlers[e]},t.removeHandler=function(e){delete a.handlers[e]},t.registerOnThemeChangeHandler=function(e){(a.themeChangeHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["themeChange"])},t.handleThemeChange=s,t.registerBackButtonHandler=function(e){(a.backButtonPressHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["backButton"])},t.registerFocusEnterHandler=function(e){(a.focusEnterHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["focusEnter"])},t.registerOnLoadHandler=function(e){(a.loadHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["load"])},t.registerBeforeUnloadHandler=function(e){(a.beforeUnloadHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["beforeUnload"])}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userOriginUrlValidationRegExp=t.validOriginRegExp=t.validOrigins=t.scanBarCodeAPIMobileSupportVersion=t.getMediaCallbackSupportVersion=t.mediaAPISupportVersion=t.captureImageMobileSupportVersion=t.peoplePickerRequiredVersion=t.locationAPIsRequiredVersion=t.getUserJoinedTeamsSupportedAndroidClientVersion=t.imageOutputFormatsAPISupportVersion=t.nonFullScreenVideoModeAPISupportVersion=t.videoAndImageMediaAPISupportVersion=t.defaultSDKVersionForCompatCheck=t.version=void 0,n=n(5),t.version="1.12.1",t.defaultSDKVersionForCompatCheck="2.0.1",t.videoAndImageMediaAPISupportVersion="2.0.2",t.nonFullScreenVideoModeAPISupportVersion="2.0.3",t.imageOutputFormatsAPISupportVersion="2.0.4",t.getUserJoinedTeamsSupportedAndroidClientVersion="2.0.1",t.locationAPIsRequiredVersion="1.9.0",t.peoplePickerRequiredVersion="2.0.0",t.captureImageMobileSupportVersion="1.7.0",t.mediaAPISupportVersion="1.8.0",t.getMediaCallbackSupportVersion="2.0.0",t.scanBarCodeAPIMobileSupportVersion="1.9.0",t.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://teams.live.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.live.com","https://local.teams.live.com:8080","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com","https://www.office.com","https://word.office.com","https://excel.office.com","https://powerpoint.office.com","https://www.officeppe.com","https://*.www.office.com"],t.validOriginRegExp=(0,n.generateRegExpFromUrls)(t.validOrigins),t.userOriginUrlValidationRegExp=/^https\:\/\//}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateGUID=t.compareSDKVersions=t.getGenericOnCompleteHandler=t.generateRegExpFromUrls=void 0;var r=n(22);function o(e){for(var t="^",n=e.split("."),r=0;r<n.length;r++)t+=(0<r?"[.]":"")+n[r].replace("*","[^/^.]+");return t+"$"}t.generateRegExpFromUrls=function(e){for(var t="",n=0;n<e.length;n++)t+=(0===n?"":"|")+o(e[n]);return new RegExp(t)},t.getGenericOnCompleteHandler=function(e){return function(t,n){if(!t)throw new Error(e||n)}},t.compareSDKVersions=function(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(var i=0;i<n.length;++i)if(Number(n[i])!=Number(r[i]))return Number(n[i])>Number(r[i])?1:-1;return 0},t.generateGUID=function(){return r.v4()}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=t.FileOpenPreference=void 0,(function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"})(t.FileOpenPreference||(t.FileOpenPreference={})),(function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"})(t.ErrorCode||(t.ErrorCode={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalVars=void 0;var r=(function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e})();t.GlobalVars=r}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stageView=t.sharing=t.video=t.people=t.monetization=t.meeting=t.location=t.media=t.menus=t.ParentAppWindow=t.ChildAppWindow=t.tasks=t.settings=t.navigateToTab=t.navigateCrossDomain=t.navigateBack=t.returnFocus=t.shareDeepLink=t.setFrameContext=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerOnThemeChangeHandler=t.registerOnLoadHandler=t.registerFullScreenHandler=t.registerChangeSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerBackButtonHandler=t.print=t.initializeWithFrameContext=t.initialize=t.getTabInstances=t.getMruTabInstances=t.getContext=t.executeDeepLink=t.enablePrintCapability=t.FileOpenPreference=t.ErrorCode=t.ChannelType=t.UserTeamRole=t.TeamType=t.TaskModuleDimension=t.HostClientType=t.FrameContexts=t.authentication=t.appInitialization=void 0;var r=n(25);Object.defineProperty(t,"appInitialization",{enumerable:!0,get:function(){return r.appInitialization}});var o=n(11);Object.defineProperty(t,"authentication",{enumerable:!0,get:function(){return o.authentication}});var i=n(2);Object.defineProperty(t,"FrameContexts",{enumerable:!0,get:function(){return i.FrameContexts}}),Object.defineProperty(t,"HostClientType",{enumerable:!0,get:function(){return i.HostClientType}}),Object.defineProperty(t,"TaskModuleDimension",{enumerable:!0,get:function(){return i.TaskModuleDimension}}),Object.defineProperty(t,"TeamType",{enumerable:!0,get:function(){return i.TeamType}}),Object.defineProperty(t,"UserTeamRole",{enumerable:!0,get:function(){return i.UserTeamRole}}),Object.defineProperty(t,"ChannelType",{enumerable:!0,get:function(){return i.ChannelType}});var a=n(6);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return a.ErrorCode}}),Object.defineProperty(t,"FileOpenPreference",{enumerable:!0,get:function(){return a.FileOpenPreference}});var s=n(26);Object.defineProperty(t,"enablePrintCapability",{enumerable:!0,get:function(){return s.enablePrintCapability}}),Object.defineProperty(t,"executeDeepLink",{enumerable:!0,get:function(){return s.executeDeepLink}}),Object.defineProperty(t,"getContext",{enumerable:!0,get:function(){return s.getContext}}),Object.defineProperty(t,"getMruTabInstances",{enumerable:!0,get:function(){return s.getMruTabInstances}}),Object.defineProperty(t,"getTabInstances",{enumerable:!0,get:function(){return s.getTabInstances}}),Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return s.initialize}}),Object.defineProperty(t,"initializeWithFrameContext",{enumerable:!0,get:function(){return s.initializeWithFrameContext}}),Object.defineProperty(t,"print",{enumerable:!0,get:function(){return s.print}}),Object.defineProperty(t,"registerBackButtonHandler",{enumerable:!0,get:function(){return s.registerBackButtonHandler}}),Object.defineProperty(t,"registerBeforeUnloadHandler",{enumerable:!0,get:function(){return s.registerBeforeUnloadHandler}}),Object.defineProperty(t,"registerFocusEnterHandler",{enumerable:!0,get:function(){return s.registerFocusEnterHandler}}),Object.defineProperty(t,"registerChangeSettingsHandler",{enumerable:!0,get:function(){return s.registerChangeSettingsHandler}}),Object.defineProperty(t,"registerFullScreenHandler",{enumerable:!0,get:function(){return s.registerFullScreenHandler}}),Object.defineProperty(t,"registerOnLoadHandler",{enumerable:!0,get:function(){return s.registerOnLoadHandler}}),Object.defineProperty(t,"registerOnThemeChangeHandler",{enumerable:!0,get:function(){return s.registerOnThemeChangeHandler}}),Object.defineProperty(t,"registerAppButtonClickHandler",{enumerable:!0,get:function(){return s.registerAppButtonClickHandler}}),Object.defineProperty(t,"registerAppButtonHoverEnterHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverEnterHandler}}),Object.defineProperty(t,"registerAppButtonHoverLeaveHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverLeaveHandler}}),Object.defineProperty(t,"setFrameContext",{enumerable:!0,get:function(){return s.setFrameContext}}),Object.defineProperty(t,"shareDeepLink",{enumerable:!0,get:function(){return s.shareDeepLink}});var c=n(27);Object.defineProperty(t,"returnFocus",{enumerable:!0,get:function(){return c.returnFocus}}),Object.defineProperty(t,"navigateBack",{enumerable:!0,get:function(){return c.navigateBack}}),Object.defineProperty(t,"navigateCrossDomain",{enumerable:!0,get:function(){return c.navigateCrossDomain}}),Object.defineProperty(t,"navigateToTab",{enumerable:!0,get:function(){return c.navigateToTab}});var l=n(12);Object.defineProperty(t,"settings",{enumerable:!0,get:function(){return l.settings}});var u=n(28);Object.defineProperty(t,"tasks",{enumerable:!0,get:function(){return u.tasks}});var p=n(16);Object.defineProperty(t,"ChildAppWindow",{enumerable:!0,get:function(){return p.ChildAppWindow}}),Object.defineProperty(t,"ParentAppWindow",{enumerable:!0,get:function(){return p.ParentAppWindow}});var d=n(15);Object.defineProperty(t,"menus",{enumerable:!0,get:function(){return d.menus}});var f=n(17);Object.defineProperty(t,"media",{enumerable:!0,get:function(){return f.media}});var m=n(29);Object.defineProperty(t,"location",{enumerable:!0,get:function(){return m.location}});var g=n(30);Object.defineProperty(t,"meeting",{enumerable:!0,get:function(){return g.meeting}});var h=n(31);Object.defineProperty(t,"monetization",{enumerable:!0,get:function(){return h.monetization}});var v=n(32);Object.defineProperty(t,"people",{enumerable:!0,get:function(){return v.people}});var y=n(33);Object.defineProperty(t,"video",{enumerable:!0,get:function(){return y.video}});var w=n(34);Object.defineProperty(t,"sharing",{enumerable:!0,get:function(){return w.sharing}});var b=n(35);Object.defineProperty(t,"stageView",{enumerable:!0,get:function(){return b.stageView}})}),(function(e,t){var n,r,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(n=new Uint8Array(16),e.exports=function(){return o(n),n}):(r=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r})}),(function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[(t=n)[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[+r]]].join("")}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authentication=void 0;var r=n(1),o=n(7),i=n(2),a=n(0),s=n(3);!(function(e){var t,n;function c(){l();try{a.Communication.childWindow&&a.Communication.childWindow.close()}finally{a.Communication.childWindow=null,a.Communication.childOrigin=null}}function l(){n&&(clearInterval(n),n=0),(0,s.removeHandler)("initialize"),(0,s.removeHandler)("navigateCrossDomain")}function u(){l(),n=a.Communication.currentWindow.setInterval((function(){if(!a.Communication.childWindow||a.Communication.childWindow.closed)d("CancelledByUser");else{var e=a.Communication.childOrigin;try{a.Communication.childOrigin="*",(0,a.sendMessageEventToChild)("ping")}finally{a.Communication.childOrigin=e}}}),100),(0,s.registerHandler)("initialize",(function(){return[i.FrameContexts.authentication,o.GlobalVars.hostClientType]})),(0,s.registerHandler)("navigateCrossDomain",(function(){return!1}))}function p(e){try{t&&t.successCallback&&t.successCallback(e)}finally{t=null,c()}}function d(e){try{t&&t.failureCallback&&t.failureCallback(e)}finally{t=null,c()}}function f(e,t,n){var r;e&&((r=document.createElement("a")).href=decodeURIComponent(e),r.host&&r.host!==window.location.host&&"outlook.office.com"===r.host&&-1<r.search.indexOf("client_type=Win32_Outlook")&&(t&&"result"===t&&(n&&(r.href=m(r.href,"result",n)),a.Communication.currentWindow.location.assign(m(r.href,"authSuccess",""))),t&&"reason"===t&&(n&&(r.href=m(r.href,"reason",n)),a.Communication.currentWindow.location.assign(m(r.href,"authFailure","")))))}function m(e,t,n){var r=e.indexOf("#"),o=(o=-1===r?"#":e.substr(r))+"&"+t+(""!==n?"="+n:"");return(e=-1===r?e:e.substr(0,r))+o}e.initialize=function(){(0,s.registerHandler)("authentication.authenticate.success",p,!1),(0,s.registerHandler)("authentication.authenticate.failure",d,!1)},e.registerAuthenticationHandlers=function(e){t=e},e.authenticate=function(e){var n=void 0!==e?e:t;(0,r.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.settings,i.FrameContexts.remove,i.FrameContexts.task,i.FrameContexts.stage,i.FrameContexts.meetingStage),o.GlobalVars.hostClientType===i.HostClientType.desktop||o.GlobalVars.hostClientType===i.HostClientType.android||o.GlobalVars.hostClientType===i.HostClientType.ios||o.GlobalVars.hostClientType===i.HostClientType.rigel||o.GlobalVars.hostClientType===i.HostClientType.teamsRoomsWindows||o.GlobalVars.hostClientType===i.HostClientType.teamsRoomsAndroid||o.GlobalVars.hostClientType===i.HostClientType.teamsPhones||o.GlobalVars.hostClientType===i.HostClientType.teamsDisplays?((e=document.createElement("a")).href=n.url,(0,a.sendMessageToParent)("authentication.authenticate",[e.href,n.width,n.height,n.isExternal],(function(e,t){e?n.successCallback(t):n.failureCallback(t)}))):(function(e){t=e,c();var n=t.width||600,r=t.height||400,o=(n=Math.min(n,a.Communication.currentWindow.outerWidth-400),r=Math.min(r,a.Communication.currentWindow.outerHeight-200),document.createElement("a"));o.href=t.url.replace("{oauthRedirectMethod}","web");var i=void 0!==a.Communication.currentWindow.screenLeft?a.Communication.currentWindow.screenLeft:a.Communication.currentWindow.screenX;e=void 0!==a.Communication.currentWindow.screenTop?a.Communication.currentWindow.screenTop:a.Communication.currentWindow.screenY,i+=a.Communication.currentWindow.outerWidth/2-n/2,e+=a.Communication.currentWindow.outerHeight/2-r/2,a.Communication.childWindow=a.Communication.currentWindow.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+e+", left="+i+", width="+n+", height="+r),a.Communication.childWindow?u():d("FailedToOpenWindow")})(n)},e.getAuthToken=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getAuthToken",[e.resources,e.claims,e.silent],(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.getUser=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getUser",(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.notifySuccess=function(e,t){f(t,"result",e),(0,r.ensureInitialized)(i.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.success",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))},e.notifyFailure=function(e,t){f(t,"reason",e),(0,r.ensureInitialized)(i.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.failure",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))}})(t.authentication||(t.authentication={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.settings=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(3);!(function(e){var t,n;function c(e){e=new l(e),t?t(e):e.notifySuccess()}e.initialize=function(){(0,s.registerHandler)("settings.save",c,!1),(0,s.registerHandler)("settings.remove",u,!1)},e.setValidityState=function(e){(0,r.ensureInitialized)(o.FrameContexts.settings,o.FrameContexts.remove),(0,a.sendMessageToParent)("settings.setValidityState",[e])},e.getSettings=function(e){(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.remove,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.getSettings",e)},e.setSettings=function(e,t){(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.setSettings",[e],t||(0,i.getGenericOnCompleteHandler)())},e.registerOnSaveHandler=function(e){(0,r.ensureInitialized)(o.FrameContexts.settings),(t=e)&&(0,a.sendMessageToParent)("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){(0,r.ensureInitialized)(o.FrameContexts.remove,o.FrameContexts.settings),(n=e)&&(0,a.sendMessageToParent)("registerHandler",["remove"])};var l=(function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e})();function u(){var e=new p;n?n(e):e.notifySuccess()}var p=(function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e})()})(t.settings||(t.settings={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logs=void 0;var r=n(1),o=n(0),i=n(3);(t.logs||(t.logs={})).registerGetLogHandler=function(e){(0,r.ensureInitialized)(),e?(0,i.registerHandler)("log.request",(function(){var t=e();(0,o.sendMessageToParent)("log.receive",[t])})):(0,i.removeHandler)("log.request")}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerUserSettingsChangeHandler=t.getConfigSetting=t.getChatMembers=t.registerCustomHandler=t.sendCustomEvent=t.sendCustomMessage=t.uploadCustomApp=t.showNotification=t.openFilePreview=t.exitFullscreen=t.enterFullscreen=t.getUserJoinedTeams=t.initializePrivateApis=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(3),c=n(7),l=n(6),u=n(4);t.initializePrivateApis=function(){},t.getUserJoinedTeams=function(e,t){if((0,r.ensureInitialized)(),(c.GlobalVars.hostClientType===o.HostClientType.android||c.GlobalVars.hostClientType===o.HostClientType.teamsRoomsAndroid||c.GlobalVars.hostClientType===o.HostClientType.teamsPhones||c.GlobalVars.hostClientType===o.HostClientType.teamsDisplays)&&!(0,r.isAPISupportedByPlatform)(u.getUserJoinedTeamsSupportedAndroidClientVersion)){var n={errorCode:l.ErrorCode.OLD_PLATFORM};throw new Error(JSON.stringify(n))}(0,a.sendMessageToParent)("getUserJoinedTeams",[t],e)},t.enterFullscreen=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("enterFullscreen",[])},t.exitFullscreen=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("exitFullscreen",[])},t.openFilePreview=function(e){(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.task),e=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId],(0,a.sendMessageToParent)("openFilePreview",e)},t.showNotification=function(e){(0,r.ensureInitialized)(o.FrameContexts.content),e=[e.message,e.notificationType],(0,a.sendMessageToParent)("showNotification",e)},t.uploadCustomApp=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("uploadCustomApp",[e],t||(0,i.getGenericOnCompleteHandler)())},t.sendCustomMessage=function(e,t,n){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)(e,t,n)},t.sendCustomEvent=function(e,t){if((0,r.ensureInitialized)(),!a.Communication.childWindow)throw new Error("The child window has not yet been initialized or is not present");(0,a.sendMessageEventToChild)(e,t)},t.registerCustomHandler=function(e,t){var n=this;(0,r.ensureInitialized)(),(0,s.registerHandler)(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}))},t.getChatMembers=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("getChatMembers",e)},t.getConfigSetting=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("getConfigSetting",[t],e)},t.registerUserSettingsChangeHandler=function(e,t){(0,r.ensureInitialized)(),(0,s.registerHandler)("userSettingsChange",t,!0,[e])}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menus=void 0;var r=n(1),o=n(0),i=n(3);!(function(e){!(function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"})(e.DisplayMode||(e.DisplayMode={}));var t,n,a,s=function(){this.enabled=!0,this.selected=!1};function c(e){a&&a(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("viewConfigItemPress",[e]))}function l(e){t&&t(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("handleNavBarMenuItemPress",[e]))}function u(e){n&&n(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("handleActionMenuItemPress",[e]))}e.MenuItem=s,(function(e){e.dropDown="dropDown",e.popOver="popOver"})(e.MenuListType||(e.MenuListType={})),e.initialize=function(){(0,i.registerHandler)("navBarMenuItemPress",l,!1),(0,i.registerHandler)("actionMenuItemPress",u,!1),(0,i.registerHandler)("setModuleView",c,!1)},e.setUpViews=function(e,t){(0,r.ensureInitialized)(),a=t,(0,o.sendMessageToParent)("setUpViews",[e])},e.setNavBarMenu=function(e,n){(0,r.ensureInitialized)(),t=n,(0,o.sendMessageToParent)("setNavBarMenu",[e])},e.showActionMenu=function(e,t){(0,r.ensureInitialized)(),n=t,(0,o.sendMessageToParent)("showActionMenu",[e])}})(t.menus||(t.menus={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentAppWindow=t.ChildAppWindow=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(3);n=(function(){function e(){}return e.prototype.postMessage=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("messageForChild",[e],t||(0,i.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForParent",t)},e})();t.ChildAppWindow=n,n=(function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){(0,r.ensureInitialized)(o.FrameContexts.task),(0,a.sendMessageToParent)("messageForParent",[e],t||(0,i.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForChild",t)},e})(),t.ParentAppWindow=n}),(function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.media=void 0;var i=n(7),a=n(6),s=n(1),c=n(2),l=n(5),u=n(18),p=n(0),d=n(3),f=n(4);!(function(e){!(function(e){e.Base64="base64",e.ID="id"})(e.FileFormat||(e.FileFormat={}));var t=function(){};e.File=t,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task),i.GlobalVars.isFramelessWindow?(0,s.isAPISupportedByPlatform)(f.captureImageMobileSupportVersion)?(0,p.sendMessageToParent)("captureImage",e):e({errorCode:a.ErrorCode.OLD_PLATFORM},void 0):e({errorCode:a.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},void 0)};var n=(function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return o(t,e),t.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task),(0,s.isAPISupportedByPlatform)(f.mediaAPISupportVersion)?(0,u.validateGetMediaInputs)(this.mimeType,this.format,this.content)?(0,s.isAPISupportedByPlatform)(f.getMediaCallbackSupportVersion)?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:a.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:a.ErrorCode.OLD_PLATFORM},null)},t.prototype.getMediaViaCallback=function(e){var t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];(0,p.sendMessageToParent)("getMedia",n,(function(n){var r;e&&(n&&n.error?e(n.error,null):n&&n.mediaChunk?n.mediaChunk.chunkSequence<=0?(r=(0,u.createFile)(t.assembleAttachment,t.mediaMimeType),e(n.error,r)):(n=(0,u.decodeAttachment)(n.mediaChunk,t.mediaMimeType),t.assembleAttachment.push(n)):e({errorCode:a.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null))}))},t.prototype.getMediaViaHandler=function(e){var t=(0,l.generateGUID)(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&e&&(0,p.sendMessageToParent)("getMedia",r),(0,d.registerHandler)("getMedia"+t,(function(r){var o;e&&((o=JSON.parse(r)).error?(e(o.error,null),(0,d.removeHandler)("getMedia"+t)):o.mediaChunk?o.mediaChunk.chunkSequence<=0?(r=(0,u.createFile)(n.assembleAttachment,n.mediaMimeType),e(o.error,r),(0,d.removeHandler)("getMedia"+t)):(o=(0,u.decodeAttachment)(o.mediaChunk,n.mediaMimeType),n.assembleAttachment.push(o)):(e({errorCode:a.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null),(0,d.removeHandler)("getMedia"+t)))}))},t})(t);e.Media=n;var r,m;t=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getMediaType=function(){return m.Video},t.prototype.notifyEventToApp=function(e){if(this.controllerCallback)switch(e){case r.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},t})(function(){function e(e){this.controllerCallback=e}return e.prototype.notifyEventToHost=function(e,t){(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task);var n=(0,s.isApiSupportedOnMobile)(f.nonFullScreenVideoModeAPISupportVersion);n?t&&t(n):(e={mediaType:this.getMediaType(),mediaControllerEvent:e},(0,p.sendMessageToParent)("media.controller",[e],(function(e){t&&t(e)})))},e.prototype.stop=function(e){this.notifyEventToHost(r.StopRecording,e)},e}());e.VideoController=t,(function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"})(r=r||{}),(function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"})(e.CameraStartMode||(e.CameraStartMode={})),(function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"})(e.Source||(e.Source={})),(function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"})(m=e.MediaType||(e.MediaType={})),(function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"})(e.ImageUriType||(e.ImageUriType={})),(function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"})(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");var r,o;(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task),(0,s.isAPISupportedByPlatform)(f.mediaAPISupportVersion)?(r=(0,u.isMediaCallSupportedOnMobile)(e))?t(r,null):(0,u.validateSelectMediaInputs)(e)?(0,p.sendMessageToParent)("selectMedia",[e],(function(r,o,i){if(i)(0,u.isVideoControllerRegistered)(e)&&e.videoProps.videoController.notifyEventToApp(i);else if(o){for(var a=[],s=0,c=o;s<c.length;s++){var l=c[s];a.push(new n(l))}t(r,a)}else t(r,null)})):(o={errorCode:a.ErrorCode.INVALID_ARGUMENTS},t(o,null)):(o={errorCode:a.ErrorCode.OLD_PLATFORM},t(o,null))},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task),(0,s.isAPISupportedByPlatform)(f.mediaAPISupportVersion)?(0,u.validateViewImagesInput)(e)?(0,p.sendMessageToParent)("viewImages",[e],t):t({errorCode:a.ErrorCode.INVALID_ARGUMENTS}):t({errorCode:a.ErrorCode.OLD_PLATFORM})},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");(0,s.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.task),i.GlobalVars.hostClientType!==c.HostClientType.desktop&&i.GlobalVars.hostClientType!==c.HostClientType.web&&i.GlobalVars.hostClientType!==c.HostClientType.rigel&&i.GlobalVars.hostClientType!==c.HostClientType.teamsRoomsWindows&&i.GlobalVars.hostClientType!==c.HostClientType.teamsRoomsAndroid&&i.GlobalVars.hostClientType!==c.HostClientType.teamsPhones&&i.GlobalVars.hostClientType!==c.HostClientType.teamsDisplays?(0,s.isAPISupportedByPlatform)(f.scanBarCodeAPIMobileSupportVersion)?(0,u.validateScanBarCodeInput)(t)?(0,p.sendMessageToParent)("media.scanBarCode",[t],e):e({errorCode:a.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:a.ErrorCode.OLD_PLATFORM},null):e({errorCode:a.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},null)}})(t.media||(t.media={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePeoplePickerInput=t.validateScanBarCodeInput=t.validateViewImagesInput=t.validateGetMediaInputs=t.isMediaCallForNonFullScreenVideoMode=t.isMediaCallForVideoAndImageInputs=t.isMediaCallForImageOutputFormats=t.validateSelectMediaInputs=t.isVideoControllerRegistered=t.isMediaCallSupportedOnMobile=t.decodeAttachment=t.createFile=void 0;var r=n(17),o=n(4),i=n(1);function a(e){var t;return!((null==e?void 0:e.mediaType)!=r.media.MediaType.Image||null===(t=null==e?void 0:e.imageProps)||void 0===t||!t.imageOutputFormats)}function s(e){return!(!e||e.mediaType!=r.media.MediaType.VideoAndImage&&!e.videoAndImageProps)}function c(e){return!(!e||e.mediaType!=r.media.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}t.createFile=function(e,t){if(null==e||null==t||e.length<=0)return null;var n,r=1;return e.sort((function(e,t){return e.sequence>t.sequence?1:-1})),e.forEach((function(e){e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n},t.decodeAttachment=function(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=new Uint8Array(r);t=new Blob([i],{type:t});return{sequence:e.chunkSequence,file:t}},t.isMediaCallSupportedOnMobile=function(e){return s(e)?(0,i.isApiSupportedOnMobile)(o.videoAndImageMediaAPISupportVersion):c(e)?(0,i.isApiSupportedOnMobile)(o.nonFullScreenVideoModeAPISupportVersion):a(e)?(0,i.isApiSupportedOnMobile)(o.imageOutputFormatsAPISupportVersion):null},t.isVideoControllerRegistered=function(e){return!(e.mediaType!=r.media.MediaType.Video||!e.videoProps||!e.videoProps.videoController)},t.validateSelectMediaInputs=function(e){return!(null==e||10<e.maxMediaCount)},t.isMediaCallForImageOutputFormats=a,t.isMediaCallForVideoAndImageInputs=s,t.isMediaCallForNonFullScreenVideoMode=c,t.validateGetMediaInputs=function(e,t,n){return null!=e&&null!=t&&t==r.media.FileFormat.ID&&null!=n},t.validateViewImagesInput=function(e){return!(null==e||e.length<=0||10<e.length)},t.validateScanBarCodeInput=function(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||60<e.timeOutIntervalInSec)},t.validatePeoplePickerInput=function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}}),(function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(20),t),o(n(8),t)}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=t.appEntity=t.files=t.remoteCamera=t.meetingRoom=t.conversations=t.registerUserSettingsChangeHandler=t.uploadCustomApp=t.registerCustomHandler=t.sendCustomEvent=t.showNotification=t.sendCustomMessage=t.openFilePreview=t.getUserJoinedTeams=t.getConfigSetting=t.getChatMembers=t.exitFullscreen=t.enterFullscreen=t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=t.logs=t.bot=void 0;var r=n(21);Object.defineProperty(t,"bot",{enumerable:!0,get:function(){return r.bot}});var o=n(13);Object.defineProperty(t,"logs",{enumerable:!0,get:function(){return o.logs}});var i=n(36);Object.defineProperty(t,"NotificationTypes",{enumerable:!0,get:function(){return i.NotificationTypes}}),Object.defineProperty(t,"ViewerActionTypes",{enumerable:!0,get:function(){return i.ViewerActionTypes}}),Object.defineProperty(t,"UserSettingTypes",{enumerable:!0,get:function(){return i.UserSettingTypes}});var a=n(14);Object.defineProperty(t,"enterFullscreen",{enumerable:!0,get:function(){return a.enterFullscreen}}),Object.defineProperty(t,"exitFullscreen",{enumerable:!0,get:function(){return a.exitFullscreen}}),Object.defineProperty(t,"getChatMembers",{enumerable:!0,get:function(){return a.getChatMembers}}),Object.defineProperty(t,"getConfigSetting",{enumerable:!0,get:function(){return a.getConfigSetting}}),Object.defineProperty(t,"getUserJoinedTeams",{enumerable:!0,get:function(){return a.getUserJoinedTeams}}),Object.defineProperty(t,"openFilePreview",{enumerable:!0,get:function(){return a.openFilePreview}}),Object.defineProperty(t,"sendCustomMessage",{enumerable:!0,get:function(){return a.sendCustomMessage}}),Object.defineProperty(t,"showNotification",{enumerable:!0,get:function(){return a.showNotification}}),Object.defineProperty(t,"sendCustomEvent",{enumerable:!0,get:function(){return a.sendCustomEvent}}),Object.defineProperty(t,"registerCustomHandler",{enumerable:!0,get:function(){return a.registerCustomHandler}}),Object.defineProperty(t,"uploadCustomApp",{enumerable:!0,get:function(){return a.uploadCustomApp}}),Object.defineProperty(t,"registerUserSettingsChangeHandler",{enumerable:!0,get:function(){return a.registerUserSettingsChangeHandler}});var s=n(37);Object.defineProperty(t,"conversations",{enumerable:!0,get:function(){return s.conversations}});var c=n(38);Object.defineProperty(t,"meetingRoom",{enumerable:!0,get:function(){return c.meetingRoom}});var l=n(39);Object.defineProperty(t,"remoteCamera",{enumerable:!0,get:function(){return l.remoteCamera}});var u=n(40);Object.defineProperty(t,"files",{enumerable:!0,get:function(){return u.files}});var p=n(41);Object.defineProperty(t,"appEntity",{enumerable:!0,get:function(){return p.appEntity}});var d=n(42);Object.defineProperty(t,"teams",{enumerable:!0,get:function(){return d.teams}})}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bot=void 0;var r=n(0),o=n(1);!(function(e){e.sendQuery=function(e,t,n){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.executeQuery",[e],(function(e,r){(e?t:n)(r)}))},e.getSupportedCommands=function(e,t){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.getSupportedCommands",(function(n,r){(n?e:t)(r)}))},e.authenticate=function(e,t,n){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.authenticate",[e],(function(e,r){(e?t:n)(r)}))},(function(e){e.Results="Results",e.Auth="Auth"})(e.ResponseType||(e.ResponseType={}))})(t.bot||(t.bot={}))}),(function(e,t,n){var r=n(23),o=n(24);(n=o).v1=r,n.v4=o,e.exports=n}),(function(e,t,n){var r,o,i=n(9),a=n(10),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],p=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:o;null!=p&&null!=d||(m=i(),null==p&&(p=r=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==d&&(d=o=16383&(m[6]<<8|m[7])));var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=(n=void 0!==e.nsecs?e.nsecs:c+1,f-s+(n-c)/1e4);if(m<0&&void 0===e.clockseq&&(d=d+1&16383),1e4<=(n=(m<0||s<f)&&void 0===e.nsecs?0:n))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,o=d,n=(1e4*(268435455&(f+=122192928e5))+(c=n))%4294967296,u[l++]=n>>>24&255,u[l++]=n>>>16&255,u[l++]=n>>>8&255,u[l++]=255&n,f=f/4294967296*1e4&268435455,u[l++]=f>>>8&255,u[l++]=255&f,u[l++]=f>>>24&15|16,u[l++]=f>>>16&255,u[l++]=d>>>8|128,u[l++]=255&d;for(var g=0;g<6;++g)u[l+g]=p[g];return t||a(u)}}),(function(e,t,n){var r=n(9),o=n(10);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appInitialization=void 0;var r=n(1),o=n(4),i=n(0);!(function(e){e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"})(e.FailedReason||(e.FailedReason={})),(function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"})(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.notifyAppLoaded=function(){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.AppLoaded,[o.version])},e.notifySuccess=function(){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.Success,[o.version])},e.notifyFailure=function(t){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.Failure,[t.reason,t.message])},e.notifyExpectedFailure=function(t){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.ExpectedFailure,[t.reason,t.message])}})(t.appInitialization||(t.appInitialization={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithFrameContext=t.setFrameContext=t.executeDeepLink=t.shareDeepLink=t.getMruTabInstances=t.getTabInstances=t.registerChangeSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerBackButtonHandler=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerFullScreenHandler=t.registerOnThemeChangeHandler=t.getContext=t.print=t.enablePrintCapability=t._uninitialize=t._initialize=t.initialize=void 0;var r=n(1),o=n(7),i=n(4),a=n(12),s=n(5),c=n(13),l=n(2),u=n(0),p=n(11),d=n(14),f=n(15),m=n(3);function g(e,t){o.GlobalVars.initializeCalled||(o.GlobalVars.initializeCalled=!0,m.initializeHandlers(),(0,u.initializeCommunication)((function(e,t,n){void 0===n&&(n=i.defaultSDKVersionForCompatCheck),o.GlobalVars.frameContext=e,o.GlobalVars.hostClientType=t,o.GlobalVars.clientSupportedSDKVersion=n,o.GlobalVars.initializeCallbacks.forEach((function(e){return e()})),o.GlobalVars.initializeCallbacks=[],o.GlobalVars.initializeCompleted=!0}),t),p.authentication.initialize(),a.settings.initialize(),f.menus.initialize(),(0,d.initializePrivateApis)()),Array.isArray(t)&&(0,r.processAdditionalValidOrigins)(t),e&&(o.GlobalVars.initializeCompleted?e():o.GlobalVars.initializeCallbacks.push(e))}function h(){window.print()}function v(e){(0,r.ensureInitialized)(),m.registerOnThemeChangeHandler(e)}function y(e){(0,r.ensureInitialized)(),m.registerHandler("fullScreenChange",e)}function w(e){(0,r.ensureInitialized)(),m.registerBackButtonHandler(e)}function b(e){(0,r.ensureInitialized)(),m.registerOnLoadHandler(e)}function C(e){(0,r.ensureInitialized)(),m.registerBeforeUnloadHandler(e)}function _(e){(0,r.ensureInitialized)(),m.registerFocusEnterHandler(e)}function S(e){(0,r.ensureInitialized)(l.FrameContexts.content),(0,u.sendMessageToParent)("setFrameContext",[e])}t.initialize=g,t._initialize=function(e){u.Communication.currentWindow=e},t._uninitialize=function(){o.GlobalVars.initializeCalled&&(o.GlobalVars.frameContext&&(v(null),y(null),w(null),C(null),_(null),b(null),c.logs.registerGetLogHandler(null)),o.GlobalVars.frameContext===l.FrameContexts.settings&&a.settings.registerOnSaveHandler(null),o.GlobalVars.frameContext===l.FrameContexts.remove&&a.settings.registerOnRemoveHandler(null),o.GlobalVars.initializeCalled=!1,o.GlobalVars.initializeCompleted=!1,o.GlobalVars.initializeCallbacks=[],o.GlobalVars.additionalValidOrigins=[],o.GlobalVars.frameContext=null,o.GlobalVars.hostClientType=null,(o.GlobalVars.isFramelessWindow=!1,u.uninitializeCommunication)())},t.enablePrintCapability=function(){o.GlobalVars.printCapabilityEnabled||(o.GlobalVars.printCapabilityEnabled=!0,(0,r.ensureInitialized)(),document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(h(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})))},t.print=h,t.getContext=function(e){(0,r.ensureInitialized)(),(0,u.sendMessageToParent)("getContext",(function(t){t.frameContext||(t.frameContext=o.GlobalVars.frameContext),e(t)}))},t.registerOnThemeChangeHandler=v,t.registerFullScreenHandler=y,t.registerAppButtonClickHandler=function(e){(0,r.ensureInitialized)(l.FrameContexts.content),m.registerHandler("appButtonClick",e)},t.registerAppButtonHoverEnterHandler=function(e){(0,r.ensureInitialized)(l.FrameContexts.content),m.registerHandler("appButtonHoverEnter",e)},t.registerAppButtonHoverLeaveHandler=function(e){(0,r.ensureInitialized)(l.FrameContexts.content),m.registerHandler("appButtonHoverLeave",e)},t.registerBackButtonHandler=w,t.registerOnLoadHandler=b,t.registerBeforeUnloadHandler=C,t.registerFocusEnterHandler=_,t.registerChangeSettingsHandler=function(e){(0,r.ensureInitialized)(l.FrameContexts.content),m.registerHandler("changeSettings",e)},t.getTabInstances=function(e,t){(0,r.ensureInitialized)(),(0,u.sendMessageToParent)("getTabInstances",[t],e)},t.getMruTabInstances=function(e,t){(0,r.ensureInitialized)(),(0,u.sendMessageToParent)("getMruTabInstances",[t],e)},t.shareDeepLink=function(e){(0,r.ensureInitialized)(l.FrameContexts.content,l.FrameContexts.sidePanel,l.FrameContexts.meetingStage),(0,u.sendMessageToParent)("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},t.executeDeepLink=function(e,t){(0,r.ensureInitialized)(l.FrameContexts.content,l.FrameContexts.sidePanel,l.FrameContexts.settings,l.FrameContexts.task,l.FrameContexts.stage,l.FrameContexts.meetingStage),(0,u.sendMessageToParent)("executeDeepLink",[e],t||(0,s.getGenericOnCompleteHandler)())},t.setFrameContext=S,t.initializeWithFrameContext=function(e,t,n){g(t,n),S(e)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateBack=t.navigateCrossDomain=t.navigateToTab=t.returnFocus=void 0;var r=n(1),o=n(5),i=n(2),a=n(0);t.returnFocus=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("returnFocus",[e])},t.navigateToTab=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("navigateToTab",[e],t||(0,o.getGenericOnCompleteHandler)("Invalid internalTabInstanceId and/or channelId were/was provided"))},t.navigateCrossDomain=function(e,t){(0,r.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.settings,i.FrameContexts.remove,i.FrameContexts.task,i.FrameContexts.stage,i.FrameContexts.meetingStage),(0,a.sendMessageToParent)("navigateCrossDomain",[e],t||(0,o.getGenericOnCompleteHandler)("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest."))},t.navigateBack=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("navigateBack",[],e||(0,o.getGenericOnCompleteHandler)("Back navigation is not supported in the current client or context."))}}),(function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.tasks=void 0;var o=n(2),i=n(16),a=n(0),s=n(1);!(function(e){e.startTask=function(e,t){return(0,s.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.sidePanel,o.FrameContexts.meetingStage),(0,a.sendMessageToParent)("tasks.startTask",[e],t),new i.ChildAppWindow},e.updateTask=function(e){(0,s.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.sidePanel,o.FrameContexts.task,o.FrameContexts.meetingStage),e.width,e.height;var t=r(e,["width","height"]);if(Object.keys(t).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");(0,a.sendMessageToParent)("tasks.updateTask",[e])},e.submitTask=function(e,t){(0,s.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.sidePanel,o.FrameContexts.task,o.FrameContexts.meetingStage),(0,a.sendMessageToParent)("tasks.completeTask",[e,Array.isArray(t)?t:[t]])}})(t.tasks||(t.tasks={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.location=void 0;var r=n(6),o=n(1),i=n(2),a=n(0),s=n(4);!(function(e){e.getLocation=function(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.getLocation",[e],t):t({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)},e.showLocation=function(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.showLocation",[e],t):t({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)}})(t.location||(t.location={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meeting=void 0;var r=n(0),o=n(3),i=n(1),a=n(2);!(function(e){!(function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"})(e.MeetingType||(e.MeetingType={})),(function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"})(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage,a.FrameContexts.settings,a.FrameContexts.content),(0,r.sendMessageToParent)("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,o.registerHandler)("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,o.registerHandler)("meeting.speakingStateChanged",e)}})(t.meeting||(t.meeting={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.monetization=void 0;var r=n(0),o=n(1),i=n(2);(t.monetization||(t.monetization={})).openPurchaseExperience=function(e,t){if(!e)throw new Error("[open purchase experience] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content),(0,r.sendMessageToParent)("monetization.openPurchaseExperience",[t],e)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.people=void 0;var r=n(1),o=n(2),i=n(6),a=n(18),s=n(0),c=n(4);(t.people||(t.people={})).selectPeople=function(e,t){if(!e)throw new Error("[people picker] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.task,o.FrameContexts.settings),(0,r.isAPISupportedByPlatform)(c.peoplePickerRequiredVersion)?(0,a.validatePeoplePickerInput)(t)?(0,s.sendMessageToParent)("people.selectPeople",[t],e):e({errorCode:i.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:i.ErrorCode.OLD_PLATFORM},void 0)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.video=void 0;var r=n(0),o=n(1),i=n(2),a=n(3);!(function(e){function t(){(0,r.sendMessageToParent)("video.videoFrameProcessed")}function n(e){(0,r.sendMessageToParent)("video.notifyError",[e])}!(function(e){e[e.NV12=0]="NV12"})(e.VideoFrameFormat||(e.VideoFrameFormat={})),(function(e){e[e.EffectChanged=0]="EffectChanged",e[e.EffectDisabled=1]="EffectDisabled"})(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(e,s){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,a.registerHandler)("video.newVideoFrame",(function(r){void 0!==r&&e(r,t,n)})),(0,r.sendMessageToParent)("video.registerForVideoFrame",[s])},e.notifySelectedVideoEffectChanged=function(e,t){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,r.sendMessageToParent)("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,a.registerHandler)("video.effectParameterChange",e)}})(t.video||(t.video={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharing=void 0;var r=n(1),o=n(0),i=n(6),a=n(2);!(function(e){e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(t,n){(function(e,t){if(e&&e.content&&e.content.length)return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content is missing"})})(t,n)&&(function(e,t){if(e.content.some((function(e){return!e.type})))t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"});else{if(!e.content.some((function(t){return t.type!==e.content[0].type})))return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content must be of the same type"})}})(t,n)&&(function(e,t){if("URL"===e.content[0].type){if(!e.content.some((function(e){return!e.url})))return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"URLs are required for URL content types"})}else t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Content type is unsupported"})})(t,n)&&((0,r.ensureInitialized)(a.FrameContexts.content,a.FrameContexts.sidePanel,a.FrameContexts.task,a.FrameContexts.stage,a.FrameContexts.meetingStage),(0,o.sendMessageToParent)(e.SharingAPIMessages.shareWebContent,[t],n))}})(t.sharing||(t.sharing={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stageView=void 0;var r=n(0),o=n(1),i=n(2);(t.stageView||(t.stageView={})).open=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[stageView.open] Stage view params cannot be null");(0,r.sendMessageToParent)("stageView.open",[e],t)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=void 0,(function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"})(t.NotificationTypes||(t.NotificationTypes={})),(function(e){e.view="view",e.edit="edit",e.editNew="editNew"})(t.ViewerActionTypes||(t.ViewerActionTypes={})),(function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"})(t.UserSettingTypes||(t.UserSettingTypes={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conversations=void 0;var r=n(1),o=n(2),i=n(0),a=n(3);!(function(e){e.openConversation=function(e){(0,r.ensureInitialized)(o.FrameContexts.content),(0,i.sendMessageToParent)("conversations.openConversation",[{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId}],(function(e,t){if(!e)throw new Error(t)})),e.onStartConversation&&(0,a.registerHandler)("startConversation",(function(t,n,r,o){return e.onStartConversation({subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&(0,a.registerHandler)("closeConversation",(function(t,n,r,o){return e.onCloseConversation({subEntityId:t,conversationId:n,channelId:r,entityId:o})}))},e.closeConversation=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,i.sendMessageToParent)("conversations.closeConversation"),(0,a.removeHandler)("startConversation"),(0,a.removeHandler)("closeConversation")}})(t.conversations||(t.conversations={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meetingRoom=void 0;var r=n(1),o=n(0),i=n(3);!(function(e){!(function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.toggleCaptions="toggleCaptions",e.volume="volume",e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.leaveMeeting="leaveMeeting"})(e.Capability||(e.Capability={})),e.getPairedMeetingRoomInfo=function(e){(0,r.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.getPairedMeetingRoomInfo",e)},e.sendCommandToPairedMeetingRoom=function(e,t){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(!t)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Callback cannot be null");(0,r.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.sendCommandToPairedMeetingRoom",[e],t)},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");(0,r.ensureInitialized)(),(0,i.registerHandler)("meetingRoom.meetingRoomCapabilitiesUpdate",(function(t){(0,r.ensureInitialized)(),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");(0,r.ensureInitialized)(),(0,i.registerHandler)("meetingRoom.meetingRoomStatesUpdate",(function(t){(0,r.ensureInitialized)(),e(t)}))}})(t.meetingRoom||(t.meetingRoom={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remoteCamera=void 0;var r=n(1),o=n(2),i=n(0),a=n(3);!(function(e){!(function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"})(e.ControlCommand||(e.ControlCommand={})),(function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"})(e.ErrorReason||(e.ErrorReason={})),(function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"})(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.sessionStatusChange",e)}})(t.remoteCamera||(t.remoteCamera={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.files=void 0;var r=n(0),o=n(1),i=n(8);!(function(e){!(function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"})(e.CloudStorageProvider||(e.CloudStorageProvider={})),(function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"})(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})).ClassMaterials="classMaterials",(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})).Readonly="readonly",(function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"})(e.FileDownloadStatus||(e.FileDownloadStatus={})),e.getCloudStorageFolders=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");(0,r.sendMessageToParent)("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");(0,r.sendMessageToParent)("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");(0,r.sendMessageToParent)("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");(0,r.sendMessageToParent)("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");(0,r.sendMessageToParent)("files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e,t){if(void 0===e&&(e=!1),(0,o.ensureInitialized)(i.FrameContexts.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");(0,r.sendMessageToParent)("files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,a,s,c){if(void 0===s&&(s=!1),(0,o.ensureInitialized)(i.FrameContexts.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!c)throw new Error("[files.copyMoveFiles] callback cannot be null");(0,r.sendMessageToParent)("files.copyMoveFiles",[e,t,n,a,s],c)},e.getFileDownloads=function(e){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");(0,r.sendMessageToParent)("files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,t){if(void 0===e&&(e=void 0),(0,o.ensureInitialized)(i.FrameContexts.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");(0,r.sendMessageToParent)("files.openDownloadFolder",[e],t)}})(t.files||(t.files={}))}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appEntity=void 0;var r=n(0),o=n(1),i=n(8);(t.appEntity||(t.appEntity={})).selectAppEntity=function(e,t,n,a){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!a)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");(0,r.sendMessageToParent)("appEntity.selectAppEntity",[e,t,n],a)}}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=void 0;var r=n(0),o=n(1),i=n(8);!(function(e){!(function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"})(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");(0,r.sendMessageToParent)("teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if((0,o.ensureInitialized)(),!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");(0,r.sendMessageToParent)("teams.refreshSiteUrl",[e],t)}})(t.teams||(t.teams={}))})])})),(function(){var e,t="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};e=function(e){var n,r;return (function(){"use strict";function e(e,t){var n=(e=e||"").split("/");return n.pop(),t.map((function(e){if("."===e[0]){var t=e.split("/"),r=n.slice(0);return t.forEach((function(e){".."===e?r.pop():"."!==e&&r.push(e)})),r.join("/")}return e}))}function t(t,r,a){return t.map((function(t){if("exports"===t)return a;if("require"===t)return function(t,o){n(e(r,t),o)};var s=i[t];if(!s)throw new Error("Undefined dependency: "+t);return s.resolved||(s.resolved=o(s.dependencies,s.factory,t,s.exports),void 0===s.resolved&&(s.resolved=s.exports)),s.resolved}))}function o(e,n,r,o){var i=t(e,r,o);return n&&n.apply?n.apply(null,i):n}var i={};r=function(t,n,r){Array.isArray(n)||(r=n,n=[]);var o={dependencies:e(t,n),factory:r};-1!==n.indexOf("exports")&&(o.exports={}),i[t]=o},n=function(e,t){Array.isArray(e)||(e=[e]),o(e,t)}})(),r("amd",(function(){})),r("WinJS/Core/_WinJS",{}),r("WinJS/Core/_Global",[],(function(){"use strict";return"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{}})),r("WinJS/Core/_BaseCoreUtils",["./_Global"],(function(e){"use strict";var t=!!e.Windows,n=!1;return{hasWinRT:t,markSupportedForProcessing:function(e){return e.supportedForProcessing=!0,e},_setImmediate:function(t){if(!n){if(!e.Core||!e.Core.Tasks)return void e.setTimeout(t,0);n=!0}e.Core.Tasks.schedule(t,"WinJS.BaseCoreUtil._setImmediate")}}})),r("WinJS/Core/_WriteProfilerMark",["./_Global"],(function(e){"use strict";return e.msWriteProfilerMark||function(){}})),r("WinJS/Core/_Base",["./_WinJS","./_Global","./_BaseCoreUtils","./_WriteProfilerMark"],(function(e,t,n,r){"use strict";function o(e,t,n){var r,o,i,a=Object.keys(t),s=Array.isArray(e);for(o=0,i=a.length;o<i;o++){var c=a[o],l=95!==c.charCodeAt(0),u=t[c];!u||"object"!=typeof u||void 0===u.value&&"function"!=typeof u.get&&"function"!=typeof u.set?l?s?e.forEach((function(e){e[c]=u})):e[c]=u:(r=r||{})[c]={value:u,enumerable:l,configurable:!0,writable:!0}:(void 0===u.enumerable&&(u.enumerable=l),n&&u.setName&&"function"==typeof u.setName&&u.setName(n+"."+c),(r=r||{})[c]=u)}r&&(s?e.forEach((function(e){Object.defineProperties(e,r)})):Object.defineProperties(e,r))}return (function(){function n(n,r){var o=n||{};if(r){var i=r.split(".");o===t&&"WinJS"===i[0]&&(o=e,i.splice(0,1));for(var a=0,s=i.length;a<s;a++){var c=i[a];o[c]||Object.defineProperty(o,c,{value:{},writable:!1,enumerable:!0,configurable:!0}),o=o[c]}}return o}function i(e,t,r){var i=n(e,t);return r&&o(i,r,t||"<ANONYMOUS>"),i}var a=e;a.Namespace||(a.Namespace=Object.create(Object.prototype));var s={uninitialized:1,working:2,initialized:3};Object.defineProperties(a.Namespace,{defineWithParent:{value:i,writable:!0,enumerable:!0,configurable:!0},define:{value:function(e,n){return i(t,e,n)},writable:!0,enumerable:!0,configurable:!0},_lazy:{value:function(e){var t,n,o=s.uninitialized;return{setName:function(e){t=e},get:function(){switch(o){case s.initialized:return n;case s.uninitialized:o=s.working;try{r("WinJS.Namespace._lazy:"+t+",StartTM"),n=e()}finally{r("WinJS.Namespace._lazy:"+t+",StopTM"),o=s.uninitialized}return e=null,o=s.initialized,n;case s.working:throw"Illegal: reentrancy on initialization";default:throw"Illegal"}},set:function(e){switch(o){case s.working:throw"Illegal: reentrancy on initialization";default:o=s.initialized,n=e}},enumerable:!0,configurable:!0}},writable:!0,enumerable:!0,configurable:!0},_moduleDefine:{value:function(e,r,i){var a=[e],s=null;return r&&(s=n(t,r),a.push(s)),o(a,i,r||"<ANONYMOUS>"),s},writable:!0,enumerable:!0,configurable:!0}})})(),(function(){function t(e,t,r){return e=e||function(){},n.markSupportedForProcessing(e),t&&o(e.prototype,t),r&&o(e,r),e}e.Namespace.define("WinJS.Class",{define:t,derive:function(e,r,i,a){if(e){r=r||function(){};var s=e.prototype;return r.prototype=Object.create(s),n.markSupportedForProcessing(r),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,configurable:!0,enumerable:!0}),i&&o(r.prototype,i),a&&o(r,a),r}return t(r,i,a)},mix:function(e){var t,n;for(e=e||function(){},t=1,n=arguments.length;t<n;t++)o(e.prototype,arguments[t]);return e}})})(),{Namespace:e.Namespace,Class:e.Class}})),r("WinJS/Core/_ErrorFromName",["./_Base"],(function(e){"use strict";var t=e.Class.derive(Error,(function(e,t){this.name=e,this.message=t||e}),{},{supportedForProcessing:!1});return e.Namespace.define("WinJS",{ErrorFromName:t}),t})),r("WinJS/Core/_WinRT",["exports","./_Global","./_Base"],(function(e,t,n){"use strict";e.msGetWeakWinRTProperty=t.msGetWeakWinRTProperty,e.msSetWeakWinRTProperty=t.msSetWeakWinRTProperty;var r=!0;try{t.Windows.UI.ViewManagement.InputPane.getForCurrentView(),r=!0}catch(e){}["Windows.ApplicationModel.DesignMode.designModeEnabled","Windows.ApplicationModel.Resources.Core.ResourceContext","Windows.ApplicationModel.Resources.Core.ResourceManager","Windows.ApplicationModel.Search.SearchQueryLinguisticDetails","Windows.Data.Text.SemanticTextQuery","Windows.Foundation.Collections.CollectionChange","Windows.Foundation.Diagnostics","Windows.Foundation.Uri","Windows.Globalization.ApplicationLanguages","Windows.Globalization.Calendar","Windows.Globalization.DateTimeFormatting","Windows.Globalization.Language","Windows.Phone.UI.Input.HardwareButtons","Windows.Storage.ApplicationData","Windows.Storage.CreationCollisionOption","Windows.Storage.BulkAccess.FileInformationFactory","Windows.Storage.FileIO","Windows.Storage.FileProperties.ThumbnailType","Windows.Storage.FileProperties.ThumbnailMode","Windows.Storage.FileProperties.ThumbnailOptions","Windows.Storage.KnownFolders","Windows.Storage.Search.FolderDepth","Windows.Storage.Search.IndexerOption","Windows.Storage.Streams.RandomAccessStreamReference","Windows.UI.ApplicationSettings.SettingsEdgeLocation","Windows.UI.ApplicationSettings.SettingsCommand","Windows.UI.ApplicationSettings.SettingsPane","Windows.UI.Core.AnimationMetrics","Windows.UI.Core.SystemNavigationManager","Windows.UI.Input.EdgeGesture","Windows.UI.Input.EdgeGestureKind","Windows.UI.Input.PointerPoint","Windows.UI.ViewManagement.HandPreference","Windows.UI.ViewManagement.InputPane","Windows.UI.ViewManagement.UIColorType","Windows.UI.ViewManagement.UISettings","Windows.UI.WebUI.Core.WebUICommandBar","Windows.UI.WebUI.Core.WebUICommandBarBitmapIcon","Windows.UI.WebUI.Core.WebUICommandBarClosedDisplayMode","Windows.UI.WebUI.Core.WebUICommandBarIconButton","Windows.UI.WebUI.Core.WebUICommandBarSymbolIcon","Windows.UI.WebUI.WebUIApplication"].forEach((function(o){var i=o.split("."),a={};a[i[i.length-1]]={get:function(){return r?i.reduce((function(e,t){return e?e[t]:null}),t):null}},n.Namespace.defineWithParent(e,i.slice(0,-1).join("."),a)}))})),r("WinJS/Core/_Events",["exports","./_Base"],(function(e,t){"use strict";function n(e){var t="_on"+e+"state";return{get:function(){var e=this[t];return e&&e.userHandler},set:function(n){var r=this[t];n?(r||(r={wrapper:function(e){return r.userHandler(e)},userHandler:n},Object.defineProperty(this,t,{value:r,enumerable:!1,writable:!0,configurable:!0}),this.addEventListener(e,r.wrapper,!1)),r.userHandler=n):r&&(this.removeEventListener(e,r.wrapper,!1),this[t]=null)},enumerable:!0}}var r=t.Class.define((function(e,t,n){this.detail=t,this.target=n,this.timeStamp=Date.now(),this.type=e}),{bubbles:{value:!1,writable:!1},cancelable:{value:!1,writable:!1},currentTarget:{get:function(){return this.target}},defaultPrevented:{get:function(){return this._preventDefaultCalled}},trusted:{value:!1,writable:!1},eventPhase:{value:0,writable:!1},target:null,timeStamp:null,type:null,preventDefault:function(){this._preventDefaultCalled=!0},stopImmediatePropagation:function(){this._stopImmediatePropagationCalled=!0},stopPropagation:function(){}},{supportedForProcessing:!1}),o={_listeners:null,addEventListener:function(e,t,n){n=n||!1,this._listeners=this._listeners||{};for(var r=this._listeners[e]=this._listeners[e]||[],o=0,i=r.length;o<i;o++){var a=r[o];if(a.useCapture===n&&a.listener===t)return}r.push({listener:t,useCapture:n})},dispatchEvent:function(e,t){var n=this._listeners&&this._listeners[e];if(n){for(var o=new r(e,t,this),i=0,a=(n=n.slice(0,n.length)).length;i<a&&!o._stopImmediatePropagationCalled;i++)n[i].listener(o);return o.defaultPrevented||!1}return!1},removeEventListener:function(e,t,n){n=n||!1;var r=this._listeners&&this._listeners[e];if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a.listener===t&&a.useCapture===n){r.splice(o,1),0===r.length&&delete this._listeners[e];break}}}};t.Namespace._moduleDefine(e,"WinJS.Utilities",{_createEventProperty:n,createEventProperties:function(){for(var e={},t=0,r=arguments.length;t<r;t++){var o=arguments[t];e["on"+o]=n(o)}return e},eventMixin:o})})),r("require-json",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),r("require-json!strings/en-us/Microsoft.WinJS.resjson",{"tv/scrollViewerPageDown":"Page Down","tv/scrollViewerPageUp":"Page Up","ui/appBarAriaLabel":"App Bar","ui/appBarCommandAriaLabel":"App Bar Item","ui/appBarOverflowButtonAriaLabel":"View more","ui/autoSuggestBoxAriaLabel":"Autosuggestbox","ui/autoSuggestBoxAriaLabelInputNoPlaceHolder":"Autosuggestbox, enter to submit query, esc to clear text","ui/autoSuggestBoxAriaLabelInputPlaceHolder":"Autosuggestbox, {0}, enter to submit query, esc to clear text","ui/autoSuggestBoxAriaLabelQuery":"Suggestion: {0}","_ui/autoSuggestBoxAriaLabelQuery.comment":"Suggestion: query text (example: Suggestion: contoso)","ui/autoSuggestBoxAriaLabelSeparator":"Separator: {0}","_ui/autoSuggestBoxAriaLabelSeparator.comment":"Separator: separator text (example: Separator: People or Separator: Apps)","ui/autoSuggestBoxAriaLabelResult":"Result: {0}, {1}","_ui/autoSuggestBoxAriaLabelResult.comment":"Result: text, detailed text (example: Result: contoso, www.contoso.com)","ui/averageRating":"Average Rating","ui/backbuttonarialabel":"Back","ui/chapterSkipBackMediaCommandDisplayText":"Chapter back","ui/chapterSkipForwardMediaCommandDisplayText":"Chapter forward","ui/clearYourRating":"Clear your rating","ui/closedCaptionsLabelNone":"Off","ui/closedCaptionsMediaCommandDisplayText":"Closed captioning","ui/closeOverlay":"Close","ui/commandingSurfaceAriaLabel":"CommandingSurface","ui/commandingSurfaceOverflowButtonAriaLabel":"View more","ui/datePicker":"Date Picker","ui/fastForwardMediaCommandDisplayText":"Fast forward","ui/fastForwardFeedbackDisplayText":" {0}X","ui/fastForwardFeedbackSlowMotionDisplayText":"0.5X","ui/flipViewPanningContainerAriaLabel":"Scrolling Container","ui/flyoutAriaLabel":"Flyout","ui/goToFullScreenButtonLabel":"Go full screen","ui/goToLiveMediaCommandDisplayText":"LIVE","ui/hubViewportAriaLabel":"Scrolling Container","ui/listViewViewportAriaLabel":"Scrolling Container","ui/mediaErrorAborted":"Playback was interrupted. Please try again.","ui/mediaErrorNetwork":"There was a network connection error.","ui/mediaErrorDecode":"The content could not be decoded","ui/mediaErrorSourceNotSupported":"This content type is not supported.","ui/mediaErrorUnknown":"There was an unknown error.","ui/mediaPlayerAudioTracksButtonLabel":"Audio tracks","ui/mediaPlayerCastButtonLabel":"Cast","ui/mediaPlayerChapterSkipBackButtonLabel":"Previous","ui/mediaPlayerChapterSkipForwardButtonLabel":"Next","ui/mediaPlayerClosedCaptionsButtonLabel":"Closed captions","ui/mediaPlayerFastForwardButtonLabel":"Fast forward","ui/mediaPlayerFullscreenButtonLabel":"Fullscreen","ui/mediaPlayerLiveButtonLabel":"LIVE","ui/mediaPlayerNextTrackButtonLabel":"Next","ui/mediaPlayerOverlayActiveOptionIndicator":"(On)","ui/mediaPlayerPauseButtonLabel":"Pause","ui/mediaPlayerPlayButtonLabel":"Play","ui/mediaPlayerPlayFromBeginningButtonLabel":"Replay","ui/mediaPlayerPlayRateButtonLabel":"Playback rate","ui/mediaPlayerPreviousTrackButtonLabel":"Previous","ui/mediaPlayerRewindButtonLabel":"Rewind","ui/mediaPlayerStopButtonLabel":"Stop","ui/mediaPlayerTimeSkipBackButtonLabel":"8 second replay","ui/mediaPlayerTimeSkipForwardButtonLabel":"30 second skip","ui/mediaPlayerToggleSnapButtonLabel":"Snap","ui/mediaPlayerVolumeButtonLabel":"Volume","ui/mediaPlayerZoomButtonLabel":"Zoom","ui/menuCommandAriaLabel":"Menu Item","ui/menuAriaLabel":"Menu","ui/navBarContainerViewportAriaLabel":"Scrolling Container","ui/nextTrackMediaCommandDisplayText":"Next track","ui/off":"Off","ui/on":"On","ui/pauseMediaCommandDisplayText":"Pause","ui/playFromBeginningMediaCommandDisplayText":"Play again","ui/playbackRateHalfSpeedLabel":"0.5x","ui/playbackRateNormalSpeedLabel":"Normal","ui/playbackRateOneAndHalfSpeedLabel":"1.5x","ui/playbackRateDoubleSpeedLabel":"2x","ui/playMediaCommandDisplayText":"Play","ui/pivotAriaLabel":"Pivot","ui/pivotViewportAriaLabel":"Scrolling Container","ui/replayMediaCommandDisplayText":"Play again","ui/rewindMediaCommandDisplayText":"Rewind","ui/rewindFeedbackDisplayText":" {0}X","ui/rewindFeedbackSlowMotionDisplayText":"0.5X","ui/searchBoxAriaLabel":"Searchbox","ui/searchBoxAriaLabelInputNoPlaceHolder":"Searchbox, enter to submit query, esc to clear text","ui/searchBoxAriaLabelInputPlaceHolder":"Searchbox, {0}, enter to submit query, esc to clear text","ui/searchBoxAriaLabelButton":"Click to submit query","ui/seeMore":"See more","ui/selectAMPM":"Select A.M P.M","ui/selectDay":"Select Day","ui/selectHour":"Select Hour","ui/selectMinute":"Select Minute","ui/selectMonth":"Select Month","ui/selectYear":"Select Year","ui/settingsFlyoutAriaLabel":"Settings Flyout","ui/stopMediaCommandDisplayText":"Stop","ui/tentativeRating":"Tentative Rating","ui/timePicker":"Time Picker","ui/timeSeparator":":","ui/timeSkipBackMediaCommandDisplayText":"Skip back","ui/timeSkipForwardMediaCommandDisplayText":"Skip forward","ui/toolbarAriaLabel":"ToolBar","ui/toolbarOverflowButtonAriaLabel":"View more","ui/unrated":"Unrated","ui/userRating":"User Rating","ui/zoomMediaCommandDisplayText":"Zoom","ui/appBarIcons/previous":"","_ui/appBarIcons/previous.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/next":"","_ui/appBarIcons/next.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/play":"","_ui/appBarIcons/play.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/pause":"","_ui/appBarIcons/pause.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/edit":"","_ui/appBarIcons/edit.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/save":"","_ui/appBarIcons/save.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/clear":"","_ui/appBarIcons/clear.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/delete":"","_ui/appBarIcons/delete.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/remove":"","_ui/appBarIcons/remove.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/add":"","_ui/appBarIcons/add.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cancel":"","_ui/appBarIcons/cancel.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/accept":"","_ui/appBarIcons/accept.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/more":"","_ui/appBarIcons/more.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/redo":"","_ui/appBarIcons/redo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/undo":"","_ui/appBarIcons/undo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/home":"","_ui/appBarIcons/home.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/up":"","_ui/appBarIcons/up.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/forward":"","_ui/appBarIcons/forward.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/right":"","_ui/appBarIcons/right.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/back":"","_ui/appBarIcons/back.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/left":"","_ui/appBarIcons/left.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/favorite":"","_ui/appBarIcons/favorite.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/camera":"","_ui/appBarIcons/camera.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/settings":"","_ui/appBarIcons/settings.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/video":"","_ui/appBarIcons/video.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/sync":"","_ui/appBarIcons/sync.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/download":"","_ui/appBarIcons/download.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mail":"","_ui/appBarIcons/mail.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/find":"","_ui/appBarIcons/find.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/help":"","_ui/appBarIcons/help.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/upload":"","_ui/appBarIcons/upload.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/emoji":"","_ui/appBarIcons/emoji.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/twopage":"","_ui/appBarIcons/twopage.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/leavechat":"","_ui/appBarIcons/leavechat.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mailforward":"","_ui/appBarIcons/mailforward.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/clock":"","_ui/appBarIcons/clock.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/send":"","_ui/appBarIcons/send.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/crop":"","_ui/appBarIcons/crop.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/rotatecamera":"","_ui/appBarIcons/rotatecamera.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/people":"","_ui/appBarIcons/people.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/closepane":"","_ui/appBarIcons/closepane.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openpane":"","_ui/appBarIcons/openpane.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/world":"","_ui/appBarIcons/world.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/flag":"","_ui/appBarIcons/flag.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/previewlink":"","_ui/appBarIcons/previewlink.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/globe":"","_ui/appBarIcons/globe.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/trim":"","_ui/appBarIcons/trim.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/attachcamera":"","_ui/appBarIcons/attachcamera.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zoomin":"","_ui/appBarIcons/zoomin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/bookmarks":"","_ui/appBarIcons/bookmarks.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/document":"","_ui/appBarIcons/document.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/protecteddocument":"","_ui/appBarIcons/protecteddocument.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/page":"","_ui/appBarIcons/page.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/bullets":"","_ui/appBarIcons/bullets.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/comment":"","_ui/appBarIcons/comment.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mail2":"","_ui/appBarIcons/mail2.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contactinfo":"","_ui/appBarIcons/contactinfo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/hangup":"","_ui/appBarIcons/hangup.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/viewall":"","_ui/appBarIcons/viewall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mappin":"","_ui/appBarIcons/mappin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/phone":"","_ui/appBarIcons/phone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/videochat":"","_ui/appBarIcons/videochat.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/switch":"","_ui/appBarIcons/switch.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contact":"","_ui/appBarIcons/contact.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/rename":"","_ui/appBarIcons/rename.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/pin":"","_ui/appBarIcons/pin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/musicinfo":"","_ui/appBarIcons/musicinfo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/go":"","_ui/appBarIcons/go.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/keyboard":"","_ui/appBarIcons/keyboard.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/dockleft":"","_ui/appBarIcons/dockleft.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/dockright":"","_ui/appBarIcons/dockright.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/dockbottom":"","_ui/appBarIcons/dockbottom.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/remote":"","_ui/appBarIcons/remote.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/refresh":"","_ui/appBarIcons/refresh.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/rotate":"","_ui/appBarIcons/rotate.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/shuffle":"","_ui/appBarIcons/shuffle.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/list":"","_ui/appBarIcons/list.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/shop":"","_ui/appBarIcons/shop.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/selectall":"","_ui/appBarIcons/selectall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/orientation":"","_ui/appBarIcons/orientation.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/import":"","_ui/appBarIcons/import.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/importall":"","_ui/appBarIcons/importall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/browsephotos":"","_ui/appBarIcons/browsephotos.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/webcam":"","_ui/appBarIcons/webcam.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/pictures":"","_ui/appBarIcons/pictures.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/savelocal":"","_ui/appBarIcons/savelocal.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/caption":"","_ui/appBarIcons/caption.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/stop":"","_ui/appBarIcons/stop.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/showresults":"","_ui/appBarIcons/showresults.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/volume":"","_ui/appBarIcons/volume.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/repair":"","_ui/appBarIcons/repair.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/message":"","_ui/appBarIcons/message.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/page2":"","_ui/appBarIcons/page2.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calendarday":"","_ui/appBarIcons/calendarday.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calendarweek":"","_ui/appBarIcons/calendarweek.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calendar":"","_ui/appBarIcons/calendar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/characters":"","_ui/appBarIcons/characters.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mailreplyall":"","_ui/appBarIcons/mailreplyall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/read":"","_ui/appBarIcons/read.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/link":"","_ui/appBarIcons/link.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/accounts":"","_ui/appBarIcons/accounts.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/showbcc":"","_ui/appBarIcons/showbcc.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/hidebcc":"","_ui/appBarIcons/hidebcc.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cut":"","_ui/appBarIcons/cut.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/attach":"","_ui/appBarIcons/attach.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/paste":"","_ui/appBarIcons/paste.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/filter":"","_ui/appBarIcons/filter.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/copy":"","_ui/appBarIcons/copy.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/emoji2":"","_ui/appBarIcons/emoji2.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/important":"","_ui/appBarIcons/important.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mailreply":"","_ui/appBarIcons/mailreply.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/slideshow":"","_ui/appBarIcons/slideshow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/sort":"","_ui/appBarIcons/sort.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/manage":"","_ui/appBarIcons/manage.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/allapps":"","_ui/appBarIcons/allapps.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/disconnectdrive":"","_ui/appBarIcons/disconnectdrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mapdrive":"","_ui/appBarIcons/mapdrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/newwindow":"","_ui/appBarIcons/newwindow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openwith":"","_ui/appBarIcons/openwith.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contactpresence":"","_ui/appBarIcons/contactpresence.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/priority":"","_ui/appBarIcons/priority.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/uploadskydrive":"","_ui/appBarIcons/uploadskydrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/gototoday":"","_ui/appBarIcons/gototoday.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/font":"","_ui/appBarIcons/font.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontcolor":"","_ui/appBarIcons/fontcolor.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contact2":"","_ui/appBarIcons/contact2.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/folder":"","_ui/appBarIcons/folder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/audio":"","_ui/appBarIcons/audio.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/placeholder":"","_ui/appBarIcons/placeholder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/view":"","_ui/appBarIcons/view.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/setlockscreen":"","_ui/appBarIcons/setlockscreen.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/settile":"","_ui/appBarIcons/settile.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cc":"","_ui/appBarIcons/cc.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/stopslideshow":"","_ui/appBarIcons/stopslideshow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/permissions":"","_ui/appBarIcons/permissions.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/highlight":"","_ui/appBarIcons/highlight.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/disableupdates":"","_ui/appBarIcons/disableupdates.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unfavorite":"","_ui/appBarIcons/unfavorite.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unpin":"","_ui/appBarIcons/unpin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openlocal":"","_ui/appBarIcons/openlocal.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mute":"","_ui/appBarIcons/mute.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/italic":"","_ui/appBarIcons/italic.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/underline":"","_ui/appBarIcons/underline.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/bold":"","_ui/appBarIcons/bold.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/movetofolder":"","_ui/appBarIcons/movetofolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/likedislike":"","_ui/appBarIcons/likedislike.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/dislike":"","_ui/appBarIcons/dislike.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/like":"","_ui/appBarIcons/like.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/alignright":"","_ui/appBarIcons/alignright.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/aligncenter":"","_ui/appBarIcons/aligncenter.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/alignleft":"","_ui/appBarIcons/alignleft.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zoom":"","_ui/appBarIcons/zoom.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zoomout":"","_ui/appBarIcons/zoomout.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openfile":"","_ui/appBarIcons/openfile.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/otheruser":"","_ui/appBarIcons/otheruser.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/admin":"","_ui/appBarIcons/admin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/street":"","_ui/appBarIcons/street.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/map":"","_ui/appBarIcons/map.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/clearselection":"","_ui/appBarIcons/clearselection.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontdecrease":"","_ui/appBarIcons/fontdecrease.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontincrease":"","_ui/appBarIcons/fontincrease.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontsize":"","_ui/appBarIcons/fontsize.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cellphone":"","_ui/appBarIcons/cellphone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/print":"","_ui/appBarIcons/print.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/share":"","_ui/appBarIcons/share.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/reshare":"","_ui/appBarIcons/reshare.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/tag":"","_ui/appBarIcons/tag.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/repeatone":"","_ui/appBarIcons/repeatone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/repeatall":"","_ui/appBarIcons/repeatall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/outlinestar":"","_ui/appBarIcons/outlinestar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/solidstar":"","_ui/appBarIcons/solidstar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calculator":"","_ui/appBarIcons/calculator.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/directions":"","_ui/appBarIcons/directions.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/target":"","_ui/appBarIcons/target.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/library":"","_ui/appBarIcons/library.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/phonebook":"","_ui/appBarIcons/phonebook.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/memo":"","_ui/appBarIcons/memo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/microphone":"","_ui/appBarIcons/microphone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/postupdate":"","_ui/appBarIcons/postupdate.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/backtowindow":"","_ui/appBarIcons/backtowindow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fullscreen":"","_ui/appBarIcons/fullscreen.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/newfolder":"","_ui/appBarIcons/newfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calendarreply":"","_ui/appBarIcons/calendarreply.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unsyncfolder":"","_ui/appBarIcons/unsyncfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/reporthacked":"","_ui/appBarIcons/reporthacked.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/syncfolder":"","_ui/appBarIcons/syncfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/blockcontact":"","_ui/appBarIcons/blockcontact.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/switchapps":"","_ui/appBarIcons/switchapps.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/addfriend":"","_ui/appBarIcons/addfriend.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/touchpointer":"","_ui/appBarIcons/touchpointer.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/gotostart":"","_ui/appBarIcons/gotostart.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zerobars":"","_ui/appBarIcons/zerobars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/onebar":"","_ui/appBarIcons/onebar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/twobars":"","_ui/appBarIcons/twobars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/threebars":"","_ui/appBarIcons/threebars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fourbars":"","_ui/appBarIcons/fourbars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/scan":"","_ui/appBarIcons/scan.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/preview":"","_ui/appBarIcons/preview.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/hamburger":"","_ui/appBarIcons/hamburger.comment":"{Locked=qps-ploc,qps-plocm}"}),r("WinJS/Core/_Resources",["exports","./_Global","./_WinRT","./_Base","./_Events","require-json!strings/en-us/Microsoft.WinJS.resjson"],(function(e,t,n,r,o,i){"use strict";function a(e){var t=h("ms-resource:///Microsoft.WinJS/"+e);return t.empty&&(t=(function(e){var t=i[e];return"string"==typeof t&&(t={value:t}),t||{value:e,empty:!0}})(e)),t}function s(e){var t=arguments;return t.length>1&&(e=e.replace(/({{)|(}})|{(\d+)}|({)|(})/g,(function(e,n,r,o,i,a){if(i||a)throw s(m.malformedFormatStringInput,i||a);return(n?"{":r&&"}")||t[1+(0|o)]}))),e}var c,l,u=!1,p="contextchanged",d=new(r.Class.mix(r.Class.define(null,{},{supportedForProcessing:!1}),o.eventMixin)),f=o._createEventProperty,m={get malformedFormatStringInput(){return"Malformed, did you mean to escape your '{0}'?"}};r.Namespace.define("WinJS.Resources",{_getWinJSString:a}),r.Namespace._moduleDefine(e,"WinJS.Resources",{addEventListener:function(t,r,o){if(n.Windows.ApplicationModel.Resources.Core.ResourceManager&&!u&&t===p)try{var i=e._getResourceContext();i?i.qualifierValues.addEventListener("mapchanged",(function(t){e.dispatchEvent(p,{qualifier:t.key,changed:t.target[t.key]})}),!1):n.Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.qualifierValues.addEventListener("mapchanged",(function(t){e.dispatchEvent(p,{qualifier:t.key,changed:t.target[t.key]})}),!1),u=!0}catch(e){}d.addEventListener(t,r,o)},removeEventListener:d.removeEventListener.bind(d),dispatchEvent:d.dispatchEvent.bind(d),_formatString:s,_getStringWinRT:function(t){if(!c){var r=n.Windows.ApplicationModel.Resources.Core.ResourceManager.current.mainResourceMap;try{c=r.getSubtree("Resources")}catch(e){}c||(c=r)}var o,i,a;try{var s=e._getResourceContext();(a=s?c.getValue(t,s):c.getValue(t))&&void 0===(o=a.valueAsString)&&(o=a.toString())}catch(e){}if(!o)return e._getStringJS(t);try{i=a.getQualifierValue("Language")}catch(e){return{value:o}}return{value:o,lang:i}},_getStringJS:function(e){var n=t.strings&&t.strings[e];return"string"==typeof n&&(n={value:n}),n||{value:e,empty:!0}},_getResourceContext:function(){if(t.document&&void 0===l){var e=n.Windows.ApplicationModel.Resources.Core.ResourceContext;l=e.getForCurrentView?e.getForCurrentView():null}return l},oncontextchanged:f(p)});var g=n.Windows.ApplicationModel.Resources.Core.ResourceManager?e._getStringWinRT:e._getStringJS,h=function(e){return g(e)};r.Namespace._moduleDefine(e,null,{_formatString:s,_getWinJSString:a}),r.Namespace._moduleDefine(e,"WinJS.Resources",{getString:{get:function(){return h},set:function(e){h=e}}})})),r("WinJS/Core/_Trace",["./_Global"],(function(e){"use strict";function t(e){return e}return{_traceAsyncOperationStarting:e.Debug&&e.Debug.msTraceAsyncOperationStarting&&e.Debug.msTraceAsyncOperationStarting.bind(e.Debug)||t,_traceAsyncOperationCompleted:e.Debug&&e.Debug.msTraceAsyncOperationCompleted&&e.Debug.msTraceAsyncOperationCompleted.bind(e.Debug)||t,_traceAsyncCallbackStarting:e.Debug&&e.Debug.msTraceAsyncCallbackStarting&&e.Debug.msTraceAsyncCallbackStarting.bind(e.Debug)||t,_traceAsyncCallbackCompleted:e.Debug&&e.Debug.msTraceAsyncCallbackCompleted&&e.Debug.msTraceAsyncCallbackCompleted.bind(e.Debug)||t}})),r("WinJS/Promise/_StateMachine",["../Core/_Global","../Core/_BaseCoreUtils","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Trace"],(function(e,t,n,r,o,i){"use strict";function a(){}function s(e,t){var n;n=t&&"object"==typeof t&&"function"==typeof t.then?L:j,e._value=t,e._setState(n)}function c(e,t,n,r,o,i){return{exception:e,error:t,promise:n,handler:i,id:r,parent:o}}function l(e,t,n,r){var o=n._isException;return c(o?t:null,o?null:t,e,n._errorId,n,r)}function u(e,t,n){var r=n._isException,o=n._errorId;return b(e,o,r),c(r?t:null,r?null:t,e,o,n)}function p(e,t){var n=++H;return b(e,n),c(null,t,e,n)}function d(e,t){var n=++H;return b(e,n,!0),c(t,null,e,n)}function f(e,t,n,r){w(e,{c:t,e:n,p:r,asyncOpID:i._traceAsyncOperationStarting("WinJS.Promise.done")})}function m(e,t,n,r){e._value=t,v(e,t,n,r),e._setState(D)}function g(t,n){var r,o,a=t._value,s=t._listeners;if(s)for(t._listeners=null,r=0,o=Array.isArray(s)?s.length:1;r<o;r++){var c=1===o?s:s[r],l=c.c,u=c.promise;if(i._traceAsyncOperationCompleted(c.asyncOpID,e.Debug&&e.Debug.MS_ASYNC_OP_STATUS_SUCCESS),u){i._traceAsyncCallbackStarting(c.asyncOpID);try{u._setCompleteValue(l?l(a):a)}catch(e){u._setExceptionValue(e)}finally{i._traceAsyncCallbackCompleted()}u._state!==L&&u._listeners&&n.push(u)}else G.prototype.done.call(t,l)}}function h(t,n){var r,o,a=t._value,s=t._listeners;if(s)for(t._listeners=null,r=0,o=Array.isArray(s)?s.length:1;r<o;r++){var c=1===o?s:s[r],u=c.e,p=c.promise,d=e.Debug&&(a&&a.name===T?e.Debug.MS_ASYNC_OP_STATUS_CANCELED:e.Debug.MS_ASYNC_OP_STATUS_ERROR);if(i._traceAsyncOperationCompleted(c.asyncOpID,d),p){var f=!1;try{u?(i._traceAsyncCallbackStarting(c.asyncOpID),f=!0,u.handlesOnError||v(p,a,l,t,u),p._setCompleteValue(u(a))):p._setChainedErrorValue(a,t)}catch(e){p._setExceptionValue(e)}finally{f&&i._traceAsyncCallbackCompleted()}p._state!==L&&p._listeners&&n.push(p)}else V.prototype.done.call(t,null,u)}}function v(e,t,n,r,o){if(I._listeners[A]){if(t instanceof Error&&t.message===T)return;I.dispatchEvent(A,n(e,t,r,o))}}function y(e,t){var n,r,o=e._listeners;if(o)for(n=0,r=Array.isArray(o)?o.length:1;n<r;n++){var i=1===r?o:o[n],a=i.p;if(a)try{a(t)}catch(e){}i.c||i.e||!i.promise||i.promise._progress(t)}}function w(e,t){var n=e._listeners;n?(n=Array.isArray(n)?n:[n]).push(t):n=t,e._listeners=n}function b(e,t,n){e._isException=n||!1,e._errorId=t}function C(e,t,n,r){e._value=t,v(e,t,n,r),e._setState(q)}function _(e,t){var n;n=t&&"object"==typeof t&&"function"==typeof t.then?L:R,e._value=t,e._setState(n)}function S(e,t,n,r){var o=new N(e);return w(e,{promise:o,c:t,e:n,p:r,asyncOpID:i._traceAsyncOperationStarting("WinJS.Promise.then")}),o}function P(n){var r;return new J((function(o){n?r=e.setTimeout(o,n):t._setImmediate(o)}),(function(){r&&e.clearTimeout(r)}))}e.Debug&&(e.Debug.setNonUserCodeExceptions=!0);var I=new(n.Class.mix(n.Class.define(null,{},{supportedForProcessing:!1}),o.eventMixin));I._listeners={};var A="error",T="Canceled",k=!1,F={promise:1,thenPromise:2,errorPromise:4,exceptionPromise:8,completePromise:16};F.all=F.promise|F.thenPromise|F.errorPromise|F.exceptionPromise|F.completePromise;var E,O,L,M,B,x,j,R,D,q,H=1;E={name:"created",enter:function(e){e._setState(O)},cancel:a,done:a,then:a,_completed:a,_error:a,_notify:a,_progress:a,_setCompleteValue:a,_setErrorValue:a},O={name:"working",enter:a,cancel:function(e){e._setState(B)},done:f,then:S,_completed:s,_error:m,_notify:a,_progress:y,_setCompleteValue:_,_setErrorValue:C},L={name:"waiting",enter:function(e){var t=e._value;if(t instanceof N&&t._state!==q&&t._state!==R)w(t,{promise:e});else{var n=function(r){t._errorId?e._chainedError(r,t):(v(e,r,l,t,n),e._error(r))};n.handlesOnError=!0,t.then(e._completed.bind(e),n,e._progress.bind(e))}},cancel:function(e){e._setState(M)},done:f,then:S,_completed:s,_error:m,_notify:a,_progress:y,_setCompleteValue:_,_setErrorValue:C},M={name:"waiting_canceled",enter:function(e){e._setState(x);var t=e._value;t.cancel&&t.cancel()},cancel:a,done:f,then:S,_completed:s,_error:m,_notify:a,_progress:y,_setCompleteValue:_,_setErrorValue:C},B={name:"canceled",enter:function(e){e._setState(x),e._cancelAction()},cancel:a,done:f,then:S,_completed:s,_error:m,_notify:a,_progress:y,_setCompleteValue:_,_setErrorValue:C},x={name:"canceling",enter:function(e){var t=new Error(T);t.name=t.message,e._value=t,e._setState(D)},cancel:a,done:a,then:a,_completed:a,_error:a,_notify:a,_progress:a,_setCompleteValue:a,_setErrorValue:a},j={name:"complete_notify",enter:function(e){if(e.done=G.prototype.done,e.then=G.prototype.then,e._listeners)for(var t,n=[e];n.length;)(t=n.shift())._state._notify(t,n);e._setState(R)},cancel:a,done:null,then:null,_completed:a,_error:a,_notify:g,_progress:a,_setCompleteValue:a,_setErrorValue:a},R={name:"success",enter:function(e){e.done=G.prototype.done,e.then=G.prototype.then,e._cleanupAction()},cancel:a,done:null,then:null,_completed:a,_error:a,_notify:g,_progress:a,_setCompleteValue:a,_setErrorValue:a},D={name:"error_notify",enter:function(e){if(e.done=V.prototype.done,e.then=V.prototype.then,e._listeners)for(var t,n=[e];n.length;)(t=n.shift())._state._notify(t,n);e._setState(q)},cancel:a,done:null,then:null,_completed:a,_error:a,_notify:h,_progress:a,_setCompleteValue:a,_setErrorValue:a},q={name:"error",enter:function(e){e.done=V.prototype.done,e.then=V.prototype.then,e._cleanupAction()},cancel:a,done:null,then:null,_completed:a,_error:a,_notify:h,_progress:a,_setCompleteValue:a,_setErrorValue:a};var W,U=n.Class.define(null,{_listeners:null,_nextState:null,_state:null,_value:null,cancel:function(){this._state.cancel(this),this._run()},done:function(e,t,n){this._state.done(this,e,t,n)},then:function(e,t,n){return this._state.then(this,e,t,n)},_chainedError:function(e,t){var n=this._state._error(this,e,u,t);return this._run(),n},_completed:function(e){var t=this._state._completed(this,e);return this._run(),t},_error:function(e){var t=this._state._error(this,e,p);return this._run(),t},_progress:function(e){this._state._progress(this,e)},_setState:function(e){this._nextState=e},_setCompleteValue:function(e){this._state._setCompleteValue(this,e),this._run()},_setChainedErrorValue:function(e,t){var n=this._state._setErrorValue(this,e,u,t);return this._run(),n},_setExceptionValue:function(e){var t=this._state._setErrorValue(this,e,d);return this._run(),t},_run:function(){for(;this._nextState;)this._state=this._nextState,this._nextState=null,this._state.enter(this)}},{supportedForProcessing:!1}),N=n.Class.derive(U,(function(e){k&&(!0===k||k&F.thenPromise)&&(this._stack=J._getStack()),this._creator=e,this._setState(E),this._run()}),{_creator:null,_cancelAction:function(){this._creator&&this._creator.cancel()},_cleanupAction:function(){this._creator=null}},{supportedForProcessing:!1}),V=n.Class.define((function(e){k&&(!0===k||k&F.errorPromise)&&(this._stack=J._getStack()),this._value=e,v(this,e,p)}),{cancel:function(){},done:function(e,t){var n=this._value;if(t)try{t.handlesOnError||v(null,n,l,this,t);var r=t(n);return void(r&&"object"==typeof r&&"function"==typeof r.done&&r.done())}catch(e){n=e}n instanceof Error&&n.message===T||J._doneHandler(n)},then:function(e,t){if(!t)return this;var n,r=this._value;try{t.handlesOnError||v(null,r,l,this,t),n=new G(t(r))}catch(e){n=e===r?this:new z(e)}return n}},{supportedForProcessing:!1}),z=n.Class.derive(V,(function(e){k&&(!0===k||k&F.exceptionPromise)&&(this._stack=J._getStack()),this._value=e,v(this,e,d)}),{},{supportedForProcessing:!1}),G=n.Class.define((function(e){if(k&&(!0===k||k&F.completePromise)&&(this._stack=J._getStack()),e&&"object"==typeof e&&"function"==typeof e.then){var t=new N(null);return t._setCompleteValue(e),t}this._value=e}),{cancel:function(){},done:function(e){if(e)try{var t=e(this._value);t&&"object"==typeof t&&"function"==typeof t.done&&t.done()}catch(e){J._doneHandler(e)}},then:function(e){try{var t=e?e(this._value):this._value;return t===this._value?this:new G(t)}catch(e){return new z(e)}}},{supportedForProcessing:!1}),J=n.Class.derive(U,(function(e,t){k&&(!0===k||k&F.promise)&&(this._stack=J._getStack()),this._oncancel=t,this._setState(E),this._run();try{e(this._completed.bind(this),this._error.bind(this),this._progress.bind(this))}catch(e){this._setExceptionValue(e)}}),{_oncancel:null,_cancelAction:function(){if(this._oncancel)try{this._oncancel()}catch(e){}},_cleanupAction:function(){this._oncancel=null}},{addEventListener:function(e,t,n){I.addEventListener(e,t,n)},any:function(e){return new J((function(t,n){var r=Object.keys(e);0===r.length&&t();var o=0;r.forEach((function(i){J.as(e[i]).then((function(){t({key:i,value:e[i]})}),(function(a){a instanceof Error&&a.name===T?++o===r.length&&t(J.cancel):n({key:i,value:e[i]})}))}))}),(function(){Object.keys(e).forEach((function(t){var n=J.as(e[t]);"function"==typeof n.cancel&&n.cancel()}))}))},as:function(e){return e&&"object"==typeof e&&"function"==typeof e.then?e:new G(e)},cancel:{get:function(){return W=W||new V(new r(T))}},dispatchEvent:function(e,t){return I.dispatchEvent(e,t)},is:function(e){return e&&"object"==typeof e&&"function"==typeof e.then},join:function(e){return new J((function(t,n,r){var o=Object.keys(e),i=Array.isArray(e)?[]:{},a=Array.isArray(e)?[]:{},s=0,c=o.length,l=function(e){if(0==--c){var s=Object.keys(i).length;if(0===s)t(a);else{var l=0;o.forEach((function(e){var t=i[e];t instanceof Error&&t.name===T&&l++})),l===s?t(J.cancel):n(i)}}else r({Key:e,Done:!0})};o.forEach((function(t){var n=e[t];void 0===n?s++:J.then(n,(function(e){a[t]=e,l(t)}),(function(e){i[t]=e,l(t)}))})),0!=(c-=s)||t(a)}),(function(){Object.keys(e).forEach((function(t){var n=J.as(e[t]);"function"==typeof n.cancel&&n.cancel()}))}))},removeEventListener:function(e,t,n){I.removeEventListener(e,t,n)},supportedForProcessing:!1,then:function(e,t,n,r){return J.as(e).then(t,n,r)},thenEach:function(e,t,n,r){var o=Array.isArray(e)?[]:{};return Object.keys(e).forEach((function(i){o[i]=J.as(e[i]).then(t,n,r)})),J.join(o)},timeout:function(e,t){var n=P(e);return t?(function(e,t){var n=function(){e.cancel()};return e.then((function(){t.cancel()})),t.then(n,n),t})(n,t):n},wrap:function(e){return new G(e)},wrapError:function(e){return new V(e)},_veryExpensiveTagWithStack:{get:function(){return k},set:function(e){k=e}},_veryExpensiveTagWithStack_tag:F,_getStack:function(){if(e.Debug&&e.Debug.debuggerEnabled)try{throw new Error}catch(e){return e.stack}},_cancelBlocker:function(e,t){if(!J.is(e))return J.wrap(e);var n,r,o=new J((function(e,t){n=e,r=t}),(function(){n=null,r=null,t&&t()}));return e.then((function(e){n&&n(e)}),(function(e){r&&r(e)})),o}});return Object.defineProperties(J,o.createEventProperties(A)),J._doneHandler=function(e){t._setImmediate((function(){throw e}))},{PromiseStateMachine:U,Promise:J,ErrorPromise:V,state_created:E}})),r("WinJS/Promise",["./Core/_Base","./Promise/_StateMachine"],(function(e,t){"use strict";return e.Namespace.define("WinJS",{Promise:t.Promise,ErrorPromise:t.ErrorPromise}),t.Promise})),r("WinJS/Core/_Log",["exports","./_Global","./_Base"],(function(e,t,n){"use strict";function r(n,r,o){var i=e.formatLog(n,r,o);t.console&&t.console[o&&a.test(o)?o:"log"](i)}function o(e){return e.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")}var i=/\s+/g,a=/^(error|warn|info|log)$/,s=null;n.Namespace._moduleDefine(e,"WinJS.Utilities",{startLog:function(t){"string"==typeof(t=t||{})&&(t={tags:t});var n=t.type&&new RegExp("^("+o(t.type).replace(i," ").split(" ").join("|")+")$"),a=t.excludeTags&&new RegExp("(^|\\s)("+o(t.excludeTags).replace(i," ").split(" ").join("|")+")(\\s|$)","i"),s=t.tags&&new RegExp("(^|\\s)("+o(t.tags).replace(i," ").split(" ").join("|")+")(\\s|$)","i"),c=t.action||r;if(n||a||s||e.log){var l=function(e,t,r){n&&!n.test(r)||a&&a.test(t)||s&&!s.test(t)||c(e,t,r),l.next&&l.next(e,t,r)};l.next=e.log,e.log=l}else e.log=c},stopLog:function(){e.log=null},formatLog:function(e,t,n){var r=e;return"function"==typeof r&&(r=r()),(n&&a.test(n)?"":n?n+": ":"")+(t?t.replace(i,":")+": ":"")+r}}),n.Namespace._moduleDefine(e,"WinJS",{log:{get:function(){return s},set:function(e){s=e}}})})),r("WinJS/Scheduler",["exports","./Core/_Global","./Core/_Base","./Core/_BaseCoreUtils","./Core/_ErrorFromName","./Core/_Log","./Core/_Resources","./Core/_Trace","./Core/_WriteProfilerMark","./Promise"],(function(e,t,n,r,o,i,a,s,c,l){"use strict";function u(e){var t={},n="_prev"+e,r="_next"+e;return t["_remove"+e]=function(){var e=this[n],t=this[r];t&&(t[n]=e),e&&(e[r]=t),this[n]=null,this[r]=null},t["_insert"+e+"Before"]=function(e){var t=this[n];return t&&(t[r]=e),e[r]=this,e[n]=t,this[n]=e,e},t["_insert"+e+"After"]=function(e){var t=this[r];return this[r]=e,e[r]=t,e[n]=this,t&&(t[n]=e),e},t}function p(e,t,n){return void 0!==n?"("+e+";"+t+";"+n+")":void 0!==t?"("+e+";"+t+")":void 0!==e?"("+e+")":""}function d(e,t,n,r){c("WinJS.Scheduler:"+e+p(n,r)+","+t)}function f(e,t,n,r,o){var i=e.name||void 0!==r||void 0!==o;c("WinJS.Scheduler:"+t+":"+e.id+(i?p(e.name,r,o):"")+","+n)}function m(){return!1}function g(e){throw"Illegal call by job("+e.id+") in state: "+this.name}function h(e){return function(t,n,r){t._setState(e,n,r)}}function v(e,t){e._setPriority(t)}function y(){return 0===he.length?null:he[0].priority}function w(e){d("drain","StartTM",e.name,k(e.priority).name)}function b(e,t){t&&d("drain-canceled","info",e.name,k(e.priority).name),d("drain","StopTM",e.name,k(e.priority).name)}function C(){var e=he.shift();e&&(b(e),he[0]&&w(he[0]),e.complete())}function _(){var e=!1;if(he.length)for(var t=y();+t===t&&t>ye;)ie=t,C(),e=!0,t=y();return e}function S(e){return e>=pe.aboveNormal+1?Ce.HIGH:e>=pe.belowNormal?Ce.NORMAL:Ce.IDLE}function P(e,t){return _e[e]>_e[t]}function I(e){switch(e){case Ce.HIGH:return!1;case Ce.NORMAL:return Ce.isTaskScheduledAtPriorityOrHigher(Ce.HIGH);case Ce.IDLE:return Ce.isTaskScheduledAtPriorityOrHigher(Ce.NORMAL)}}function A(e,t){var n=k(t);n.priority>ye&&(ye=n.priority,ae=!0),n._nextMarker._insertJobBefore(e)}function T(e){return e|=0,e=Math.max(e,le),Math.min(e,ue)}function k(e){return e=T(e),de[-1*(e-ue)]}function F(e){+e!==e&&(e=ye);var t=S(e);if(!oe&&(!fe||ge&&!(function(e,t){return _e[e]>=_e[t]})(fe,t))){var n=++Pe;Ce.execAsyncAtPriority((function(){Ie<n&&(Ie=Pe,(function(e){oe=!0,d("timeslice","StartTM");var t,n,r,o=!0,i=!1,a=!1;ae=!1;try{for(var s=Se()+ve,c=function(){return i=!1,!!ae||!!I(S(ye))||!he.length&&Se()>s&&(i=!0,!0)};ye>=pe.min&&!c()&&!a;){t=!1,n=k(ye)._nextJob;do{if(ie=n.priority,n instanceof M)r!==n.priority&&(+r===r&&d("priority","StopTM",k(r).name),d("priority","StartTM",k(n.priority).name),r=n.priority),t=!0,o=!1,f(me=n,"job-running","StartTM",k(ie).name),n._execute(c),f(me,"job-running","StopTM",k(ie).name),me=null,o=!0;else{var l=S(ye);ye=n.priority,t=_();var u=S(ye);!P(l,u)||ge&&!Ce.isTaskScheduledAtPriorityOrHigher(u)||(a=!0)}n=n._nextJob}while(n&&!t&&!a&&!I(S(ye)));ae=!1}}finally{me=null,o||(f(n,"job-error","info"),f(n,"job-running","StopTM",k(ie).name),n.cancel()),+r===r&&d("priority","StopTM",k(r).name);for(var p=!1;ye>=pe.min&&!p;){t=!1,n=k(ye)._nextJob;do{n instanceof M?p=!0:(ye=n.priority,t=_()),n=n._nextJob}while(n&&!t&&!p)}var m;m=o?i?"timeslice exhausted":ye<pe.min?"jobs exhausted":a?"reached WWA priority boundary":"WWA host work":"job error",e&&(fe=null),oe=!1,ye>=pe.min&&F(),d("yielding","info",m),d("timeslice","StopTM")}})(!0))}),t),fe=t}}function E(e,t,n,r){t=t||pe.normal,n=n||null;var o=++se,i=s._traceAsyncOperationStarting("WinJS.Utilities.Scheduler.schedule: "+o+p(r));return new M(o,e,t,n,r=r||"",i)}function O(e){return function(t,n){var r;return new l((function(o){r=E((function(){o(t)}),e,null,n)}),(function(){r.cancel()}))}}n.Namespace.define("WinJS.Utilities",{_linkedListMixin:u});var L={get jobInfoIsNoLongerValid(){return"The job info object can only be used while the job is running"}},M=n.Class.define((function(e,t,n,r,o,i){this._id=e,this._work=t,this._context=r,this._name=o,this._asyncOpID=i,this._setPriority(n),this._setState(H),f(this,"job-scheduled","info")}),{completed:{get:function(){return!!this._state.completed}},id:{get:function(){return this._id}},name:{get:function(){return this._name},set:function(e){this._name=e}},owner:{get:function(){return this._owner},set:function(e){this._owner&&this._owner._remove(this),this._owner=e,this._owner&&this._owner._add(this)}},priority:{get:function(){return this._priority},set:function(e){e=T(e),this._state.setPriority(this,e)}},cancel:function(){this._state.cancel(this)},pause:function(){this._state.pause(this)},resume:function(){this._state.resume(this)},_execute:function(e){this._state.execute(this,e)},_executeDone:function(e){return this._state.executeDone(this,e)},_blockedDone:function(e){return this._state.blockedDone(this,e)},_setPriority:function(e){+this._priority===this._priority&&this._priority!==e&&f(this,"job-priority-changed","info",k(this._priority).name,k(e).name),this._priority=e},_setState:function(e,t,n){this._state&&i.log&&i.log("Transitioning job ("+this.id+") from: "+this._state.name+" to: "+e.name,"winjs scheduler","log"),this._state=e,this._state.enter(this,t,n)}});n.Class.mix(M,u("Job"));var B=1,x=2,j=3,R=n.Class.define((function(e,t){this._job=t,this._result=null,this._yieldPolicy=B,this._shouldYield=e}),{job:{get:function(){return this._throwIfDisabled(),this._job}},shouldYield:{get:function(){return this._throwIfDisabled(),this._shouldYield()}},setPromise:function(e){this._throwIfDisabled(),this._result=e,this._yieldPolicy=j},setWork:function(e){this._throwIfDisabled(),this._result=e,this._yieldPolicy=x},_disablePublicApi:function(){this._publicApiDisabled=!0},_throwIfDisabled:function(){if(this._publicApiDisabled)throw new o("WinJS.Utilities.Scheduler.JobInfoIsNoLongerValid",L.jobInfoIsNoLongerValid)}}),D=n.Class.define((function(){this._jobs={}}),{cancelAll:function(){var e=this._jobs,t=Object.keys(e);this._jobs={};for(var n=0,r=t.length;n<r;n++)e[t[n]].cancel()},_add:function(e){this._jobs[e.id]=e},_remove:function(e){delete this._jobs[e.id]}}),q=n.Class.define((function(e){this.name=e,this.enter=g,this.execute=g,this.executeDone=g,this.blockedDone=g,this.cancel=g,this.pause=g,this.resume=g,this.setPriority=g})),H=new q("created"),W=new q("scheduled"),U=new q("paused"),N=new q("canceled"),V=new q("running"),z=new q("running_paused"),G=new q("running_resumed"),J=new q("running_canceled"),K=new q("running_canceled_blocked"),X=new q("cooperative_yield"),Q=new q("cooperative_yield_paused"),Z=new q("blocked"),$=new q("blocked_waiting"),Y=new q("blocked_paused"),ee=new q("blocked_paused_waiting"),te=new q("blocked_canceled"),ne=new q("complete");H.enter=function(e){A(e,e.priority),e._setState(W)},W.enter=function(){F()},W.execute=h(V),W.cancel=h(N),W.pause=h(U),W.resume=m,W.setPriority=function(e,t){e.priority!==t&&(e._setPriority(t),e.pause(),e.resume())},U.enter=function(e){f(e,"job-paused","info"),e._removeJob()},U.cancel=h(N),U.pause=m,U.resume=function(e){f(e,"job-resumed","info"),A(e,e.priority),e._setState(W)},U.setPriority=v,N.enter=function(e){f(e,"job-canceled","info"),s._traceAsyncOperationCompleted(e._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_CANCELED),e._removeJob(),e._work=null,e._context=null,e.owner=null},N.cancel=m,N.pause=m,N.resume=m,N.setPriority=m,V.enter=function(e,t){e._removeJob();var n=e.priority,r=e._work,o=e._context;e._work=null,e._context=null;var i=new R(t,e);s._traceAsyncCallbackStarting(e._asyncOpID);try{Ce.execAtPriority((function(){r.call(o,i)}),S(n))}finally{s._traceAsyncCallbackCompleted(),i._disablePublicApi()}e._context=o;var a=e._executeDone(i._yieldPolicy);e._setState(a,i._result,n)},V.executeDone=function(e,t){switch(t){case B:return ne;case x:return X;case j:return Z}},V.cancel=function(e){ae=!0,e._setState(J)},V.pause=function(e){ae=!0,e._setState(z)},V.resume=m,V.setPriority=v,z.enter=m,z.executeDone=function(e,t){switch(t){case B:return ne;case x:return Q;case j:return Y}},z.cancel=h(J),z.pause=m,z.resume=h(G),z.setPriority=v,G.enter=m,G.executeDone=function(e,t){switch(t){case B:return ne;case x:return X;case j:return Z}},G.cancel=h(J),G.pause=h(z),G.resume=m,G.setPriority=v,J.enter=m,J.executeDone=function(e,t){switch(t){case B:case x:return N;case j:return K}},J.cancel=m,J.pause=m,J.resume=m,J.setPriority=m,K.enter=function(e,t){t.cancel(),e._setState(N)},X.enter=function(e,t,n){f(e,"job-yielded","info"),n===e.priority?(function(e,t){var n=k(t);n.priority>ye&&(ye=n.priority,ae=!0),n._insertJobAfter(e)})(e,e.priority):A(e,e.priority),e._work=t,e._setState(W)},Q.enter=function(e,t){f(e,"job-yielded","info"),e._work=t,e._setState(U)},Z.enter=function(e,t,n){f(e,"job-blocked","StartTM"),e._work=t,e._setState($),t.done((function(t){f(e,"job-blocked","StopTM");var r=e._blockedDone(t);e._setState(r,t,n)}),(function(t){return t&&"Canceled"===t.name||f(e,"job-error","info"),f(e,"job-blocked","StopTM"),e._setState(N),l.wrapError(t)}))},$.enter=m,$.blockedDone=function(e,t){return"function"==typeof t?X:ne},$.cancel=h(te),$.pause=h(ee),$.resume=m,$.setPriority=v,Y.enter=function(e,t,n){f(e,"job-blocked","StartTM"),e._work=t,e._setState(ee),t.done((function(t){f(e,"job-blocked","StopTM");var r=e._blockedDone(t);e._setState(r,t,n)}),(function(t){return t&&"Canceled"===t.name||f(e,"job-error","info"),f(e,"job-blocked","StopTM"),e._setState(N),l.wrapError(t)}))},ee.enter=m,ee.blockedDone=function(e,t){return"function"==typeof t?Q:ne},ee.cancel=h(te),ee.pause=m,ee.resume=h($),ee.setPriority=v,te.enter=function(e){e._work.cancel(),e._work=null},te.blockedDone=function(){return N},te.cancel=m,te.pause=m,te.resume=m,te.setPriority=m,ne.completed=!0,ne.enter=function(e){s._traceAsyncOperationCompleted(e._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_SUCCESS),e._work=null,e._context=null,e.owner=null,f(e,"job-completed","info")},ne.cancel=m,ne.pause=m,ne.resume=m,ne.setPriority=m;var re=n.Class.define((function(e,t){this.priority=e,this.name=t}),{});n.Class.mix(re,u("Job"),u("Marker"));var oe,ie,ae,se=0,ce=0,le=-15,ue=15,pe={max:15,high:13,aboveNormal:9,normal:0,belowNormal:-9,idle:-13,min:-15},de=[new re(15,"max"),new re(14,"14"),new re(13,"high"),new re(12,"12"),new re(11,"11"),new re(10,"10"),new re(9,"aboveNormal"),new re(8,"8"),new re(7,"7"),new re(6,"6"),new re(5,"5"),new re(4,"4"),new re(3,"3"),new re(2,"2"),new re(1,"1"),new re(0,"normal"),new re(-1,"-1"),new re(-2,"-2"),new re(-3,"-3"),new re(-4,"-4"),new re(-5,"-5"),new re(-6,"-6"),new re(-7,"-7"),new re(-8,"-8"),new re(-9,"belowNormal"),new re(-10,"-10"),new re(-11,"-11"),new re(-12,"-12"),new re(-13,"idle"),new re(-14,"-14"),new re(-15,"min"),new re(-16,"<TAIL>")],fe=null,me=null,ge=!(!t.MSApp||!t.MSApp.execAtPriority),he=[],ve=30,ye=pe.min;de.reduce((function(e,t){return e&&(e._insertJobAfter(t),e._insertMarkerAfter(t)),t}));var we=r._setImmediate,be={execAsyncAtPriority:function(e,n){n===Ce.HIGH&&t.setTimeout(e,0),we(e)},execAtPriority:function(e){return e()},getCurrentPriority:function(){return be.NORMAL},isTaskScheduledAtPriorityOrHigher:function(){return!1},HIGH:"high",NORMAL:"normal",IDLE:"idle"},Ce=ge?t.MSApp:be,_e={};_e[Ce.IDLE]=1,_e[Ce.NORMAL]=2,_e[Ce.HIGH]=3;var Se=t.performance&&t.performance.now&&t.performance.now.bind(t.performance)||Date.now.bind(Date),Pe=0,Ie=0;n.Namespace._moduleDefine(e,"WinJS.Utilities.Scheduler",{Priority:pe,schedule:E,createOwnerToken:function(){return new D},execHigh:function(e){return Ce.execAtPriority(e,Ce.HIGH)},requestDrain:function(e,t){var n=ce++;void 0===t&&(t="Drain Request "+n),e=T(e=+e===e?e:pe.min);var r,o=new l((function(n){!(function(e,t,n){he.push({priority:e,complete:t,name:n}),1===he.length&&(w(he[0]),e>ye&&(ye=e,ae=!0))})(e,r=n,t)}),(function(){!(function(e,t){var n,r=he.length;for(n=0;n<r;n++)if(he[n].complete===e){0===n&&(b(he[0],t),he[1]&&w(he[1])),he.splice(n,1);break}})(r,!0)}));return oe||F(),o},currentPriority:{get:function(){if(oe)return ie;switch(Ce.getCurrentPriority()){case Ce.HIGH:return pe.high;case Ce.NORMAL:return pe.normal;case Ce.IDLE:return pe.idle}}},schedulePromiseHigh:O(pe.high),schedulePromiseAboveNormal:O(pe.aboveNormal),schedulePromiseNormal:O(pe.normal),schedulePromiseBelowNormal:O(pe.belowNormal),schedulePromiseIdle:O(pe.idle),retrieveState:function(){function e(e,n){t+="    "+(n?"*":" ")+"id: "+e.id+", priority: "+k(e.priority).name+(e.name?", name: "+e.name:"")+"\n"}var t="";t+="Jobs:\n";var n=k(ye),r=0;for(me&&(e(me,!0),r++);n.priority>=pe.min;)n instanceof M&&(e(n,!1),r++),n=n._nextJob;0===r&&(t+="     None\n"),t+="Drain requests:\n";for(var o=0,i=he.length;o<i;o++)t+="    "+(0===o?"*":" ")+"priority: "+k(he[o].priority).name+", name: "+he[o].name+"\n";return 0===he.length&&(t+="     None\n"),t},_JobNode:M,_JobInfo:R,_OwnerToken:D,_dumpList:function(e,t){function n(e,t){i.log&&i.log(t+": MARKER: "+e.name,"winjs scheduler","log")}function r(e,t){i.log&&i.log(t+": JOB("+e.id+"): state: "+(e._state?e._state.name:"")+(e.name?", name: "+e.name:""),"winjs scheduler","log")}i.log&&i.log("highWaterMark: "+ye,"winjs scheduler","log");var o=0,a=t?de[de.length-1]:de[0];do{a instanceof re&&n(a,o),a instanceof M&&r(a,o),o++,a=t?a["_prev"+e]:a["_next"+e]}while(a)},_isEmpty:{get:function(){var e=de[0];do{if(e instanceof M)return!1;e=e._nextJob}while(e);return!0}},_usingWwaScheduler:{get:function(){return ge},set:function(e){Ce=(ge=e)?t.MSApp:be}},_MSApp:{get:function(){return Ce},set:function(e){Ce=e}},_TIME_SLICE:ve})})),r("WinJS/Core/_BaseUtils",["exports","./_Global","./_Base","./_BaseCoreUtils","./_ErrorFromName","./_Resources","./_Trace","../Promise","../Scheduler"],(function(e,t,n,r,o,i,a,s,c){"use strict";function l(e){return e}function u(e,t,n){return e.split(".").reduce((function(e,t){return e?n(e[t]):null}),t)}function p(e){return e.length>0&&0!==e.indexOf("-moz")&&"-"===e.charAt(0)&&(e=e.slice(1)),e.replace(/\-[a-z]/g,(function(e){return e[1].toUpperCase()}))}function d(e,t){return""===e?t:e+t.charAt(0).toUpperCase()+t.slice(1)}function f(e,t){return(""!==e?"-"+e.toLowerCase()+"-":"")+t}var m,g={get notSupportedForProcessing(){return"Value is not supported within a declarative processing context, if you want it to be supported mark it using WinJS.Utilities.markSupportedForProcessing. The value was: '{0}'"}},h=0,v={},y=!1,w=t.navigator.platform,b="iPhone"===w||"iPad"===w||"iPod"===w;n.Namespace._moduleDefine(e,"WinJS.Utilities",{_setHasWinRT:{value:function(e){r.hasWinRT=e},configurable:!1,writable:!1,enumerable:!1},hasWinRT:{get:function(){return r.hasWinRT},configurable:!1,enumerable:!0},_setIsiOS:{value:function(e){b=e},configurable:!1,writable:!1,enumerable:!1},_isiOS:{get:function(){return b},configurable:!1,enumerable:!0},_getMemberFiltered:u,getMember:function(e,n){return e?u(e,n||t,l):null},_browserStyleEquivalents:(function(){if(!t.document)return{};for(var e={},n=t.document.documentElement.style,r=["","webkit","ms","Moz"],o=["animation","transition","transform","animation-name","animation-duration","animation-delay","animation-timing-function","animation-iteration-count","animation-direction","animation-fill-mode","grid-column","grid-columns","grid-column-span","grid-row","grid-rows","grid-row-span","transform-origin","transition-property","transition-duration","transition-delay","transition-timing-function","scroll-snap-points-x","scroll-snap-points-y","scroll-chaining","scroll-limit","scroll-limit-x-max","scroll-limit-x-min","scroll-limit-y-max","scroll-limit-y-min","scroll-snap-type","scroll-snap-x","scroll-snap-y","touch-action","overflow-style","user-select"],i={},a=0,s=o.length;a<s;a++)for(var c=o[a],l=p(c),u=0,m=r.length;u<m;u++){var g=r[u],h=d(g,l);if(h in n){var v=f(g,c);e[c]={cssName:v,scriptName:h},i[c]=g;break}}return e.animationPrefix=f(i.animation,""),e.keyframes=f(i.animation,"keyframes"),e})(),_browserEventEquivalents:(function(){for(var e={},n=["","WebKit"],r=[{eventObject:"TransitionEvent",events:["transitionStart","transitionEnd"]},{eventObject:"AnimationEvent",events:["animationStart","animationEnd"]}],o=0,i=r.length;o<i;o++){for(var a=r[o],s="",c=0,l=n.length;c<l;c++){var u=n[c];if(u+a.eventObject in t){s=u.toLowerCase();break}}c=0;for(var p=a.events.length;c<p;c++){var f=a.events[c];e[f]=d(s,f),""===s&&(e[f]=e[f].toLowerCase())}}return e.manipulationStateChanged="MSManipulationEvent"in t?"ManipulationEvent":null,e})(),_getCamelCasedName:p,ready:function e(n,r){return new s((function(o,i){function a(){if(n)try{n(),o()}catch(e){i(e)}else o()}var s=e._testReadyState;s||(s=t.document?t.document.readyState:"complete"),"complete"===s||t.document&&null!==t.document.body?r?c.schedule((function(){a()}),c.Priority.normal,null,"WinJS.Utilities.ready"):a():t.addEventListener("DOMContentLoaded",a,!1)}))},strictProcessing:{get:function(){return!0},configurable:!1,enumerable:!0},markSupportedForProcessing:{value:r.markSupportedForProcessing,configurable:!1,writable:!1,enumerable:!0},requireSupportedForProcessing:{value:function(e){var n=!0;switch(n=(n=(n=(n=n&&e!==t)&&e!==t.location)&&!(e instanceof t.HTMLIFrameElement))&&!("function"==typeof e&&!e.supportedForProcessing),t.frames.length){case 0:break;case 1:n=n&&e!==t.frames[0];break;default:for(var r=0,a=t.frames.length;n&&r<a;r++)n=n&&e!==t.frames[r]}if(n)return e;throw new o("WinJS.Utilities.requireSupportedForProcessing",i._formatString(g.notSupportedForProcessing,e))},configurable:!1,writable:!1,enumerable:!0},_setImmediate:r._setImmediate,_requestAnimationFrame:t.requestAnimationFrame?t.requestAnimationFrame.bind(t):function(e){var n=++h;return v[n]=e,m=m||t.setTimeout((function(){var e=v,t=Date.now();v={},m=null,Object.keys(e).forEach((function(n){e[n](t)}))}),16),n},_cancelAnimationFrame:t.cancelAnimationFrame?t.cancelAnimationFrame.bind(t):function(e){delete v[e]},_yieldForEvents:t.setImmediate?t.setImmediate.bind(t):function(e){t.setTimeout(e,0)},_yieldForDomModification:t.setImmediate?t.setImmediate.bind(t):function(e){t.setTimeout(e,0)},_throttledFunction:function(e,t){function n(){return s.timeout(e).then((function(){r=null}))}var r=null,o=null,i=null,a=null;return function(){o?(i=this,a=[].slice.call(arguments,0)):r?(i=this,a=[].slice.call(arguments,0),o=r.then((function(){var e=i;i=null;var s=a;a=null,r=n(),o=null,t.apply(e,s)}))):(r=n(),t.apply(this,arguments))}},_shallowCopy:function(e){return this._mergeAll([e])},_merge:function(e,t){return this._mergeAll([e,t])},_mergeAll:function(e){var t={};return e.forEach((function(e){Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t},_getProfilerMarkIdentifier:function(e){var t="";return e.id&&(t+=" id='"+e.id+"'"),e.className&&(t+=" class='"+e.className+"'"),t},_now:function(){return t.performance&&t.performance.now&&t.performance.now()||Date.now()},_traceAsyncOperationStarting:a._traceAsyncOperationStarting,_traceAsyncOperationCompleted:a._traceAsyncOperationCompleted,_traceAsyncCallbackStarting:a._traceAsyncCallbackStarting,_traceAsyncCallbackCompleted:a._traceAsyncCallbackCompleted,_version:"4.4.0"}),n.Namespace._moduleDefine(e,"WinJS",{validation:{get:function(){return y},set:function(e){y=e}}}),n.Namespace.define("WinJS",{strictProcessing:{value:function(){},configurable:!1,writable:!1,enumerable:!1}})})),r("WinJS/Core",["./Core/_Base","./Core/_BaseCoreUtils","./Core/_BaseUtils","./Core/_ErrorFromName","./Core/_Events","./Core/_Global","./Core/_Log","./Core/_Resources","./Core/_Trace","./Core/_WinRT","./Core/_WriteProfilerMark"],(function(){})),r("WinJS/Utilities/_SafeHtml",["exports","../Core/_WinJS","../Core/_Global","../Core/_Base","../Core/_ErrorFromName","../Core/_Resources"],(function(e,t,n,r,o,i){"use strict";var a,s,c,l,u,p,d={get nonStaticHTML(){return"Unable to add dynamic content. A script attempted to inject dynamic content, or elements previously modified dynamically, that might be unsafe. For example, using the innerHTML property or the document.write method to add a script element will generate this exception. If the content is safe and from a trusted source, use a method to explicitly manipulate elements and attributes, such as createElement, or use setInnerHTMLUnsafe (or other unsafe method)."}};a=s=function(e,t){e.innerHTML=t},c=l=function(e,t){e.outerHTML=t},u=p=function(e,t,n){e.insertAdjacentHTML(t,n)};var f=n.MSApp;if(f&&f.execUnsafeLocalFunction)s=function(e,n){f.execUnsafeLocalFunction((function(){try{t._execUnsafe=!0,e.innerHTML=n}finally{t._execUnsafe=!1}}))},l=function(e,n){f.execUnsafeLocalFunction((function(){try{t._execUnsafe=!0,e.outerHTML=n}finally{t._execUnsafe=!1}}))},p=function(e,n,r){f.execUnsafeLocalFunction((function(){try{t._execUnsafe=!0,e.insertAdjacentHTML(n,r)}finally{t._execUnsafe=!1}}))};else if(n.msIsStaticHTML){var m=function(e){if(!n.msIsStaticHTML(e))throw new o("WinJS.Utitilies.NonStaticHTML",d.nonStaticHTML)};a=function(e,t){m(t),e.innerHTML=t},c=function(e,t){m(t),e.outerHTML=t},u=function(e,t,n){m(n),e.insertAdjacentHTML(t,n)}}r.Namespace._moduleDefine(e,"WinJS.Utilities",{setInnerHTML:a,setInnerHTMLUnsafe:s,setOuterHTML:c,setOuterHTMLUnsafe:l,insertAdjacentHTML:u,insertAdjacentHTMLUnsafe:p})})),r("WinJS/Utilities/_Xhr",["../Core/_Global","../Core/_Base","../Promise","../Scheduler"],(function(e,t,n,r){"use strict";function o(e,t,n){r.schedule((function(){e(t)}),n,null,"WinJS.xhr")}function i(){}function a(t){var a;return new n((function(n,c,l){var u=r.currentPriority;a=new e.XMLHttpRequest;var p=!1,d=s.exec(t.url.toLowerCase());d?"file"===d[1]&&(p=!0):"file:"===e.location.protocol&&(p=!0),a.onreadystatechange=function(){a._canceled?a.onreadystatechange=i:4===a.readyState?(a.status>=200&&a.status<300||p&&0===a.status?o(n,a,u):o(c,a,u),a.onreadystatechange=i):o(l,a,u)},a.open(t.type||"GET",t.url,!0,t.user,t.password),a.responseType=t.responseType||"",Object.keys(t.headers||{}).forEach((function(e){a.setRequestHeader(e,t.headers[e])})),t.customRequestInitializer&&t.customRequestInitializer(a),void 0===t.data?a.send():a.send(t.data)}),(function(){a.onreadystatechange=i,a._canceled=!0,a.abort()}))}var s=/^(\w+)\:\/\//;return t.Namespace.define("WinJS",{xhr:a}),a})),r("WinJS/Utilities.host",["./Utilities/_SafeHtml","./Utilities/_Xhr"],(function(){})),r("base.host",["WinJS/Core/_WinJS","WinJS/Core","WinJS/Promise","WinJS/Utilities.host"],(function(e){"use strict";return e.Namespace.define("WinJS.Utilities",{_require:n,_define:r}),e})),n(["WinJS/Core/_WinJS","base.host"],(function(e){t.WinJS=e,"undefined"!=typeof module&&(module.exports=e)})),t.WinJS},"function"==typeof define&&define.amd?define([],e):(t.msWriteProfilerMark&&msWriteProfilerMark("WinJS.4.4 4.4.0.winjs.2018.3.19 base.host.js,StartTM"),"object"==typeof exports&&"string"!=typeof exports.nodeName?e():e(t.WinJS),t.msWriteProfilerMark&&msWriteProfilerMark("WinJS.4.4 4.4.0.winjs.2018.3.19 base.host.js,StopTM"))})(),
/*! For license information please see Player.Embed.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/player-embed"]=(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)})([(function(e,t,n){e.exports=n(4)}),(function(e,t,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e){if(null===e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})}),(function(e,t,n){"use strict";(function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||void 0;t.globalScopeObject=t}).call(this,n(3))}),(function(e,t){var n;n=(function(){return this})();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}),(function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"Endpoint",(function(){return i})),n.d(r,"PlayAppUrl",(function(){return a})),n.d(r,"CreateAppUrl",(function(){return s})),n.d(r,"RuntimeToSdkApi",(function(){return c})),n.d(r,"isRuntimeToSdkRequest",(function(){return u})),n.d(r,"sendXhr",(function(){return p})),n.d(r,"EmbeddingError",(function(){return g})),n.d(r,"DataKind",(function(){return d})),n.d(r,"DataType",(function(){return f}));var o={};n.r(o),n.d(o,"PowerAppsEmbeddingCallbackApi",(function(){return m})),n.d(o,"isDelegateLaunchUrlEventCallBackParams",(function(){return v})),n.d(o,"isAppToHostFunctionsEventCallBackParams",(function(){return y})),n.d(o,"isAppToHostTelemetryEventCallBackParams",(function(){return w})),n(1),n(2);var i,a,s,c,l=(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})();function u(e){return"object"==typeof e&&"number"==typeof e.api&&("string"==typeof e.id||void 0===e.id)}function p(e,t,n,r){var o=new XMLHttpRequest;return new Promise((function(i,a){o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?i(o):a({status:o.status,statusText:o.statusText}))},o.open(e,t,!0),n&&Object.keys(n).forEach((function(e){return o.setRequestHeader(e,n[e])})),"POST"===e&&r?(o.setRequestHeader("Content-Type","application/json"),o.send(r)):o.send()}))}!(function(e){e.DEV="DEV",e.TEST="TEST",e.PROD="PROD",e.GCCMODERATE="GCCMODERATE",e.GCCHIGH="GCCHIGH",e.MOONCAKE="MOONCAKE",e.DOD="DOD",e.INT="INT",e.USNAT="USNAT",e.USSEC="USSEC"})(i||(i={})),(function(e){e.DEV="https://apps.local.powerapps.com:44329/",e.TEST="https://apps.test.powerapps.com/",e.PROD="https://apps.powerapps.com/",e.GCCMODERATE="https://apps.gov.powerapps.us/",e.GCCHIGH="https://apps.high.powerapps.us/",e.MOONCAKE="https://apps.powerapps.cn/",e.DOD="https://play.apps.appsplatform.us/",e.INT="https://apps.int.powerapps.com/",e.USNAT="https://apps.powerapps.eaglex.ic.gov/",e.USSEC="https://apps.powerapps.microsoft.scloud/"})(a||(a={})),(function(e){e.DEV="https://local.create.powerapps.com:44300",e.TEST="https://test.create.powerapps.com",e.PROD="https://create.powerapps.com",e.GCCMODERATE="https://gov.create.powerapps.us",e.GCCHIGH="https://high.create.powerapps.us",e.MOONCAKE="https://create.powerapps.cn",e.DOD="https://create.apps.appsplatform.us",e.INT="https://int.create.powerapps.com",e.USNAT="https://create.powerapps.eaglex.ic.gov",e.USSEC="https://create.powerapps.microsoft.scloud"})(s||(s={})),(function(e){e[e.GetAccessToken=0]="GetAccessToken"})(c||(c={}));var d,f,m,g=(function(e){function t(t){return e.call(this,t)||this}return l(t,e),t})(Error);function h(e,t){var n=globalScopeObject;e.forEach((function(e){var t=e;n[t]||(n[t]={}),n=n[t]})),Object.assign(n,t)}function v(e){return"string"==typeof e.url}function y(e){return"string"==typeof e.requestParameters.url&&"string"==typeof e.requestParameters.method&&(!e.requestParameters.headers||"object"==typeof e.requestParameters.headers)&&(!e.requestParameters.retryable||"object"==typeof e.requestParameters.retryable)&&(!e.requestParameters.bodyData||"string"==typeof e.requestParameters.bodyData)&&u(e)}function w(e){return"string"==typeof e.message&&""!==e.message&&null!==e.message&&(null===e.data||"object"==typeof e.data)&&u(e)}!(function(e){e.Table="Table",e.Record="Record"})(d||(d={})),(function(e){e.String="s",e.Number="n",e.Boolean="b",e.Date="d",e.DateTime="D"})(f||(f={})),h(["Core","Embedding","es6"],r),(function(e){e[e.GetAccessToken=0]="GetAccessToken",e[e.AppLoaded=1]="AppLoaded",e[e.AppClosed=2]="AppClosed",e[e.AppFailed=3]="AppFailed",e[e.RequestHide=4]="RequestHide",e[e.EnableSave=5]="EnableSave",e[e.NewItem=6]="NewItem",e[e.EditItem=7]="EditItem",e[e.ViewItem=8]="ViewItem",e[e.SaveItem=9]="SaveItem",e[e.CancelEditItem=10]="CancelEditItem",e[e.SetProperty=20]="SetProperty",e[e.VisibilityChanged=21]="VisibilityChanged",e[e.ReadyToHandleMessages=22]="ReadyToHandleMessages",e[e.InteractionRequired=23]="InteractionRequired",e[e.SendTrigger=30]="SendTrigger",e[e.SendTriggerResponse=31]="SendTriggerResponse",e[e.SendTelemetryEvent=40]="SendTelemetryEvent",e[e.Log=41]="Log",e[e.DelegateLaunchUrl=42]="DelegateLaunchUrl",e[e.OpenConsentPage=43]="OpenConsentPage",e[e.CloseConsentPage=44]="CloseConsentPage",e[e.SetConsentResult=45]="SetConsentResult",e[e.OpenConnectorAuthPopup=46]="OpenConnectorAuthPopup",e[e.SetConnectorAuthResult=47]="SetConnectorAuthResult",e[e.GetPreloadConsentServiceData=48]="GetPreloadConsentServiceData"})(m||(m={})),h(["WebPlayer","Sdk"],o)})]),
/*! For license information please see Player.AppLoader.Dependencies.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/player-apploader-dependencies"]=(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)})([(function(e,t,n){(function(n){var r,o,i,a,s,c,l,u,p,d,f,m,g,h,v,y,w,b,C,_,S,P,I,A,T;!(function(k){var F="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:{};function E(e,t){return e!==F&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}void 0===(r=function(e){!(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};o=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},s=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},c=function(e,t){return function(n,r){t(n,r,e)}},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):(function(e){return e instanceof n?e:new n((function(t){t(e)}))})(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return (function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}})([i,s])}}},d=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||T(t,e,n)},T=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},m=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},g=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e},h=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},v=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},y=function(e){return this instanceof y?(this.v=e,this):new y(e)},w=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{!(function(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,l):u(i[0][2],e)})(o[e](t))}catch(e){u(i[0][3],e)}}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}},b=function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:o?o(t):t}:o}},C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},_=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&T(t,e,r);return n(t,e),t},P=function(e){return e&&e.__esModule?e:{default:e}},I=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},A=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},e("__extends",o),e("__assign",i),e("__rest",a),e("__decorate",s),e("__param",c),e("__metadata",l),e("__awaiter",u),e("__generator",p),e("__exportStar",d),e("__createBinding",T),e("__values",f),e("__read",m),e("__spread",g),e("__spreadArrays",h),e("__spreadArray",v),e("__await",y),e("__asyncGenerator",w),e("__asyncDelegator",b),e("__asyncValues",C),e("__makeTemplateObject",_),e("__importStar",S),e("__importDefault",P),e("__classPrivateFieldGet",I),e("__classPrivateFieldSet",A)})(E(F,E(e)))}.apply(t,[t]))||(e.exports=r)})()}).call(this,n(1))}),(function(e,t){var n;n=(function(){return this})();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}),(function(e,t,n){"use strict";var r=n(6);function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new o("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=o}),(function(e,t,n){e.exports=n(8)}),(function(e,t,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e){if(null===e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})}),(function(e,t,n){"use strict";(function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||void 0;t.globalScopeObject=t}).call(this,n(1))}),(function(e,t,n){var r=n(7);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return (function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))})(t)}catch(e){return r(t)}}}),(function(e,t){function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,i=0,a=0,s="";o=t.charAt(a++);~o&&(r=i%4?64*r+o:o,i++%4)?s+=String.fromCharCode(255&r>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s}}),(function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"exportToNamespace",(function(){return l})),n(4),n(5);var o=(function(){function e(e,t){return new WinJS.Promise(e,t)}return Object.defineProperty(e,"all",{get:function(){return globalScopeObject.NativePromise.all},enumerable:!1,configurable:!0}),Object.defineProperty(e,"allSettled",{get:function(){return globalScopeObject.NativePromise.allSettled||i},enumerable:!1,configurable:!0}),Object.defineProperty(e,"race",{get:function(){return WinJS.Promise.any},enumerable:!1,configurable:!0}),Object.defineProperty(e,"resolve",{get:function(){return WinJS.Promise.wrap},enumerable:!1,configurable:!0}),Object.defineProperty(e,"reject",{get:function(){return WinJS.Promise.wrapError},enumerable:!1,configurable:!0}),Object.defineProperty(e,"is",{get:function(){return WinJS.Promise.is},enumerable:!1,configurable:!0}),Object.defineProperty(e,"timeout",{get:function(){return WinJS.Promise.timeout},enumerable:!1,configurable:!0}),e})();function i(e){return (function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):(function(e){return e instanceof n?e:new n((function(t){t(e)}))})(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))})(this,void 0,void 0,(function(){return (function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return (function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}})([i,s])}}})(this,(function(t){return[2,Promise.all(e.map((function(e){return Promise.resolve(e).then((function(e){return{status:"fulfilled",value:e}}),(function(e){return{status:"rejected",reason:e}}))})))]}))}))}Object.getPrototypeOf(WinJS.Promise.prototype).catch=function(e){return this.then(null,e)},Object.getPrototypeOf(WinJS.Promise.wrap()).catch=function(){return this};var a=function(e){return this.then((function(t){return o.resolve(e()).then((function(){return t}))}),(function(t){return o.resolve(e()).then((function(){return o.reject(t)}))}))};Object.getPrototypeOf(WinJS.Promise.prototype).finally=a,Object.getPrototypeOf(WinJS.Promise.wrap()).finally=a;var s=WinJS.ErrorPromise.prototype;if(s.catch=function(e){return s.then.call(this,null,e)},void 0===globalScopeObject.NativePromise){var c=globalScopeObject.Promise;Object.defineProperty(globalScopeObject,"NativePromise",{get:function(){return c}})}function l(e,t){var n=globalScopeObject;e.forEach((function(e){var t=e;n[t]||(n[t]={}),n=n[t]})),Object.assign(n,t)}Object.defineProperty(globalScopeObject,"Promise",{get:function(){return o}});var u,p,d,f=n(0),m=n(2),g=n.n(m);!(function(e){e.Success="Success",e.Failed="Failed",e.SuccessWithErrors="SuccessWithErrors",e.TerminatedOnAppClose="TerminatedOnAppClose",e.Canceled="Canceled"})(u||(u={})),(function(e){e.None="None",e.Http="Http"})(p||(p={})),(function(e){e[e.error=0]="error",e[e.warning=1]="warning",e[e.success=2]="success",e[e.info=3]="info"})(d||(d={}));var h=(function(){function e(e,t,n){var r=this;void 0===t&&(t="sessionStorage"),void 0===n&&(n=!0),this.tokenType=e,this.isRetrieving=function(e){var t,n=!1;try{var o=null===(t=r.storage)||void 0===t?void 0:t.getItem(r._getPropertyName(r.isRetrievingTokenPropertyBaseName,e));o&&"true"===o&&(n=!0)}catch(e){}return n},this.setIsRetrieving=function(e,t){var n;void 0===t&&(t=!0);try{null===(n=r.storage)||void 0===n||n.setItem(r._getPropertyName(r.isRetrievingTokenPropertyBaseName,e),t?"true":"false")}catch(e){}},this.getToken=function(e){var t;try{var n=null===(t=r.storage)||void 0===t?void 0:t.getItem(r._getPropertyName(r.tokenPropertyBaseName,e));if(n){var o=JSON.parse(n);return o.expiresOn=o.expiresOn&&new Date(o.expiresOn),o}return null}catch(e){return null}},this.setToken=function(e,t){var n;try{null===(n=r.storage)||void 0===n||n.setItem(r._getPropertyName(r.tokenPropertyBaseName,e),JSON.stringify(t))}catch(e){}},this.removeToken=function(e){if(r.storage)try{var t=r._getPropertyName(r.tokenPropertyBaseName,e);r.storage[t]&&r.storage.removeItem(t)}catch(e){}},this.clear=function(e){if(void 0===e&&(e=!0),r.storage)try{for(var t=r.storage.length-1;t>=0;t--){var n=r.storage.key(t);n&&(0===n.indexOf(r.isRetrievingTokenPropertyBaseName)||e&&0===n.indexOf(r.tokenPropertyBaseName))&&r.storage.removeItem(n)}}catch(e){}},this.tokenPropertyBaseName=this.tokenType+"AccessToken",this.isRetrievingTokenPropertyBaseName="isRetrieving"+this.tokenPropertyBaseName,this.storage=this._getStorage(t),window.addEventListener("unload",(function(){r.clear(n)}))}return e.prototype._getStorage=function(e){try{var t=window[e];if(this._isStorageEnabled(t))return t;if("sessionStorage"!==e&&(t=window.sessionStorage,this._isStorageEnabled(t)))return t}catch(e){}},e.prototype._isStorageEnabled=function(e){if(!e)return!1;var t=!1;try{e.setItem("__storageTest","__storageTest"),t="__storageTest"===e.getItem("__storageTest"),e.removeItem("__storageTest")}catch(e){}return t},e.prototype._getPropertyName=function(e,t){return e+":"+t},e})(),v=(function(){function e(){}return e.parseAccessTokenFromHash=function(e){if(!e)return null;var t,n=e.indexOf("#"),r=null;t=0===n?e.substr(n+1):e;try{return r=JSON.parse(decodeURIComponent(t)),this.validateHashedAccessTokenObject(r)}catch(e){return null}},e.cleanUpAccessTokenAndParentIdFromHash=function(e){return this.cleanUpAccessTokenAndParentIdFromHashedData(this.parseAccessTokenFromHash(e))},e.cleanUpAccessTokenAndParentIdFromHashedData=function(e){return e?(delete e.access_token,delete e.pid,encodeURIComponent(JSON.stringify(e))):""},e.validateHashedAccessTokenObject=function(e){return e&&"object"==typeof e&&e.access_token&&"string"==typeof e.access_token&&"string"==typeof e.pid?e:null},e})(),y=(function(){function e(){}return e.prototype.sendRequestToParent=function(e,t){var n={api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetAccessToken,id:Date.now().toString(),clientRequestId:e.clientRequestId,audience:e.audience},r=function(e){var o,i;if(0===(null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.api)&&(null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.id)===n.id){window.removeEventListener("message",r);var a=e.data;t(a)}};window.addEventListener("message",r),window.parent.postMessage(n,"*")},e})(),w=(function(){function e(e,t){var n,r;void 0===e&&(e=new y),void 0===t&&(t=null===(r=null===(n=window.WebPlayerAppLoader)||void 0===n?void 0:n.getAppLoaderTelemetryInstance)||void 0===r?void 0:r.call(n)),this._communicationChannel=e,this._telemetryHandler=t,this._scenarioName="ParentAccessTokenRetriever",this._timeoutInMilliseconds=4e3,this._loggingIntervalMs=5e3,this._isAuthTimeoutEnabled=!0,this._cacheProvider=new h("Parent","localStorage",!1)}return e.prototype.acquireToken=function(e,t,n,r){void 0===t&&(t=function(){}),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this._startScenario(this._appendCustomData({resourceUrl:e,bypassCache:n}));if(!n){var i=this._cacheProvider.getToken(e);if(i){if(this._validateAuthTokenExpiry(i))return this._endScenario(this._scenarioName,o,!0,"Retrieved Auth Result from Cache"),t(i),void(r&&this._validateCacheInBackground(e,i));this._cacheProvider.removeToken(e)}if(this._cacheProvider.isRetrieving(e))return void this._getAuthResultFromCache(e,t,o)}this._getAccessTokenFromParent(e,t,o)},e.prototype.clearCache=function(){this._log(this._scenarioName,"clearCache"),this._cacheProvider.clear()},e.prototype._getAccessTokenFromParent=function(e,t,n){var r,o,i=this;this._cacheProvider.setIsRetrieving(e,!0);var a,s,c=!1,l=Date.now(),u=e===(null===(o=null===(r=null===window||void 0===window?void 0:window.webPlayerServerConfig)||void 0===r?void 0:r.AuthConfig)||void 0===o?void 0:o.OnBehalfOfResource),p={audience:e,clientRequestId:this._generate128BitUUID()},d=function(r){var o,d,f,m;clearTimeout(a),clearInterval(s);var g=Date.now(),h=g-l>0?g-l:-1;if(u&&i._cleanUpAccessTokenFromHash(),c)i._log(i._scenarioName,i._scenarioName+".accessTokenCallbackHandler",i._appendCustomData({success:r.success,message:"accessTokenCallbackHandler returned after timeout",parentRequestId:null!==(o=r.parentRequestId)&&void 0!==o?o:"",clientRequestId:null!==(d=p.clientRequestId)&&void 0!==d?d:"",errorMessage:null!==(f=r.errorMessage)&&void 0!==f?f:"",requestDuration:h}));else{var v;if(r.success){var y=i._tryGetExpirationFromToken(r.accessToken);y&&y<Date.now()?(v={error:"Based on time on client, token is expired."},i._endScenario(i._scenarioName,n,!1,"Ignoring Potentially Expired Auth Result from Parent",h,r.parentRequestId)):r.accessToken&&0!=(null===(m=r.accessToken)||void 0===m?void 0:m.length)?null===i._tryGetDecodedToken(r.accessToken)?(v={error:"Successful accessTokenResponse from parent did contain invalid JWT accessToken"},i._endScenario(i._scenarioName,n,!1,"Successful accessTokenResponse from parent did contain invalid JWT accessToken",h,r.parentRequestId)):(v={accessToken:r.accessToken,idToken:r.accessToken,expiresOn:y||new Date(Date.now()+3e4)},i._endScenario(i._scenarioName,n,!0,"Retrieved Auth Result from Parent",h,r.parentRequestId)):(v={error:"Successful accessTokenResponse from parent did not contain accessToken"},i._endScenario(i._scenarioName,n,!1,"Successful accessTokenResponse from parent did not contain accessToken",h,r.parentRequestId))}else v={error:r.errorMessage},i._endScenario(i._scenarioName,n,!1,"Authentication from Parent Failed - "+r.errorMessage,h,r.parentRequestId);!(function(n){i._cacheProvider.setIsRetrieving(e,!1),i._cacheProvider.setToken(e,n),t(n)})(v)}};this._isAuthTimeoutEnabled?a=setTimeout((function(){var e,t=null,n=!1;u&&(t=v.parseAccessTokenFromHash(i._getHash())),t?(e={success:!0,accessToken:t.access_token,parentRequestId:t.pid},n=!0):e={success:!1,errorMessage:"Authentication Timed Out After "+i._timeoutInMilliseconds/1e3+" Seconds"},i._log(i._scenarioName,i._scenarioName+".timeoutHandler",i._appendCustomData({message:"Access token retrieval timed out",usingHashedData:n,oboResource:u,isTimeoutEnabled:i._isAuthTimeoutEnabled})),d(e),c=!0}),this._timeoutInMilliseconds):s=setInterval((function(){var e=Date.now()-l;i._log("ParentAccessTokenRetriever","WaitingForTokenResponse",{duration:e,tokenRequestStartTime:l})}),this._loggingIntervalMs);try{this._communicationChannel.sendRequestToParent(p,d)}catch(e){d({success:!1,errorMessage:"Parent threw exception with message: "+(null==e?void 0:e.message)})}},e.prototype._getHash=function(){return window.location.hash},e.prototype._cleanUpAccessTokenFromHash=function(){window.location.hash=v.cleanUpAccessTokenAndParentIdFromHash(window.location.hash)},e.prototype._getAuthResultFromCache=function(e,t,n){var r=this,o=Date.now(),i=window.setInterval((function(){var a=r._cacheProvider.getToken(e);if(a)return clearInterval(i),r._validateAuthTokenExpiry(a)?r._endScenario(r._scenarioName,n,!0,"_getAuthResultFromCache Succeeded"):r._endScenario(r._scenarioName,n,!1,"_getAuthResultFromCache got invalid data"),void t(a);if(Date.now()-o>r._timeoutInMilliseconds){clearInterval(i),r.clearCache();r._endScenario(r._scenarioName,n,!1,"Token Retrieval timed out"),t({error:"Token Retrieval timed out"})}}),100)},e.prototype._validateCacheInBackground=function(e,t){var n=this,r=this._startScenario(this._appendCustomData({resourceUrl:e,bypassCache:!1,refreshInBackground:!0}));this._getAccessTokenFromParent(e,(function(e){n._validateCachedAuthResult(t,e)||n.clearCache()}),r)},e.prototype._validateCachedAuthResult=function(e,t){try{var n=this._tryGetDecodedToken(e.accessToken),r=this._tryGetDecodedToken(t.accessToken);if((null==n?void 0:n.oid)&&(null==r?void 0:r.oid)&&(null==n?void 0:n.oid)!=(null==r?void 0:r.oid))return this._log(this._scenarioName,"_validateCachedAuthResult",{oidChanged:!0,oidFromCache:n.oid,oidFromParent:r.oid}),!1;if((null==n?void 0:n.tid)&&(null==r?void 0:r.tid)&&(null==n?void 0:n.tid)!=(null==r?void 0:r.tid))return this._log(this._scenarioName,"_validateCachedAuthResult",{tidChanged:!0,tidFromCache:n.tid,tidFromParent:r.tid}),!1}catch(e){this._log(this._scenarioName,"_validateCachedAuthResult",{message:"failed to validate cache",error:e})}return!0},e.prototype._appendCustomData=function(e){return e},e.prototype._startScenario=function(e){var t;return(null===(t=this._telemetryHandler)||void 0===t?void 0:t.startScenario("ParentAccessTokenRetrieverAcquireToken",e))||""},e.prototype._endScenario=function(e,t,n,r,o,i){var a;void 0===o&&(o=0),void 0===i&&(i="");var s=n?u.Success:u.Failed;null===(a=this._telemetryHandler)||void 0===a||a.endScenario(t,s,this._appendCustomData({scenarioName:e,succeeded:n,parentRequestId:i,message:r,duration:o,customScenarioData:{parentRequestId:i}}))},e.prototype._log=function(e,t,n){var r;null===(r=this._telemetryHandler)||void 0===r||r.trackActivityEvent(e+"."+t,n)},e.prototype._validateAuthTokenExpiry=function(e){return!!e.expiresOn&&e.expiresOn>new Date(Date.now()+5e3)&&!e.error},e.prototype._tryGetDecodedToken=function(e){if(!e)return null;try{return g()(e)}catch(e){return this._log(this._scenarioName,"_tryGetDecodedToken",{message:"Failed to parse token",error:e}),null}},e.prototype._tryGetExpirationFromToken=function(e){if(!e)return null;try{var t=e.split(".")[1].replace("-","+").replace("_","/");return new Date(1e3*JSON.parse(window.atob(t)).exp)}catch(e){return this._log(this._scenarioName,this._scenarioName+"._tryGetExpirationFromToken",{message:"Failed to parse out exp",error:e}),null}},e.prototype._generate128BitUUID=function(){var e=this,t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){return e._hexGenerator(t,n)}))},e.prototype._hexGenerator=function(e,t){var n=(e+16*Math.random())%16|0;return("x"===t?n:3&n|8).toString(16)},e})(),b=(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})();function C(e){return void 0===e&&(e=navigator.userAgent),!!e.match("Android|iP(hone|od|ad)|IEMobile|Windows Phone|Mobile|BlackBerry|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune")}function _(e){return void 0===e&&(e=navigator.userAgent),e.indexOf("Electron")>=0}var S,P=(function(e){function t(t){var n=e.call(this,new I,t)||this;return n._timeoutInMilliseconds=C()?3e4:4e3,n._isAuthTimeoutEnabled=!_(),n}return b(t,e),t.prototype._appendCustomData=function(e){try{return Object.assign(e,{isTeams:!0})}catch(t){return e}},t})(w),I=(function(){function e(){}return e.prototype.sendRequestToParent=function(e,t){microsoftTeams.authentication.getAuthToken({resources:[e.audience],successCallback:function(e){t({success:!0,accessToken:e})},failureCallback:function(e){t({success:!1,errorMessage:"Teams failed to provide the access token. Reason: "+e})}})},e})(),A=new RegExp(/(password|token|key|sig)/i),T=new RegExp(/[a-zA-Z0-9\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\.!#$%&'*+?^_{|}~\-\d]+(@|%40)[a-zA-Z0-9\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF\-\.\d]+\.[a-zA-Z\u0080-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u0300-\u036F\u0370-\u03FF\u0400-\u04FF\u0500-\u052F\u0530-\u058F\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\u0900-\u097F\u0980-\u09FF\u0A00-\u0A7F\u0A80-\u0AFF\u0B00-\u0B7F\u0B80-\u0BFF\u0C00-\u0C7F\u0C80-\u0CFF\u0D00-\u0D7F\u0D80-\u0DFF\u0E00-\u0E7F\u0E80-\u0EFF\u0F00-\u0FFF\u1000-\u109F\u10A0-\u10FF\u1100-\u11FF\u1200-\u137F\u1380-\u139F\u13A0-\u13FF\u1400-\u167F\u1680-\u169F\u16A0-\u16FF\u1700-\u171F\u1720-\u173F\u1740-\u175F\u1760-\u177F\u1780-\u17FF\u1800-\u18AF\u1900-\u194F\u1950-\u197F\u1980-\u19DF\u19E0-\u19FF\u1A00-\u1A1F\u1B00-\u1B7F\u1D00-\u1D7F\u1D80-\u1DBF\u1DC0-\u1DFF\u1E00-\u1EFF\u1F00-\u1FFF\u20D0-\u20FF\u2100-\u214F\u2C00-\u2C5F\u2C60-\u2C7F\u2C80-\u2CFF\u2D00-\u2D2F\u2D30-\u2D7F\u2D80-\u2DDF\u2F00-\u2FDF\u2FF0-\u2FFF\u3040-\u309F\u30A0-\u30FF\u3100-\u312F\u3130-\u318F\u3190-\u319F\u31C0-\u31EF\u31F0-\u31FF\u3200-\u32FF\u3300-\u33FF\u3400-\u4DBF\u4DC0-\u4DFF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA700-\uA71F\uA800-\uA82F\uA840-\uA87F\uAC00-\uD7AF\uF900-\uFAFF]{2,63}/g),k=["$top","$skip","$select","$expand","$orderby","sr","se","sp","sv"];function F(e){try{return (function(e){if(!e)return"";var t=e;t=(function(e,t){var n;try{n=new URL(e)}catch(e){}try{var r="_scrubbedSensitiveData_";if(!n){var o=A.exec(e);return o?E(e,o.index)+r:e}var i=!1;n.pathname=n.pathname.split("/").map((function(e){return A.test(e)?(i=!0,r):e})).join("/");var a=k;n.searchParams.forEach((function(e,t){var o=A.test(t);-1===a.indexOf(t.toLowerCase())&&(o||e&&e!==r)&&(n.searchParams.set(t,o?r:e.length+"chars"),i=!0)}));var s=n.hash;return s&&A.test(s)&&(n.hash=r,i=!0),i?n.toString():e}catch(e){throw new Error("<Exception in scrubSensitiveDataFromUrl>")}})(t=(function(e){try{return e.replace(T,"_scrubbedSensitiveData_")}catch(e){return"<Exception in scrubEmailSafe>"}})(t));try{return E(t,512,!0)}catch(e){throw new Error("Exception in truncateString")}})(e)}catch(e){return"<Exception in scrubSensitiveDataSafe: "+e+">"}}function E(e,t,n){return void 0===n&&(n=!1),e.length<=t?e:e.substring(0,t)+(n?"<truncated>":"")}function O(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){return (function(e,t){var n=(e+16*Math.random())%16|0;return("x"===t?n:3&n|8).toString(16)})(e,t)}))}for(var L in n.d(t,"ParentAccessTokenRetriever",(function(){return w})),n.d(t,"IParentAccessTokenRetriever",(function(){})),n.d(t,"isMobile",(function(){return C})),n.d(t,"isTeamsDesktop",(function(){return _})),n.d(t,"TeamsParentAccessTokenRetriever",(function(){return P})),n.d(t,"generate128BitUUID",(function(){return O})),n.d(t,"scrubSensitiveDataSafe",(function(){return F})),(function(e){!(function(e){Object.assign(e,r)})(e.Core||(e.Core={}))})(globalScopeObject),f)Object.prototype.hasOwnProperty.call(f,L)&&(globalScopeObject[L]=null!==(S=globalScopeObject[L])&&void 0!==S?S:f[L])})]),
/*! For license information please see Player.Types.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/player-types"]=(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)})([(function(e,t,n){e.exports=n(1)}),(function(e,t,n){"use strict";var r,o,i;n.r(t),(function(e){e.Success="Success",e.Failed="Failed",e.SuccessWithErrors="SuccessWithErrors",e.TerminatedOnAppClose="TerminatedOnAppClose",e.Canceled="Canceled"})(r||(r={})),(function(e){e.None="None",e.Http="Http"})(o||(o={})),(function(e){e[e.error=0]="error",e[e.warning=1]="warning",e[e.success=2]="success",e[e.info=3]="info"})(i||(i={})),n.d(t,"ScenarioResult",(function(){return r})),n.d(t,"ToastErrorCategory",(function(){return o})),n.d(t,"ToastType",(function(){return i}))})]);
/*! For license information please see webplayer-apploader.js.LICENSE.txt */
var PA_Client_WebPlayerApploader=(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)})([(function(e,t){e.exports=(function(){return this?this:window})()["@pa-client/player-apploader-dependencies"]}),(function(e,t){e.exports=(function(){return this?this:window})()["@pa-client/player-types"]}),(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PowerPlatformApiDiscovery=void 0;var r=n(5);Object.defineProperty(t,"PowerPlatformApiDiscovery",{enumerable:!0,get:function(){return r.PowerPlatformApiDiscovery}})}),(function(e,t,n){n(4),e.exports=n(6)}),(function(e,t,n){var r=window.Webpack;(null==r?void 0:r.getWebpackPublicPath)&&(n.p=r.getWebpackPublicPath())}),(function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=(function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===r(t)?t:String(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PowerPlatformApiDiscovery=void 0;var a=(function(){function e(t){!(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.clusterCategory=t}return (function(e,t,n){t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"getTokenAudience",value:function(){return"https://".concat(this._getEnvironmentApiHostNameSuffix())}},{key:"getTenantEndpoint",value:function(e){return this._generatePowerPlatformApiDomain(e,"tenant")}},{key:"getEnvironmentEndpoint",value:function(e){return this._generatePowerPlatformApiDomain(e,"environment")}},{key:"_generatePowerPlatformApiDomain",value:function(e,t){if(!/^[a-zA-Z0-9\-]+$/g.test(e))throw new Error("Cannot generate Power Platform API endpoint because the ".concat(t," identifier contains invalid host name characters, only alphanumeric and dash characters are expected: ").concat(e));var n=this._getHexApiSuffixLength(),r=e.toLowerCase().replace(/-/g,"");if(n>=r.length)throw new Error("Cannot generate Power Platform API endpoint because the normalized ".concat(t," identifier must be at least ").concat(n+1," characters in length: ").concat(r));var o=r.substring(r.length-n),i=r.substring(0,r.length-n),a=this._getEnvironmentApiHostNameSuffix();return"".concat(i,".").concat(o,".").concat(t,".").concat(a)}},{key:"_getHexApiSuffixLength",value:function(){switch(this.clusterCategory){case"firstrelease":case"prod":return 2;default:return 1}}},{key:"_getEnvironmentApiHostNameSuffix",value:function(){switch(this.clusterCategory){case"local":return"api.powerplatform.localhost";case"dev":return"api.dev.powerplatform.com";case"test":return"api.test.powerplatform.com";case"preprod":return"api.preprod.powerplatform.com";case"firstrelease":case"prod":return"api.powerplatform.com";case"gov":return"api.gov.powerplatform.microsoft.us";case"high":return"api.high.powerplatform.microsoft.us";case"dod":return"api.appsplatform.us";case"mooncake":return"api.powerplatform.partner.microsoftonline.cn";case"ex":return"api.powerplatform.eaglex.ic.gov";case"rx":return"api.powerplatform.microsoft.scloud";default:throw new Error("Invalid ClusterCategory value: ".concat(this.clusterCategory))}}}]),e})();t.PowerPlatformApiDiscovery=a}),(function(e,t,n){"use strict";n.r(t),n.d(t,"AuthInitializer",(function(){return M})),n.d(t,"register",(function(){return B})),n.d(t,"endMarker",(function(){return U})),n.d(t,"setGlobalMarker",(function(){return W})),n.d(t,"startMarker",(function(){return H})),n.d(t,"getWebPlayerConfig",(function(){return Wt})),n.d(t,"updateCdnConfig",(function(){return zt})),n.d(t,"waitForPublishedAppLoadedIfSupported",(function(){return _t})),n.d(t,"LoadPhase",(function(){return j})),n.d(t,"SplashScreenView",(function(){return Q})),n.d(t,"getWebpackPublicPath",(function(){return $})),n.d(t,"loadAppResourcesAsync",(function(){return ne})),n.d(t,"loadAppResourcesNoSplashScreen",(function(){return ee})),n.d(t,"loadAppResourcesWithSplashScreen",(function(){return te})),n.d(t,"mapResourceUrl",(function(){return X})),n.d(t,"preloadAppResources",(function(){return Y})),n.d(t,"SessionDataHandler",(function(){return P})),n.d(t,"SessionInitializer",(function(){return fe})),n.d(t,"SessionRequest",(function(){return se})),n.d(t,"LogWebPlayerErrorToServer",(function(){return p})),n.d(t,"TelemetryUtils",(function(){return d})),n.d(t,"getAppLoaderTelemetryInstance",(function(){return y})),n.d(t,"allGoodConfirmed",(function(){return gt})),n.d(t,"bootstrap",(function(){return ht})),n.d(t,"dumpLogsToConsole",(function(){return vt})),n.d(t,"getAfterLoginTimestamp",(function(){return ft})),n.d(t,"getBeforeLoginTimestamp",(function(){return dt})),n.d(t,"getNumAttempts",(function(){return mt})),n.d(t,"isDefaultAuthMode",(function(){return I})),n.d(t,"isIframeAuthMode",(function(){return A})),n.d(t,"isOnBehalfOfAuthMode",(function(){return T})),n.d(t,"isOverrideAuthMode",(function(){return k})),n.d(t,"useMSALAuthLibrary",(function(){return Ze})),n.d(t,"useADALAuthLibrary",(function(){return $e})),n.d(t,"reloadWindowWithLogging",(function(){return je})),n.d(t,"isUsingWebPlayerSdk",(function(){return Re})),n.d(t,"goToErrorPage",(function(){return De})),n.d(t,"PlayerFiles",(function(){return bt}));var r,o=n(0);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}})(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=(function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===i(t)?t:String(t)}function p(e){try{var t,n,r,o,i,a,s=null!==(t=window.errorTelemetryEndpoint)&&void 0!==t?t:null===(n=window.webPlayerServerConfig)||void 0===n||null===(r=n.EndpointConfig)||void 0===r?void 0:r.ErrorTelemetryEndpoint,c=null!==(o=window.antiForgeryToken)&&void 0!==o?o:null===(i=window.webPlayerServerConfig)||void 0===i||null===(a=i.AuthConfig)||void 0===a?void 0:a.AntiForgeryToken;if(s&&c){var l=new FormData;Object.getOwnPropertyNames(e).forEach((function(t){l.append(t,e[t].toString())}));var u=new XMLHttpRequest;u.open("POST",s),u.setRequestHeader("__RequestVerificationToken",c),u.setRequestHeader("x-ms-client-session-id","webplayer-"+Date.now()),u.setRequestHeader("x-ms-user-agent"," PowerApps (Web; Player)"),u.setRequestHeader("x-ms-client-request-id","webplayer-logerror-"+Date.now()),u.send(l)}}catch(e){console.log("Failed to Log Error to Server.")}}!(function(e){e[e.Activity=0]="Activity",e[e.Event=1]="Event",e[e.Error=2]="Error",e[e.StartScenario=3]="StartScenario",e[e.EndScenario=4]="EndScenario"})(r||(r={}));var d=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;c(this,e),this._logWebPlayerErrorToServer=t,this.stash=[],this.scenarioGuidMapping={},this.canLogToCore=!1}return (function(e,t,n){t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"isCoreTelemetryAvailable",get:function(){var e,t;return!(null===(e=window.Core)||void 0===e||null===(t=e.Telemetry)||void 0===t||!t.Log)}},{key:"stringifyError",value:function(e){var t=null;if(e)if(e instanceof Error){var n=Object.assign({},e);n.name=e.name,n.message=e.message,n.stack=e.stack,t=JSON.stringify(n)}else t=JSON.stringify(e);return t}},{key:"trackErrorEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n;this.isCoreTelemetryAvailable&&this.canLogToCore?window.Core.Telemetry.Log.trackErrorEvent(e,t):(this._stashLog(r.Error,e,t),this._logWebPlayerErrorToServer({sessionId:"",eventName:e,message:"",data:"",error:null!==(n=this.stringifyError(t))&&void 0!==n?n:""}))}catch(e){}}},{key:"trackActivityEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isCoreTelemetryAvailable&&this.canLogToCore?window.Core.Telemetry.Log.trackActivityEvent(e,t):this._stashLog(r.Activity,e,t)}},{key:"startScenario",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(o.generate128BitUUID)();if(this.isCoreTelemetryAvailable&&this.canLogToCore){var i=this._startScenarioOnCoreTelemetry(e,t)||n;return this.scenarioGuidMapping[i]=i,i}return this.scenarioGuidMapping[n]="",this._stashLog(r.StartScenario,"",t,e,void 0,n),n}},{key:"endScenario",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.isCoreTelemetryAvailable&&this.canLogToCore?this._endScenarioOnCoreTelemetry(e,t,n):(this._stashLog(r.EndScenario,"",n,void 0,t,e),0)}},{key:"reportCoreLoaded",value:function(){this._logStashedData()}},{key:"_stashLog",value:function(e,t,n,r,o,i){var a;null===(a=this.stash)||void 0===a||a.push({logType:e,logTime:new Date,name:t,data:n,scenarioName:r,scenarioResult:o,scenarioGuid:i})}},{key:"_logStashedData",value:function(){if(this.stash&&this.isCoreTelemetryAvailable){for(var e=this.stash.length;this.stash.length>0;){var t=this.stash.shift();if(t)switch(this._appendCustomData(t.data,t.logTime),t.logType){case r.Error:window.Core.Telemetry.Log.trackErrorEvent(t.name,t.data);break;case r.StartScenario:if(t.scenarioName&&t.scenarioGuid){var n=this._startScenarioOnCoreTelemetry(t.scenarioName,t.data);this.scenarioGuidMapping[t.scenarioGuid]=n||""}break;case r.EndScenario:t.scenarioGuid&&t.scenarioResult&&this._endScenarioOnCoreTelemetry(t.scenarioGuid,t.scenarioResult,t.data);break;default:case r.Activity:window.Core.Telemetry.Log.trackActivityEvent(t.name,t.data)}}window.Core.Telemetry.Log.flush(),window.Core.Telemetry.Log.trackActivityEvent("TelemetryUtils.Flushed",{numberOfEventsFlushed:e}),this.stash=null,this.canLogToCore=!0}}},{key:"_appendCustomData",value:function(e,t){try{return Object.assign(e,{actualLogTime:t})}catch(t){return e}}},{key:"_mapBackToCoreScenarioName",value:function(e){if(this.isCoreTelemetryAvailable)switch(e){case"ParentAccessTokenRetrieverAcquireToken":return Core.Telemetry.ScenarioName.ParentAccessTokenRetrieverAcquireToken;case"PlayerHostInitialize":return Core.Telemetry.ScenarioName.PlayerHostInitialize;case"PlayerHostLoadAppHost":return Core.Telemetry.ScenarioName.PlayerHostLoadAppHost;case"PlayerLifecycle.WebPlayer.Play.Boot":return Core.Telemetry.ScenarioName.PlayerLifecycleWebPlayerPlayBoot;default:throw new Error("Invalid Scenario Naming: "+e)}throw new Error("Core Telemetry isn't available")}},{key:"_mapBackToCoreScenarioResult",value:function(e){if(this.isCoreTelemetryAvailable)switch(e){case"Success":return Core.Telemetry.ScenarioResult.Success;case"Failed":return Core.Telemetry.ScenarioResult.Failed;case"SuccessWithErrors":return Core.Telemetry.ScenarioResult.SuccessWithErrors;default:throw new Error("Invalid Scenario result: "+e)}throw new Error("Core Telemetry isn't available")}},{key:"_startScenarioOnCoreTelemetry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isCoreTelemetryAvailable)try{var n=this._mapBackToCoreScenarioName(e);return window.Core.Telemetry.Log.startScenario(n,t)}catch(n){Object.assign(t,{unmappedScenarioName:e}),window.Core.Telemetry.Log.trackActivityEvent("AppLoaderTelemetry.StartScenario.UnmappedScenarioName",t)}return null}},{key:"_endScenarioOnCoreTelemetry",value:function(e,t,n){if(this.isCoreTelemetryAvailable&&e)try{var r=this._mapBackToCoreScenarioResult(t),o=this.scenarioGuidMapping[e];return(o||""===o)&&delete this.scenarioGuidMapping[e],o?(n=Object.assign(n,{scenarioResult:r}),window.Core.Telemetry.Log.endScenario(o,n)):(n=Object.assign(n,{invalidScenarioGuid:o}),window.Core.Telemetry.Log.trackActivityEvent("AppLoaderTelemetry.EndScenario.invalidScenarioGuid",n),0)}catch(e){return n=Object.assign(n,{unmappedScenarioResult:t}),window.Core.Telemetry.Log.trackActivityEvent("AppLoaderTelemetry.EndScenario.UnmappedScenarioData",n),0}return-1}}],[{key:"instance",get:function(){return this._instance||(this._instance=f||new e),this._instance}}]),e})();d._instance=void 0;var f=new d;if("undefined"!=typeof window&&"PerformanceObserver"in window&&!window.webPlayerServerConfig.IsConsentOnly){var m=new PerformanceObserver((function(e){var t,n=a(e.getEntries());try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r.entryType,i=r.name,s=r.startTime,c=r.duration;c>0&&d.instance.trackActivityEvent("PowerAppsClient.Performance.PerformanceObserver",{entryType:o,name:i,startTime:new Date(performance.timing.navigationStart+s).toUTCString(),duration:c})}}catch(e){n.e(e)}finally{n.f()}}));try{m.observe({entryTypes:["longtask"]})}catch(e){d.instance.trackActivityEvent("PowerAppsClient.Performance.PerformanceObserver.EntryNotSupported",{error:null==e?void 0:e.message})}var g=!1,h=window.setTimeout((function(){var e,t;null===(e=(t=window).disconnectPerformanceObserver)||void 0===e||e.call(t),g=!0}),2e4),v=!1;window.disconnectPerformanceObserver=function(){v||(window.clearTimeout(h),m.disconnect(),d.instance.trackActivityEvent("PowerAppsClient.Performance.PerformanceObserverDisconnected",{timedout:g}),v=!0)}}function y(){return d.instance}function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}function _(e){var t=(function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===w(t)?t:String(t)}var S,P=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.instance;b(this,e),this._telemetryHandler=t}return (function(e,t,n){t&&C(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"updateEncryptedKey",value:function(e){var t,n,r,o,i,a,s,c,l,u=this;if(null==e||!e.key||null===(t=window.Core)||void 0===t||!t.Environment)throw new Error("Failed to update Encrypted key. Key defined: ".concat(!(null==e||!e.key),", Core.Environment defined: ").concat(!(null===(n=window.Core)||void 0===n||!n.Environment)));if(null!==(r=window.Core)&&void 0!==r&&null!==(o=r.Environment)&&void 0!==o&&o.isWebPlayerEncryptedStorageEnabled()){var p=null===(i=window.Core)||void 0===i||null===(a=i.Loader)||void 0===a||null===(s=a.ObjectFactory)||void 0===s?void 0:s.instance.getSingleton(null===(c=Core)||void 0===c||null===(l=c.IO)||void 0===l?void 0:l.IEncryptedStorageKey);if(!p)throw new Error("EncryptedStorage is undefined");p.updateKeyAsync(e.key).then((function(){u.trackActivityEvent("UpdateEncryptedKeyCompleted")}))}else this.trackActivityEvent("UpdateEncryptedKeyNotEnabled")}},{key:"setAppDetails",value:function(e,t){var n,r,o,i,a,s;if(null===(n=window.AppMagic)||void 0===n||null===(r=n.Runtime)||void 0===r||null===(o=r.AppHostRuntime)||void 0===o||!o.getInstance().setAppDetailsFromExtendedMetadata)throw new Error("AppMagic.Runtime.AppHostRuntime.setAppDetailsFromExtendedMetadata is undefined.");null===(i=window.AppMagic)||void 0===i||null===(a=i.Runtime)||void 0===a||null===(s=a.AppHostRuntime)||void 0===s||s.getInstance().setAppDetailsFromExtendedMetadata(e,t)}},{key:"trackErrorEvent",value:function(e,t){this._telemetryHandler.trackErrorEvent("PowerAppsClient.WebPlayer.SessionInitializationFailure."+e,t)}},{key:"trackActivityEvent",value:function(e,t){this._telemetryHandler.trackActivityEvent("PowerAppsClient.WebPlayer.SessionInitializationActivity."+e,t)}}]),e})();function I(){var e,t;return(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.Mode)===S.Default}function A(){var e,t;return(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.Mode)===S.Iframe}function T(){var e,t;return(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.Mode)===S.OnBehalfOf}function k(){var e,t;return(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.Mode)===S.Override}function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=(function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===F(t)?t:String(t)}!(function(e){e[e.Default=0]="Default",e[e.Iframe=1]="Iframe",e[e.OnBehalfOf=2]="OnBehalfOf",e[e.Override=3]="Override",e[e.Teams=4]="Teams",e[e.AuthFlowProxy=5]="AuthFlowProxy"})(S||(S={}));var M=(function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(o.isTeamsDesktop)(),a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Object(o.isMobile)();E(this,e),this._parentTokenRetriever=t,this._createXMLHttpRequest=n,this._sessioninitializer=r,this._isTeamsDesktop=i,this._isMobile=a,this._rpResource=void 0,this._apiHubResource=void 0,this._graphResource=void 0,this._telemetryHandler=d.instance,this._rpResource=e.getRpResource(),this._apiHubResource=e.getApiHubResource(),this._graphResource=e.getGraphResource(),window.preloadAuthData={}}return (function(e,t,n){t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"start",value:function(){var t=this;if(window.webPlayerServerConfig&&(!window.webPlayerServerConfig.AuthConfig.UseClientSideAuth||!I())){if(I()||A()&&window.webPlayerServerConfig.AuthConfig.IsAuthenticated)return this._preloadAccessTokenXhr(window.webPlayerServerConfig.EndpointConfig.RefreshAccessTokenEndpoint,this._rpResource),void this._preloadAccessTokenXhr(window.webPlayerServerConfig.EndpointConfig.RefreshAccessTokenEndpoint,this._apiHubResource);var n,r,o,i;if(k())this._parentTokenRetriever.acquireToken(this._rpResource,(function(){}),!1),this._parentTokenRetriever.acquireToken(this._apiHubResource,(function(){}),!1),null!==(n=window.webPlayerServerConfig)&&void 0!==n&&null!==(r=n.PublishedAppConfig)&&void 0!==r&&r.CdsOrgUrl&&this._parentTokenRetriever.acquireToken(null===(o=window.webPlayerServerConfig)||void 0===o||null===(i=o.PublishedAppConfig)||void 0===i?void 0:i.CdsOrgUrl,(function(){}),!1);else if(T()||this._isTeams()){var a,s,c=null===(a=window.webPlayerServerConfig)||void 0===a||null===(s=a.PublishedAppConfig)||void 0===s?void 0:s.CdsOrgUrl,l=[this._apiHubResource,this._graphResource],u=this._createXMLHttpRequest();c&&l.push(c);var p=Date.now();l.forEach((function(e){window.preloadAuthData[e]={xmlHttpRequest:u,startTime:p,isBatched:!0}})),this._parentTokenRetriever.acquireToken(e._onBehalfOfResource,(function(e){var n=new P(t._telemetryHandler);if(t._sessioninitializer&&t._shouldMakeSessionCall())try{t._sessioninitializer.initializeSessionAndGetAppDetails(e,n)}catch(e){n.trackErrorEvent("initializeSessionAndGetAppDetailsFailed",e)}t._decorateAndSendAccessTokenRequest(u,window.webPlayerServerConfig.EndpointConfig.GetOnBehalfOfTokenEndpoint,{resourceUrls:l},null==e?void 0:e.accessToken)}),!1,!0)}}}},{key:"_preloadAccessTokenXhr",value:function(e,t,n,r){r||(r=this._createXMLHttpRequest(),window.preloadAuthData[t]={xmlHttpRequest:r,startTime:Date.now(),isBatched:!1}),this._decorateAndSendAccessTokenRequest(r,e,{resourceUrl:t},n)}},{key:"_decorateAndSendAccessTokenRequest",value:function(e,t,n,r){e.open("POST",t),e.setRequestHeader("Content-Type","application/json; charset=UTF-8"),e.setRequestHeader("__RequestVerificationToken",window.antiForgeryToken),r&&e.setRequestHeader("Authorization","Bearer ".concat(r));var o=JSON.stringify(n);e.send(o)}},{key:"_isTeams",value:function(){return window.webPlayerServerConfig&&window.webPlayerServerConfig.IsTeams}},{key:"_isTeamsNative",value:function(){try{return this._isTeams()&&(this._isMobile||this._isTeamsDesktop)}catch(e){return!1}}},{key:"_shouldMakeSessionCall",value:function(){var e,t=!this._isTeamsNative()||!(null!==(e=window.webPlayerServerConfig.PublishedAppConfig)&&void 0!==e&&e.UsesAltAuth);return t||this._telemetryHandler.trackActivityEvent("AuthInitializer._shouldMakeSessionCall",{message:"Valid alt auth on teams native scenario",willSessionCallBePerformed:t}),t}}],[{key:"getRpResource",value:function(){var e="https://service.powerapps.com/";return window.webPlayerServerConfig&&("gccmoderate"===window.webPlayerServerConfig.Environment?e="https://gov.service.powerapps.us/":"gcchigh"===window.webPlayerServerConfig.Environment?e="https://high.service.powerapps.us/":"dod"===window.webPlayerServerConfig.Environment&&(e="https://api.apps.appsplatform.us/")),e}},{key:"getApiHubResource",value:function(){var e="https://apihub.azure.com";return window.webPlayerServerConfig&&("gccmoderate"===window.webPlayerServerConfig.Environment?e="https://power-apis-usgov001-public.azure-apihub.us":"gcchigh"===window.webPlayerServerConfig.Environment?e="https://power-apis-usgov001-sovereign.azure-apihub.us":"dod"===window.webPlayerServerConfig.Environment&&(e="https://power-apis-usdod-001.azure-apihub.us")),e}},{key:"getGraphResource",value:function(){var e="https://graph.microsoft.com";return window.webPlayerServerConfig&&("gccmoderate"===window.webPlayerServerConfig.Environment?e="https://graph.microsoft.com":"gcchigh"===window.webPlayerServerConfig.Environment?e="https://graph.microsoft.us":"dod"===window.webPlayerServerConfig.Environment&&(e="https://dod-graph.microsoft.us")),e}}]),e})();function B(e){null!==e&&window.addEventListener("error",(function(t){"string"==typeof t&&(t=new ErrorEvent("error",{message:t})),e(t)}))}M._onBehalfOfResource=window.webPlayerServerConfig.AuthConfig.OnBehalfOfResource;var x,j,R=window,D=window&&(R.performance||R.webkitPerformance||R.msPerformance||R.mozPerformance),q=D&&"function"==typeof D.mark&&"function"==typeof D.measure;function H(e){q&&D.mark("".concat("__PA_PERF_MARKER__").concat(e,"_START"))}function W(e){q&&D.mark("".concat("__PA_PERF_MARKER__").concat(e))}function U(e){if(q){var t="".concat("__PA_PERF_MARKER__").concat(e,"_END");D.mark(t);var n="".concat("__PA_PERF_MARKER__").concat(e,"_START");D.measure(e,n,t)}}function N(){return window._webAuthConfig&&window._webAuthConfig.webAuthoringVersion||""}function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}function J(e,t,n){return t&&G(e.prototype,t),n&&G(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function K(e){var t=(function(e,t){if("object"!==V(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===V(t)?t:String(t)}q&&(R.__PERF_MARKER_PREFIX__="__PA_PERF_MARKER__",D.mark("".concat("__PA_PERF_MARKER__","PerfProfilerLoaded"))),location&&location.hostname,document.createElement("a"),(function(e){e[e.NonUIPhase=1]="NonUIPhase",e[e.UIPhase=2]="UIPhase"})(j||(j={}));var X=null!==(x=window.ResourceLoader)&&void 0!==x&&x.mapResourceUrl?window.ResourceLoader.mapResourceUrl:ScriptLoader.WebPlayerUrlMapper.mapResourceUrl,Q=(function(){function e(){z(this,e)}return J(e,[{key:"transitionSplashScreen",value:function(e){var t=document.getElementById("spl-loading-text");t&&(t.innerText=e);var n=document.getElementById("spl-powerapps");n&&(n.children[0].style.opacity="0",n.children[1].style.opacity="0");var r=document.getElementById("spl-loading");r&&setTimeout((function(){r.children[0].style.opacity="1",r.children[1].style.opacity="1"}),500)}},{key:"initialize",value:function(e){this._addCssClassToDocRoot(e)}},{key:"_addCssClassToDocRoot",value:function(e){document.getElementsByTagName("html")[0].classList.add(e)}}],[{key:"instance",value:function(){return this._instance||(this._instance=new e),this._instance}},{key:"logTimingEvent",value:function(e){var t,n;if(null!==(t=performance)&&void 0!==t&&null!==(n=t.timing)&&void 0!==n&&n.navigationStart){var r=Date.now()-performance.timing.navigationStart;Core.Telemetry.Log.trackActivityEvent(e,{message:"Resource loader timing event",duration:r/1e3,version:"20180404"})}else Core.Telemetry.Log.trackActivityEvent(e,{message:"A part of performance.timing.navigationStart doesn't exist",version:"20180404"})}},{key:"disposeInstance",value:function(e,t){var n=this,r=document.getElementById("html-splash-screen");r&&e&&e(r,{opacity:0,scaleX:1.1,scaleY:1.1},{duration:500,easing:"easeOutExpo",complete:function(){var e;null==r||null===(e=r.parentNode)||void 0===e||e.removeChild(r),n.logTimingEvent(t)}}),this._instance=null}}]),e})();Q._instance=null;var Z=(function(){function e(t,n,r){z(this,e),this._targetPlatform=void 0,this._disableAsyncScriptLoad=void 0,this._groups=void 0,this._isWindowsOS=void 0,this._targetPlatform=t,this._disableAsyncScriptLoad=r,this._groups=n,this._isWindowsOS=window.navigator.userAgent.indexOf("Windows")>-1}return J(e,[{key:"_isResourceEnabled",value:function(e){if(e.disabled)return!1;var t=e.platform||ScriptLoader.Platform.All;return t===ScriptLoader.Platform.All||this._targetPlatform===t}},{key:"getResourceCount",value:function(){var e=this,t=0;return this._groups.forEach((function(n){n.contents.forEach((function(n){e._isResourceEnabled(n)&&t++}))})),t}},{key:"preloadResources",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._preloadResources(e)}},{key:"injectResources",value:function(e){this._loadCss(e),this._loadScripts(e)}},{key:"_loadScripts",value:function(e){var t=this,n=document.createDocumentFragment();this._groups.forEach((function(r,o){0===o&&H("loadAppResources"),"function"==typeof r.preload&&r.preload(t._targetPlatform);var i=[];r.contents.forEach((function(o){if(t._isResourceEnabled(o)&&o.type===ScriptLoader.ResourceType.JS&&(!o.os||o.os===ScriptLoader.OperatingSystem.All||!t._isWindowsOS||o.os===ScriptLoader.OperatingSystem.Windows)){i.push(o);var a=ScriptLoader.createScriptTagWithFallback(o,r.skipMapping,t._disableAsyncScriptLoad,(function(e){if(i.pop(),0===i.length){if("function"==typeof r.postload)try{r.postload(t._targetPlatform,e)}catch(n){throw t._logErrorForLoadScripts(e,n),n}U("loadAppResources")}}),e);n.appendChild(a)}}))})),document.head.appendChild(n)}},{key:"_logErrorForLoadScripts",value:function(e,t){var n=window.Core;n&&n.Telemetry&&n.Telemetry.Log&&n.Telemetry.Log.trackEvent("PowerAppsClient.Error",{operationName:"LoaderWorker._loadScripts",message:t.message,stack:t.stack,mappedResourceUrl:e})}},{key:"_loadCss",value:function(e){var t=this,n=document.createDocumentFragment();this._groups.forEach((function(r){r.contents.forEach((function(r){if(t._isResourceEnabled(r)&&r.type===ScriptLoader.ResourceType.CSS&&(!r.os||r.os===ScriptLoader.OperatingSystem.All||!t._isWindowsOS||r.os===ScriptLoader.OperatingSystem.Windows)){var o=X(document,r.src),i=document.createElement("LINK");i.type="text/css",i.rel="stylesheet",i.href=o,e&&i.addEventListener("error",(function(t){return e(o,t)})),n.appendChild(i)}}))})),document.head.appendChild(n)}},{key:"_preloadResources",value:function(e){var t=this,n=[];this._groups.forEach((function(r){var o=r.skipMapping;r.contents.forEach((function(r){if(t._isResourceEnabled(r)){var i=e?"prefetch":"preload",a=o?r.src:X(document,r.src),s=r.type===ScriptLoader.ResourceType.JS?"script":"style",c=r.type===ScriptLoader.ResourceType.JS?"text/javascript":"text/css",l=!r.preventCrossOriginHeader,u=document.createElement("SCRIPT");l&&u.setAttribute("crossorigin","anonymous"),u.type=c,u.src=a;var p='<link rel="'.concat(i,'" href="').concat(a,'" as="').concat(s,'" type="').concat(c,'" ').concat(l?'crossorigin="anonymous"':"",">");n.push(p)}}))})),document.head.insertAdjacentHTML("beforeend",n.join("\n"))}}]),e})();function $(e){if(e===ScriptLoader.Platform.WebPlayer)return ScriptLoader.WebPlayerUrlMapper._cdnConfig.CdnUrl?"/"!==ScriptLoader.WebPlayerUrlMapper._cdnConfig.CdnUrl.slice(-1)?ScriptLoader.WebPlayerUrlMapper._cdnConfig.CdnUrl+"/":ScriptLoader.WebPlayerUrlMapper._cdnConfig.CdnUrl:"/";var t="/"+N;return(window._webAuthConfig&&window._webAuthConfig.cdnConfig||{}).cdnUrl+t+"/studio/js/"}function Y(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=new Z(e,t.groups,!1);r.preloadResources(n)}function ee(e,t,n){var r=e===ScriptLoader.Platform.Desktop;new Z(e,t.groups,r).injectResources(n)}function te(e,t,n,r){var o=Q.instance(),i=e===ScriptLoader.Platform.Desktop,a=new Z(e,t.groups,i),s=function(){var e=function(){o.initialize("web"),a.injectResources(r)};"function"==typeof n?n(e):e()};"interactive"===document.readyState||"complete"===document.readyState?s():window.addEventListener("DOMContentLoaded",s)}function ne(e,t){return new Promise((function(n,r){t.postload=function(){return n()},new Z(e,[t],!1).injectResources((function(){return r()}))}))}function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ae(r.key),r)}}function ae(e){var t=(function(e,t){if("object"!==re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===re(t)?t:String(t)}var se=(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new XMLHttpRequest;oe(this,e),this._sessionEndpoint=t,this._httpProvider=n}return (function(e,t,n){t&&ie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"sendSessionRequest",value:function(e,t,n,r){var i=Object(o.generate128BitUUID)(),a={appId:t,fetchAppMetadata:n};this._httpProvider.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status)try{var e=JSON.parse(this.responseText);r(e)}catch(e){r(null)}else this.readyState===XMLHttpRequest.DONE&&200!==this.status&&r(null)},this._httpProvider.open("POST",this._sessionEndpoint),this._httpProvider.setRequestHeader("Content-Type","application/json; charset=utf-8"),this._httpProvider.setRequestHeader("x-ms-client-request-id",i),this._httpProvider.setRequestHeader("x-ms-correlation-request-id",i),this._httpProvider.setRequestHeader("Authorization","Bearer ".concat(e)),this._httpProvider.send(JSON.stringify(a))}}]),e})();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pe(r.key),r)}}function pe(e){var t=(function(e,t){if("object"!==ce(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===ce(t)?t:String(t)}var de,fe=(function(){function e(t,n){var r,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Date.now()};le(this,e),this._resource=t,this._now=i,this._sessionRequestMade=!1,this._sessionEndpoint=void 0,this._sessionCaller=void 0,this._appDetails=null,this._playerJsLoaded=!1,this._sessionDataHandler=null,this._sessionEndpoint=null===(r=window.webPlayerServerConfig)||void 0===r||null===(o=r.EndpointConfig)||void 0===o?void 0:o.SessionEndpoint,this._sessionCaller=null!=n?n:new se(this._sessionEndpoint)}return (function(e,t,n){t&&ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"initializeSessionAndGetAppDetails",value:function(e,t){var n,r,o,i,a=this;if(!this._sessionRequestMade){this._sessionDataHandler=t;var s=null==e?void 0:e.accessToken;if(s)if(this._resource){var c=null===(n=window.webPlayerServerConfig)||void 0===n?void 0:n.AppId;if(c)if(this._sessionEndpoint){var l=null===(r=window.webPlayerServerConfig.AuthConfig)||void 0===r||null===(o=r.ValidResourcesForSession)||void 0===o?void 0:o.indexOf(this._resource);if(void 0!==l&&-1!==l){this._sessionRequestMade=!0;var u=null!==(i=this._tryGetPublishedAppMetadataFromWebPlayerServerConfig())&&void 0!==i?i:null,p=!(null!=u&&u.indexWebHtmlUrl);this._sessionCaller.sendSessionRequest(s,c,p,(function(e){var t;e?(a._appDetails=e,a._updateAppDetails()):null===(t=a._sessionDataHandler)||void 0===t||t.trackErrorEvent("NoResultsFromSessionEndpoint")}))}else{var d,f="Resource does not match valid resources for session. No "+this._resource+" in list of resources: "+(null===(d=window.webPlayerServerConfig.AuthConfig)||void 0===d?void 0:d.ValidResourcesForSession);this._sessionDataHandler.trackErrorEvent("InvalidResource",{message:f})}}else this._sessionDataHandler.trackErrorEvent("MissingSessionEndpoint");else this._sessionDataHandler.trackErrorEvent("MissingAppId")}else this._sessionDataHandler.trackErrorEvent("MissingAuthResource");else this._sessionDataHandler.trackErrorEvent("MissingAccessToken")}}},{key:"notifyWebplayerRuntimeLoaded",value:function(){this._playerJsLoaded=!0,this._updateAppDetails()}},{key:"_isError",value:function(e){return void 0!==e.message}},{key:"_trackError",value:function(e,t){var n,r=t&&this._isError(t)?t:new Error("Unable to get message from Error thrown by <"+e+">.");null===(n=this._sessionDataHandler)||void 0===n||n.trackErrorEvent(e,{errorData:null==r?void 0:r.message})}},{key:"_updateAppDetails",value:function(){if(this._playerJsLoaded&&this._appDetails){var e,t=!1,n=!1;try{var r;null===(r=this._sessionDataHandler)||void 0===r||r.updateEncryptedKey(this._appDetails.keyData),t=!0}catch(e){this._trackError("FailedToUpdateEncryptedKey",e)}try{var o;null===(o=this._sessionDataHandler)||void 0===o||o.setAppDetails(this._appDetails.appMetadata,"SessionInitializer._updateAppDetails"),n=!0}catch(e){this._trackError("FailedToSetAppDetails",e)}n&&t&&(null===(e=this._sessionDataHandler)||void 0===e||e.trackActivityEvent("UpdateAppDetailsCompleted"))}}},{key:"_tryGetSASKeyExpiryDate",value:function(e){try{var t=new URL(e).searchParams.get("se");if(t)return new Date(decodeURIComponent(t))}catch(e){this._trackError("ExceptionParsingSASExpiry",e)}return null}},{key:"_tryGetPublishedAppMetadataFromWebPlayerServerConfig",value:function(){var e;if(null!==(e=window.webPlayerServerConfig)&&void 0!==e&&e.PublishedAppConfig){var t=window.webPlayerServerConfig.PublishedAppConfig,n=null;try{t.DocumentVersion&&(n=JSON.parse(t.DocumentVersion))}catch(e){this._trackError("ExceptionParsingDocumentVersion",e)}if(t.IndexWebHtmlUrl&&t.AppPackageResourcesKind){if(window.URLSearchParams){var r,o=this._tryGetSASKeyExpiryDate(t.IndexWebHtmlUrl);if(o&&o.getTime()-this._now()<288e5)return window.webPlayerServerConfig.PublishedAppConfig.IndexWebHtmlUrl=null,window.webPlayerServerConfig.PublishedAppConfig.ReadonlyIndexWebHtmlUrl=null,window.webPlayerServerConfig.PublishedAppConfig.DocumentVersion=null,null===(r=this._sessionDataHandler)||void 0===r||r.trackActivityEvent("ClearedStalePublishedAppConfig"),null}return{indexWebHtmlUrl:t.IndexWebHtmlUrl,readonlyIndexWebHtmlUrl:t.ReadonlyIndexWebHtmlUrl,documentVersion:n,appPackageResourcesKind:t.AppPackageResourcesKind,appVersion:t.AppVersion}}}return null}}]),e})();function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,he(r.key),r)}}function he(e){var t=(function(e,t){if("object"!==me(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===me(t)?t:String(t)}!(function(e){e[e.BadConfig=0]="BadConfig",e[e.MainAppInIframe=1]="MainAppInIframe",e[e.InfiniteLoop=2]="InfiniteLoop",e[e.StorageFailed=3]="StorageFailed",e[e.AadError=4]="AadError",e[e.UnhandledException=5]="UnhandledException",e[e.Assertion=6]="Assertion",e[e.Unknown=7]="Unknown",e[e.UserInterventionNeeded_StorageBlocked=8]="UserInterventionNeeded_StorageBlocked",e[e.UserInterventionNeeded_CookiesBlocked=9]="UserInterventionNeeded_CookiesBlocked",e[e.UserInterventionNeeded_NavigateToAadDenied=10]="UserInterventionNeeded_NavigateToAadDenied",e[e.UserInterventionNeeded_NavigateToAadTimeout=11]="UserInterventionNeeded_NavigateToAadTimeout",e[e.UserInterventionNeeded_StorageLost=12]="UserInterventionNeeded_StorageLost"})(de||(de={}));var ve=(function(){function e(t,n){!(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._error=void 0,this._description=void 0,this._error=t,this._description=n}return (function(e,t,n){t&&ge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"error",get:function(){return this._error}},{key:"description",get:function(){return this._description}}]),e})();function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,be(r.key),r)}}function be(e){var t=(function(e,t){if("object"!==ye(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===ye(t)?t:String(t)}var Ce=(function(){function e(){!(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._sessionStorage=window.sessionStorage,this._localStorage=window.localStorage}return (function(e,t,n){t&&we(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"getItem",value:function(e){return this.executeBoth((function(t){return t.getItem(e)}),(function(e){return null!==e}))}},{key:"removeItem",value:function(e){this.executeBoth((function(t){return t.removeItem(e)}))}},{key:"setItem",value:function(e,t){this.executeBoth((function(n){return n.setItem(e,t)}))}},{key:"executeBoth",value:function(e,t){var n=0;try{var r=e(this._sessionStorage);if(t&&t(r))return r}catch(e){n++}try{var o=e(this._localStorage);if(t&&t(o))return o}catch(e){n++}if(2===n)throw new ve(de.StorageFailed,"sessionStorage and localStorage failed.");return null}}]),e})();function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pe(r.key),r)}}function Pe(e){var t=(function(e,t){if("object"!==_e(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==_e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===_e(t)?t:String(t)}var Ie=(function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._storage=void 0,!t)throw new ve(de.Assertion,"storage is mandatory");this._storage=t}return (function(e,t,n){t&&Se(e.prototype,t),n&&Se(e,n),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"setItem",value:function(t,n){var r=this;e._runWithCustomException((function(){r._storage.setItem(t,n)}))}},{key:"getItem",value:function(t){var n=this;return e._runWithCustomException((function(){return n._storage.getItem(t)}))}},{key:"removeItem",value:function(t){var n=this;e._runWithCustomException((function(){n._storage.removeItem(t)}))}}],[{key:"transient",get:function(){return e._transient||(e._transient=new e(window.sessionStorage))}},{key:"transientWithGlobalFallback",get:function(){return e._transientWithGlobalFallback||(e._transientWithGlobalFallback=new e(new Ce))}},{key:"_runWithCustomException",value:function(e){try{return e()}catch(e){var t="";try{t=e.toString()}catch(e){}throw new ve(de.StorageFailed,t)}}}]),e})();Ie._transient=void 0,Ie._transientWithGlobalFallback=void 0;var Ae,Te,ke="";function Fe(e){"test"===window.webPlayerServerConfig.Environment&&console.log(e),Oe(e,"INFO")}function Ee(e){"test"===window.webPlayerServerConfig.Environment&&console.warn(e),Oe(e,"WARN")}function Oe(e,t){ke="".concat(ke,"[").concat(t,"] [").concat((new Date).toISOString(),"] ").concat(e,"\n")}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e){var t,n=xe(e)+"=",r=(function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}})(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}})(document.cookie.split(";"));try{for(r.s();!(t=r.n()).done;){var o=t.value;if(0===(o=o.trim()).indexOf(n))return decodeURIComponent(o.substr(n.length))}}catch(e){r.e(e)}finally{r.f()}return""}function Be(e,t,n){var r=new Date;r.setTime(r.getTime()+1e3*n);var o=ScriptLoader.allowSameSiteNone()?";samesite=none":"";document.cookie="".concat(xe(e),"=").concat(encodeURIComponent(t),";path=/;expires=").concat(r.toUTCString()).concat(o,";secure")}function xe(e){return window.location.hostname+"."+e}function je(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(a)console.warn("Reload WebPlayer requested from ".concat(r));else{var s={sessionId:i||"Unknown",eventName:"WebPlayer Reload",message:"Reload requested from ".concat(r),data:"",error:""};p(s),console.error("Reload WebPlayer requested from ".concat(r))}o?null==n||null===(e=n.location)||void 0===e||e.replace(o):null==n||null===(t=n.location)||void 0===t||t.reload()}function Re(){if(!window.webPlayerServerConfig)return!1;var e=window.location.search;return!!(e&&(e=e.toLowerCase()).indexOf("sdkversion")>=0)}function De(e,t,n,r){var o;try{var i;if(Re()&&window.parent)window.parent.postMessage({api:3},"*");else if(0===(null===(i=window.webPlayerServerConfig)||void 0===i?void 0:i.HostMode)){var a={messageType:"sendError",sharedAppHostError:{code:e,message:t}};window.parent.postMessage(a,"*")}}catch(e){!(function(e,t){var n,r;p({sessionId:null!==(n=Core)&&void 0!==n&&null!==(r=n.Telemetry)&&void 0!==r&&r.Log?Core.Telemetry.Log.sessionId:"Unknown",eventName:"Utilities.goToErrorPage",message:t,data:"",error:""})})(0,"Unable to post app failed event to Web Player SDK: "+e)}var s="".concat(window.location.protocol,"//").concat(window.location.host,"/error/").concat(e);null===(o=window.Utilities)||void 0===o||o.reloadWindowWithLogging(window,"Utilities._goToErrorPage",s)}function qe(e){switch(e){case at.GccModerate:return"https://gov.service.powerapps.us/";case at.GccHigh:return"https://high.service.powerapps.us/";case at.DoD:return"https://api.apps.appsplatform.us/";case at.Mooncake:return"https://service.powerapps.cn/";case at.Ex:return"https://service.powerapps.eaglex.ic.gov/";case at.Rx:return"https://service.powerapps.microsoft.scloud/";default:return"https://service.powerapps.com/"}}function He(e){switch(e){case at.GccModerate:return"https://power-apis-usgov001-public.azure-apihub.us";case at.GccHigh:return"https://power-apis-usgov001-sovereign.azure-apihub.us";case at.DoD:return"https://power-apis-usdod-001.azure-apihub.us";case at.Mooncake:return"https://china.azure-apihub.cn/";case at.Ex:return"https://azure-apihub.eaglex.ic.gov";case at.Rx:return"https://azure-apihub.microsoft.scloud";default:return"https://apihub.azure.com"}}function We(e,t,n,r){var o;Ee("Login failed: "+de[e]+": "+t);try{var i;if(Re()&&window.parent)window.parent.postMessage({api:3},"*");else if(0===(null===(i=window.webPlayerServerConfig)||void 0===i?void 0:i.HostMode)){var a={messageType:"sendError",sharedAppHostError:{code:de[e],message:t}};window.parent.postMessage(a,"*")}}catch(e){Ee("Unable to post app failed event to Web Player SDK: "+e)}try{!(function(e,t){Ie.transient.setItem("AuthBootstrap.Error",e),Ie.transient.setItem("AuthBootstrap.ErrorDescription",t)})(de[e],t)}catch(e){Ee("Unable to store error details into storage: "+e)}var s=encodeURIComponent(de[e]),c=200-" [truncated]".length,l=(t=t||"").length<=c?t:t.substr(0,c)+" [truncated]",u=encodeURIComponent(l),p=encodeURIComponent(n||""),d=encodeURIComponent(r||""),f="".concat(window.location.protocol,"//").concat(window.location.host,"/auth/error?errorKind=").concat(s,"&errorDescription=").concat(u,"&oid=").concat(p,"&tid=").concat(d);null===(o=window.Utilities)||void 0===o||o.reloadWindowWithLogging(window,"AuthBootstap.Utilities._goToErrorPage",f)}function Ue(e){if(!e)return!1;var t=!1;try{e.setItem("__storageTest","__storageTest"),t="__storageTest"===e.getItem("__storageTest"),e.removeItem("__storageTest")}catch(e){}return t}function Ne(){var e,t;return null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.TenantId}function Ve(e,t){var n={message:"Failed to load ".concat(e),tid:Ne()};t&&Object.getOwnPropertyNames(t).forEach((function(e){n["error_".concat(e)]=t[e]})),ze(n)}function ze(e){try{var t="https://".concat(window.location.host,"/log/error"),n=new FormData;Object.getOwnPropertyNames(e).forEach((function(t){n.append(t,e[t].toString())}));var r=new XMLHttpRequest;r.open("POST",t),r.setRequestHeader("x-ms-client-session-id","webplayer-"+Date.now()),r.setRequestHeader("x-ms-user-agent"," PowerApps (Web; Player)"),r.setRequestHeader("x-ms-client-request-id","webplayer-logerror-"+Date.now()),r.send(n)}catch(e){console.log("Failed to Log Error to Server.")}}function Ge(e){return e&&e.indexOf("access_token=")>=0?"":e}function Je(){var e=(new Date).getTime();Ie.transient.setItem("AuthBootstrap.AfterAadLoginTimestamp",e.toString())}function Ke(){var e,t,n=null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.AadClientId;if(!n)throw new ve(de.BadConfig,"Missing AAD ClientId.");return n}function Xe(){var e,t,n="https://login.microsoftonline.com/";return null!==(e=window.webPlayerServerConfig)&&void 0!==e&&null!==(t=e.AuthConfig)&&void 0!==t&&t.AadInstance&&(n=window.webPlayerServerConfig.AuthConfig.AadInstance),n}function Qe(){return{clientId:Ke(),redirectUri:"".concat(window.location.protocol,"//").concat(window.location.host,"/auth/authframe"),instance:Xe(),tenant:Ne(),expireOffsetSeconds:600,cacheLocation:"localStorage",loadFrameTimeout:15e3,displayCall:function(e){return (function(e){if(!e)throw new ve(de.Assertion,"Navigation target must be specified");Fe("Navigating to: "+e);try{var t;null===(t=window.Utilities)||void 0===t||t.reloadWindowWithLogging(window,"AdalBootstrap._navigateToAad",e)}catch(e){throw new ve(de.UserInterventionNeeded_NavigateToAadDenied,"Unable to navigate to AAD for login. This can happen in IE and Microsoft Edge if Trust Zones are misconfigured.")}})(e)}}}function Ze(){var e,t,n;return!(function(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0})()&&"MSAL"===(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t||null===(n=t.AuthLibraryConfig)||void 0===n?void 0:n.AuthLibrary)}function $e(){return!Ze()}function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tt(r.key),r)}}function tt(e){var t=(function(e,t){if("object"!==Ye(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==Ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)})(e,"string");return"symbol"===Ye(t)?t:String(t)}function nt(){if(I()){var e,t,n=[qe(yt()),He(yt())];null!==(e=window.webPlayerServerConfig)&&void 0!==e&&null!==(t=e.PublishedAppConfig)&&void 0!==t&&t.CdsOrgUrl&&n.push(window.webPlayerServerConfig.PublishedAppConfig.CdsOrgUrl),n.forEach((function(e){Msal.acquireTokenAsync(e).catch((function(t){d.instance.trackErrorEvent("MsalBootstrap.preloadTokens",{message:"Msal Failed to pre-fetch token with resource: ".concat(e),error:t,region:yt()})}))}))}}function rt(){try{Ie.transientWithGlobalFallback.removeItem("Msal.LoginNumAttempts")}catch(e){}}function ot(e){Ie.transientWithGlobalFallback.setItem("Msal.LoginNumAttempts",e.toString())}function it(){try{localStorage.clear()}catch(e){}try{sessionStorage.clear()}catch(e){}}var at,st,ct=(function(){function e(){!(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._telemetryHandler=d.instance}return (function(e,t,n){t&&et(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"trackErrorTrace",value:function(e,t){this._telemetryHandler.trackErrorEvent(e,t)}},{key:"trackEventTrace",value:function(e,t){this._telemetryHandler.trackActivityEvent(e,t)}}]),e})();function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t,n){!(function(){try{ke=Ie.transient.getItem("AuthBootstrap.Logs")||""}catch(e){}})(),Fe("Starting..."),st=t;try{var r;if(Ze()&&Msal.setLogger(new ct),T()||k()||(function(){var e,t;return(null===(e=window.webPlayerServerConfig)||void 0===e||null===(t=e.AuthConfig)||void 0===t?void 0:t.Mode)===S.AuthFlowProxy})()||null!==(r=window.webPlayerServerConfig)&&void 0!==r&&r.IsTeams)return void n();if(!(function(){var e=!1;try{e=navigator.cookieEnabled}catch(e){Ee("Failed check whether cookies are enabled.")}if(!0===e)try{if(document.cookie)return!0;Be("testcookie","1",10);var t=!!Me("testcookie");return (function(e){var t=ScriptLoader.allowSameSiteNone()?";samesite=none;secure":"";document.cookie="".concat(xe("testcookie"),"=;path=/;expires=").concat(new Date(0).toUTCString()).concat(t)})(),t}catch(e){}return!1})())throw new ve(de.UserInterventionNeeded_CookiesBlocked,"Power Apps requires cookies to be enabled. Please enable them in your browser.");var o="";if(function(){try{return Ue(window.sessionStorage)}catch(e){}return!1}()?(function(){try{return Ue(window.localStorage)}catch(e){}return!1})()||(o="localStorage"):o="sessionStorage",o)throw new ve(de.UserInterventionNeeded_StorageBlocked,"Unable to access ".concat(o,". Please ensure your browser is configured to allow storage of local data."));if(Ie.transient.removeItem("AuthBootstrap.Error"),Ie.transient.removeItem("AuthBootstrap.ErrorDescription"),window.parent&&window.parent!==window)return void n();var i=(function(){var e=mt()+1;return (function(e){Ie.transientWithGlobalFallback.setItem("AuthBootstrap.NumAttempts",e.toString())})(e),e})();if(i>10)throw new ve(de.InfiniteLoop,"Infinite loop detected.");$e()?(function(e,t){var n=Ge(window.location.search)+Ge(window.location.hash);Ie.transient.setItem("AuthBootstrap.AadClientId",Ke()),Ie.transient.setItem("AuthBootstrap.TenantId",Ne());var r=Qe();if(Te=new AuthenticationContext(r),window.Logging=window.Logging||{},window.Logging.level=Te.CONSTANTS.LOGGING_LEVEL.INFO,window.Logging.log=function(e){return (function(e){Fe("ADAL log: "+e)})(e)},Te.getCachedUser())return Fe("User is signed in -- continuing normal load sequence"),Je(),void e();var o=!1;!(function(e){var t={};t[e.CONSTANTS.STORAGE.NONCE_IDTOKEN]=!0,t[e.CONSTANTS.STORAGE.STATE_LOGIN]=!0,e._saveItem=function(n,r){return t.hasOwnProperty(n)&&Be(n,r,600),AuthenticationContext.prototype._saveItem.call(e,n,r)},e._getItem=function(n){var r=AuthenticationContext.prototype._getItem.call(e,n);return r||(t.hasOwnProperty(n)&&(r=Me(n))?(AuthenticationContext.prototype._saveItem.call(e,n,r),r):null)}})(Te);var i=window.location.hash;if(Te.isCallback(i)){Fe("Came back from AAD login"),Ae=Te.getRequestInfo(i);var a=Te.getLoginError();if(a||Ae&&Ae.parameters&&Ae.parameters.error&&(a=Ae.parameters.error,Ae.parameters.error_description&&(a=a+", "+Ae.parameters.error_description)),a)throw new ve(de.AadError,"AAD error: "+a);if(n=Ae.extraLoginStateResponse||"",Fe("Found queryAndHash from AAD: ".concat(n)),Ae.stateMatch)Te.saveTokenFromHash(Ae),Te.getCachedUser()&&(Fe("AAD response is good -- user is now signed in"),Je(),o=!0);else if(t>2)throw new ve(de.UserInterventionNeeded_StorageLost,"Transient storage was lost after navigating to AAD login. This can happen in IE and Microsoft Edge if Trust Zones are misconfigured.")}n&&"?"!==n.charAt(0)&&"#"!==n.charAt(0)&&(n="",Ee("Dangerous queryAndHash detected. Ignoring it."));var s=window.location.protocol+"//"+window.location.host+window.location.pathname+n;if(o){if(function(e){delete e._getItem,delete e._saveItem}(Te),window.location.href===s)return Fe("User is signed in and we are already at the right uri."),void e();Fe("User is signed in. Navigating to original uri");try{e()}catch(e){var c;Fe("Exception setting window.location.hash: ".concat(e,". Doing full navigate instead.")),null===(c=window.Utilities)||void 0===c||c.reloadWindowWithLogging(window,"AdalBootstrap.afterLoadedAdal",s)}}else{Fe("User is not signed in. Navigating to AAD"),(function(){var e=(new Date).getTime();Ie.transient.setItem("AuthBootstrap.BeforeAadLoginTimestamp",e.toString())})();var l=s;Te.login(qe(yt()),l)}})(n,i):(function(e){var t,n,r,o=null!==(t=null===(n=window.webPlayerServerConfig)||void 0===n?void 0:n.AuthConfig)&&void 0!==t?t:null,i=null==o?void 0:o.AadClientId,a=null!==(r=null==o?void 0:o.TenantId)&&void 0!==r?r:null,s=null==o?void 0:o.AadInstance;Msal.enableConsoleLogs("test"===window.webPlayerServerConfig.Environment),Msal.init(i,s,a),Msal.getCurrentAccount()?(Fe("User is signed in -- continuing normal load sequence"),nt(),rt(),e()):Msal.loginRedirect((function(){Fe("MSAL login success."),nt(),rt(),e()}),(function(e){var t=(function(){var e=(function(){var e=Ie.transientWithGlobalFallback.getItem("Msal.LoginNumAttempts");return e?+e:0})()+1;return ot(e),e})();if(it(),ot(t),Fe("Msal Failed to login at boot - NumberOfAttempts : "+t),t<2)d.instance.trackErrorEvent("MsalBootstrap.LoginFailed",{message:"Msal Failed to login at boot",error:null==e?void 0:e.message,errorName:null==e?void 0:e.name,region:yt()}),Msal.loginRedirect((function(){}));else if(2===t){Fe("Msal Failed to login-retry at boot - Falling back to Adal"),d.instance.trackErrorEvent("MsalBootstrap.LoginRetryFailed",{message:"Msal Failed to login at boot - Falling back to Adal",error:null==e?void 0:e.message,errorName:null==e?void 0:e.name,region:yt()}),it(),ot(t),Be("PA_AuthLibrary","ADAL",604800);var n=window.location.href,r=new URL(n),o=!1;r.searchParams.forEach((function(e,t){"authlibrary"===t.toLocaleLowerCase()&&(r.searchParams.set(t,"adal"),o=!0)})),o||r.searchParams.set("authlibrary","adal"),window.location.assign(r.toString())}else Fe("Msal Failed with infinite loop - going to error page"),We(de.InfiniteLoop,"Msal login is having infinite loop. This could happen if user has queryParam authLibrary=Msal and fallback is unable to work.")}),qe(yt()))})(n)}catch(e){try{pt()}catch(e){}var a=de.Unknown,s="";try{if(e instanceof ve){var c=e;a=c.error||de.Unknown,s=c.description||""}else e&&(a=de.UnhandledException,"object"===lt(e)&&"function"==typeof(null==e?void 0:e.toString)&&(s=e.toString()))}catch(e){a=de.UnhandledException,s="Error generating error description: '".concat(e,"'.")}Ee("Going to error page: ".concat(de[a],", ").concat(s)),We(a,s)}finally{!(function(){try{Ie.transient.setItem("AuthBootstrap.Logs",ke)}catch(e){}})()}}function pt(){Ie.transientWithGlobalFallback.removeItem("AuthBootstrap.NumAttempts")}function dt(){var e=Ie.transient.getItem("AuthBootstrap.BeforeAadLoginTimestamp");return e?+e:0}function ft(){var e=Ie.transient.getItem("AuthBootstrap.AfterAadLoginTimestamp");return e?+e:0}function mt(){var e=Ie.transientWithGlobalFallback.getItem("AuthBootstrap.NumAttempts");return e?+e:0}function gt(){!(function(){ke="";try{Ie.transient.removeItem("AuthBootstrap.Logs")}catch(e){}})();try{Ie.transient.removeItem("AuthBootstrap.BeforeAadLoginTimestamp"),Ie.transient.removeItem("AuthBootstrap.AfterAadLoginTimestamp"),pt()}catch(e){}W("WebAuthenticationBootstrap.allGoodConfirmed")}function ht(e,t,n){var r;if(null!==(r=window.webPlayerServerConfig)&&void 0!==r&&r.IsMobileServer)n();else{var o=$e()?"openSource/modified/adal/adaljs.js":"js/Msal.Authentication.js";Fe("Loading auth library : "+o);var i={groups:[{id:"webauthentication",contents:[{type:ScriptLoader.ResourceType.JS,src:o,platform:ScriptLoader.Platform.WebPlayer}],postload:function(){ut(e,t,a)}}]};ee(e,i,Ve)}function a(){$e()&&(function(){var e=window.location.hash,t=e.indexOf("postLoginRedirectPage=");if(t>=0){var n=e.substr(t+"postLoginRedirectPage=".length);if(/^\w+\.html$/.test(n))return void window.location.assign(n)}if(I()){var r=new AuthenticationContext(Qe());if(r.getCachedUser()){var o,i,a=[qe(yt()),He(yt())];null!==(o=window.webPlayerServerConfig)&&void 0!==o&&null!==(i=o.PublishedAppConfig)&&void 0!==i&&i.CdsOrgUrl&&a.push(window.webPlayerServerConfig.PublishedAppConfig.CdsOrgUrl),(function(e,t,n){n.forEach((function(n){e.acquireToken(n,(function(e,t){return function(n,r,o){(n||o)&&ze({message:"Failed to pre-fetch token with resource: ".concat(t),errorDesc:n,error:o,region:e})}})(t,n))}))})(r,yt(),a)}}})(),n()}}function vt(){for(var e=window.sessionStorage,t=0,n=e.length;t<n;++t){var r=e.key(t);r&&0===r.indexOf("AuthBootstrap.Logs")&&(e.getItem(r)||"").split("\n").forEach((function(e){for(var t=e.length;t>0;)console.log(e.substr(0,Math.min(1024,t))),e=e.substr(Math.min(1024,t)),t-=Math.min(1024,t)}))}}function yt(){return st}!(function(e){e.GccHigh="gcchigh",e.DoD="dod",e.GccModerate="gccmoderate",e.Int="int",e.Preprod="preprod",e.Prod="prod",e.Test="test",e.Tip2="tip2",e.Mooncake="mooncake",e.Ex="ex",e.Rx="rx"})(at||(at={}));var wt,bt=[{id:"openSource/oss-phase1.js",contents:[{src:"openSource/modified/knockout/knockout.js"},{src:"openSource/unmodified/react/react.min.js"},{src:"openSource/unmodified/react/react-dom.min.js"},{src:"openSource/unmodified/react-transition-group/react-transition-group.min.js"},{src:"openSource/modified/aphrodite/aphrodite.playerandapps.min.js"},{src:"openSource/unmodified/URIjs/URI.js"},{src:"openSource/aliasing/alias.URIjs.js"},{src:"openSource/unmodified/localForage/localforage.min.js"},{src:"openSource/modified/caja/html-sanitizer.js"},{src:"openSource/modified/mousetrap/mousetrap.js"}]},{id:"js/player.js",es6Id:"js/es6.player.js",contents:[{src:"js/Player.WebEnvironment.js"},{src:"js/PowerAppsWebPlayer.Core.js"},{src:"js/Core.Polyfill.js"},{src:"js/PowerAppsWebPlayer.Services.js"},{src:"js/PowerAppsWebPlayer.Data.js"},{src:"js/PowerAppsWebPlayer.Runtime.js"},{src:"js/Player.AppHost.js"},{src:"js/PowerAppsWebPlayer.Runtime.Client.js"},{src:"js/PowerAppsWebPlayer.Authoring.js"},{src:"js/Player.Client-es6.js"},{src:"js/PowerAppsWebPlayer.Common.js"},{src:"js/Core.Debug.js"},{src:"js/PlayerApiHost.js"},{src:"js/Player.Embed.js"},{src:"js/Player.Authentication.js"},{src:"js/PowerAppsServiceWorkerManager.js"},{src:"js/PowerAppsWebPlayer.Client.js"}]},{id:"js/apphost.js",contents:[{src:"openSource/unmodified/URIjs/URI.js"},{src:"openSource/aliasing/alias.URIjs.js"},{src:"openSource/modified/caja/html-sanitizer.js"},{src:"openSource/unmodified/localForage/localforage.min.js"},{src:"js/Core.Polyfill.js"},{src:"js/Player.WebEnvironment.js"},{src:"js/Core.js"},{src:"js/Core.IO.js"},{src:"js/Player.Globalization.js"},{src:"js/PowerAppsWebPlayer.Services.js"},{src:"js/PowerAppsWebPlayer.Data.js"},{src:"js/AppMagic.Runtime.js"},{src:"js/AppMagic.Runtime.App.Host.js"},{src:"js/AppMagic.Runtime.Client.js"},{src:"js/PlayerApiHost.js"},{src:"js/powerapps-player-apphost.js"}]},{id:"js/consent.js",contents:[{src:"js/Player.WebEnvironment.js"},{src:"js/PowerAppsWebPlayer.Core.js"},{src:"js/Core.Polyfill.js"},{src:"js/PowerAppsWebPlayer.Services.js"},{src:"js/PowerAppsWebPlayer.Runtime.js"},{src:"js/PowerAppsWebPlayer.Runtime.Client.js"},{src:"js/PowerAppsWebPlayer.Authoring.js"},{src:"js/Player.AppHost.js"},{src:"js/Player.Client-es6.js"},{src:"js/PowerAppsWebPlayer.Common.js"},{src:"js/Core.Debug.js"},{src:"js/PlayerApiHost.js"},{src:"js/Player.Embed.js"},{src:"js/Player.Authentication.js"},{src:"js/PowerAppsWebPlayer.Client.js"}]},{id:"openSource/oss-phase2.js",contents:[{src:"openSource/unmodified/tether/tether.min.js"},{src:"openSource/modified/drop/drop.min.js"},{src:"js/screenorientation.browser.js"},{src:"openSource/modified/zepto/zepto.min.js"},{src:"openSource/unmodified/velocity/velocity-1.2.2.min.js"},{src:"openSource/modified/toastr/toastr.min.js"},{src:"openSource/modified/AzureFootprint/powerappsfpv2.min.js"}]},{id:"iframeCordovaResources/cordova.js",contents:[{src:"openSource/modified/cordova/cordova.iframe.js"},{src:"iframeCordovaResources/cordova_plugins.js"},{src:"iframeCordovaResources/plugins/com.microsoft.plugins.versionsupport/www/VersionSupportPlugin.js"},{src:"openSource/modified/iframePlugins/cordova-plugin-network-information/www/network.js"},{src:"openSource/modified/iframePlugins/cordova-plugin-network-information/www/Connection.js"},{src:"openSource/modified/iframePlugins/cordova-plugin-device-motion/www/Acceleration.js"},{src:"openSource/modified/iframePlugins/cordova-plugin-device-motion/www/accelerometer.js"}]},{id:"js/WebPlayer.LoaderWithCordova.js",contents:[{src:"iframeCordovaResources/cordova.js"},{src:"js/WebPlayer.Loader.js"}]},{id:"js/WebPlayer.SdkWithOrchestrator.js",contents:[{src:"js/WebPlayerSDKOrchestrator.js"},{src:"js/WebPlayer.SDK.js"}]},{id:"js/WebPlayer.SdkWithOrchestrator.umd.js",contents:[{src:"js/WebPlayerSDKOrchestrator.js"},{src:"js/WebPlayer.SDK.umd.js"}]},{id:"js/player-loader.js",contents:[{src:"openSource/unmodified/microsoftteams/MicrosoftTeams.js"},{src:"openSource/modified/winjs/js/base.host.js"},{src:"js/Player.Embed.js"},{src:"js/Player.AppLoader.Dependencies.js"},{src:"js/Player.Types.js"},{src:"js/Player.AppLoader.js"}]},{id:"js/player-boot.js",es6Id:"js/es6.player-boot.js",contents:[{src:"js/Player.AppLoader.Dependencies.js"},{src:"js/PowerAppsAuthFlowSdk.js"},{src:"js/Msal.Authentication.js"},{src:"js/WebPlayer.Host.js"}]},{id:"js/player-boot-teams.js",es6Id:"js/es6.player-boot-teams.js",contents:[{src:"js/Player.AppLoader.Dependencies.js"},{src:"js/PowerAppsAuthFlowSdk.js"},{src:"js/Msal.Authentication.js"},{src:"js/WebPlayer.Host.Teams.js"}]},{id:"js/standalone-apphost.js",es6Id:"js/standalone-apphost.js",contents:[{src:"js/Player.AppLoader.Dependencies.js"},{src:"js/PowerAppsAuthFlowSdk.js"},{src:"js/Player.StandaloneAppHost.js"}]},{id:"js/player-shell.js",es6Id:"js/es6.player-shell.js",contents:[{src:"js/PowerAppsServiceWorkerManager.js"},{src:"js/WebPlayer.Host.UI.js"}]}];!(function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Skipped=2]="Skipped",e[e.Loaded=3]="Loaded",e[e.Failed=4]="Failed"})(wt||(wt={}));var Ct=Promise.resolve();function _t(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(o.isTeamsDesktop)();try{if(window.webPlayerServerConfig){var r,i,a,s,c,l,u,p=window.webPlayerServerConfig,f=p&&(null===(r=p.PublishedAppConfig)||void 0===r?void 0:r.IndexWebHtmlUrl)&&(null===(i=p.PublishedAppConfig)||void 0===i?void 0:i.AppPackageResourcesKind)&&p.AppId&&(null===(a=p.CdnConfig)||void 0===a?void 0:a.CdnUrl)&&(null===(s=p.FeatureGates)||void 0===s?void 0:s.InvertedLoad)&&!(null!==(c=p.FeatureGates)&&void 0!==c&&c.UseModernApp&&null!==(l=p.PublishedAppConfig)&&void 0!==l&&l.ModernAppUrl);if(n&&e&&f&&p.AppPreviewFlags&&p.AppPreviewFlags.usenonblockingonstartrule&&!p.BlockStartRule&&p.FallbackSwitch&&window.location.href.toLowerCase().indexOf("skipmetadata=true")<0)return Ct=e,d.instance.trackActivityEvent("InvertedLoader.waitForPublishedAppLoaded"),void St(t);d.instance.trackActivityEvent("InvertedLoader.skip",{configUsableForMetadataLoad:f,hasFallbackSwitch:!!p.FallbackSwitch,hasUseNonBlockingOnStartRule:null===(u=p.AppPreviewFlags)||void 0===u?void 0:u.usenonblockingonstartrule,hasBlockStartRule:p.BlockStartRule}),delete window.invertedLoad}}catch(e){d.instance.trackErrorEvent("InvertedLoader.waitForPublishedAppLoadedIfSupportedError",e)}t()}function St(e){var t,n=window.webPlayerServerConfig,r="";if(null!==(t=n.PublishedAppConfig)&&void 0!==t&&t.PublishedAppUrl)try{var o,i=new URL(null===(o=n.PublishedAppConfig)||void 0===o?void 0:o.PublishedAppUrl);r=i.origin}catch(e){}if(r){var a=-1,s=0,c=function(){d.instance.trackActivityEvent("InvertedLoader.processMessageHoldingQueueTimeout"),window.onMessageHoldingQueueChanged=void 0,e()},l=function(){try{if(window.messageHoldingQueue){-1!==a&&clearTimeout(a),a=setTimeout(c,2e3);for(var t=!1;s<window.messageHoldingQueue.length;s++){var n=window.messageHoldingQueue[s];switch(It(n,r)){case wt.Unhandled:d.instance.trackActivityEvent("InvertedLoader.unhandledMessage",{unhandledMessage:JSON.stringify(n.data)});case wt.Failed:case wt.Loaded:t=!0;break;case wt.Handled:window.messageHoldingQueue.splice(s,1),s--;continue;case wt.Skipped:default:continue}if(t)break}if(!t)return}}catch(e){d.instance.trackErrorEvent("InvertedLoader.processMessageHoldingQueueError",e)}window.onMessageHoldingQueueChanged=void 0,clearTimeout(a),e()};window.onMessageHoldingQueueChanged=l,l()}else e()}function Pt(){return Ct.then((function(){var e,t,n,r=document.getElementById("loading-spinner");r&&document.body.removeChild(r);var o=document.getElementById("screenLoadingPlaceholder");o&&document.body.removeChild(o),null===(e=window.performance)||void 0===e||e.mark("webPlayerTeamsNotifyAppInitializationLoaded"),microsoftTeams.appInitialization.notifyAppLoaded(),null===(t=window.performance)||void 0===t||t.mark("webPlayerTeamsNotifyAppInitializationSuccess"),microsoftTeams.appInitialization.notifySuccess(),null===(n=window.performance)||void 0===n||n.mark("webPlayerInvertedLoad"),window.invertedLoad=!0})),wt.Loaded}function It(e,t){var n,r,o;if(null!==(n=e.data)&&void 0!==n&&n.command){if("onNavigatedToFirstScreen"===e.data.command)switch(e.data.result){case"success":return d.instance.trackActivityEvent("InvertedLoader.onNavigatedToFirstScreen"),Pt();default:return d.instance.trackActivityEvent("InvertedLoader.onNavigatedToFirstScreenFailed",{result:e.data.result}),wt.Failed}return wt.Skipped}if(null===(r=e.data)||void 0===r||!r.service||null===(o=e.data)||void 0===o||!o.action)return wt.Unhandled;var i=e.data,a=i.service,s=i.action,c=i.actionArgs;if("PublishedAppTelemetry"===a&&("trackEvent"===s||"trackError"===s)&&c&&2===c.length&&c[1]){var l,u=null!==(l=c[1].customDimensions)&&void 0!==l?l:{};u.appTimestamp||(u.appTimestamp=performance.now(),c[1].customDimensions=u)}if("AppLifecycle"===a&&"notifyAppLoaded"===s)return d.instance.trackActivityEvent("InvertedLoader.notifyAppLoaded"),Pt();if("AppLifecycle"===a&&"notifyAppFailed"===s)return d.instance.trackActivityEvent("InvertedLoader.notifyAppFailed"),wt.Failed;if("AppPowerAppsClientPlugin"===a&&("loadAppConnectionsAsync_v2"===s||"loadNonCompositeConnectionsAsync"===s))return d.instance.trackActivityEvent("InvertedLoader.".concat(s)),Pt();if("EcsFeaturesPlugin"===a&&"getActivatedFallbackSwitchesAsync"===s)return (function(e,t){return (function(e,t,n){e.source.postMessage({isPluginCall:!0,callbackId:e.data.callbackId,status:1,args:t,keepCallback:!1},n)})(e,[window.webPlayerServerConfig.FallbackSwitch],t),wt.Handled})(e,t);if("AppHttpClientPlugin"===a&&("getArrayBufferAsTransferable"===s||"setTransferableSupport"===s))return wt.Skipped;if("AppHostPlugin"===a&&"executeAppToHostCommand"===s){if(c&&c.length>0&&c[0])switch(c[0].fullName){case"refreshDataSourcesAfterRefreshingConnections":return wt.Failed;case"telemetry.sendEvent":return wt.Skipped}return d.instance.trackActivityEvent("InvertedLoader.unhandledCommand",{unhandledCommand:c[0].fullName}),wt.Unhandled}return["Accelerometer","AppDependenciesResolver","AppIdentityServicePlugin","AppLifecycle","NetworkStatus","PublishedAppTelemetry","TeamsHostClientTypePlugin"].find((function(e){return e===a}))?wt.Skipped:wt.Unhandled}var At,Tt=n(1),kt=n(2);function Ft(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(function(e,t){if(e){if("string"==typeof e)return Et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Et(e,t):void 0}})(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}null===(At=window.performance)||void 0===At||At.mark("webPlayerLoader");var Ot=d.instance.startScenario("PlayerLifecycle.WebPlayer.Play.Boot",{operationName:"PlayerLifecycle.WebPlayer.Play.Boot"});function Lt(){return 0===window.webPlayerServerConfig.HostMode}var Mt=!1;function Bt(e){var t,n=Ft(e);try{var r=function(){var e=t.value;if(bt.forEach((function(t){if(t.id===e.id){var n=[{type:ScriptLoader.ResourceType.JS,src:t.id}];return t.es6Id&&n.push({type:ScriptLoader.ResourceType.JS,src:t.es6Id}),void(e.contents=n)}})),window.HostResourcesHashPaths&&!e.skipMapping){var n,r=Ft(e.contents);try{for(r.s();!(n=r.n()).done;){var o=n.value;window.HostResourcesHashPaths[o.src]?o.src="hashedresources/".concat(window.HostResourcesHashPaths[o.src],"/").concat(o.src):o.disabled=!0}}catch(e){r.e(e)}finally{r.f()}}};for(n.s();!(t=n.n()).done;)r()}catch(e){n.e(e)}finally{n.f()}return e}function xt(){return window.preloadResourcesOnly||-1!==window.location.href.split("?")[0].toLowerCase().indexOf("/sdkpreload")}function jt(){return window.webPlayerServerConfig&&window.webPlayerServerConfig.IsTeams}B((function(e){for(var t=["script error","script error."],n=0;n<t.length;n++)if(e.message.toLocaleLowerCase()===t[n])return;var r=window.Core;if(r&&r.Telemetry&&r.Telemetry.Log){var i="unavailable";e&&e.error&&e.error.stack&&(i=e.error.stack),r.Telemetry.Log.trackErrorEvent("WebPlayerAppLoader:UnhandledError",{errorMessage:e.message,error:e.error,source:e.filename,lineno:e.lineno,colno:e.colno,stackTrace:i,href:Object(o.scrubSensitiveDataSafe)(window.location.href)}),r.Telemetry.Log.flush()}!Mt&&Lt()&&window.parent.postMessage({messageType:"sendError",sharedAppHostError:{source:"sharedAppHost",code:"unknown",message:e.message}},"*"),p({sessionId:r&&r.Telemetry&&r.Telemetry.Log?r.Telemetry.Log.sessionId:"Unknown",eventName:"WebPlayerAppLoader:UnhandledError",message:e.message,data:JSON.stringify({webPlayerUrl:Object(o.scrubSensitiveDataSafe)(window.location.href)}),error:e.error})}));var Rt,Dt=new fe(window.webPlayerServerConfig.AuthConfig.OnBehalfOfResource),qt=jt()?new o.TeamsParentAccessTokenRetriever(d.instance):new o.ParentAccessTokenRetriever(void 0,d.instance),Ht=new M(qt,(function(){return new XMLHttpRequest}),Dt),Wt=function(){var e,t=[{id:"openSource/oss-phase1.js",phase:j.NonUIPhase,postload:function(){window.ko&&window.ko.options&&(window.ko.options.useOnlyNativeEvents=!0)},contents:[]},{id:"ApplicationInsights",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"openSource/modified/appInsights/ai.0.js",disabled:!0}]},{id:"msr-crypto",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"openSource/modified/msrCrypto/msrcrypto.aes.js"}],postload:function(e,t){msrCrypto.url=t}},{id:"css/fonts.css",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.CSS,src:"css/fonts.css",os:ScriptLoader.OperatingSystem.NonWindows}]},{id:"css/webplayer.css",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.CSS,src:"css/webplayer.css"}]},{id:"ms-embedding-dependencies",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"openSource/unmodified/d365/d365shell-2.4.7.js"},{type:ScriptLoader.ResourceType.JS,src:"js/PowerAppsAuthFlowSdk.js"}]},{id:"ms-connection-dialog-dependencies",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"js/Player.Consent.js",disabled:!(null!==(e=window.webPlayerServerConfig.FeatureGates)&&void 0!==e&&e.UsePPUXConsentDialogService)}]},{id:window.webPlayerServerConfig.IsConsentOnly?"js/consent.js":"js/player.js",phase:j.NonUIPhase,postload:function(){var e;if(d.instance.endScenario(Ot,Tt.ScenarioResult.Success),!(window.isWebPlayerBVT||xt()||null!==(e=window.webPlayerServerConfig.FeatureGates)&&void 0!==e&&e.SharedAppHostStandAlone)){var t=window.AppMagic.Runtime;window.webPlayerServerConfig.IsConsentOnly?t.StandaloneConsentRuntime.getInstance().startAsync():(function(){var e;return!0===(null===(e=window.webPlayerServerConfig)||void 0===e?void 0:e.IsTrustedUCI)})()?t.TrustedUCIRuntime.getInstance().startAsync():Lt()?t.AppHostRuntime.getInstance().startAsync():t.WebPlayerRuntime.startAsync(),Dt.notifyWebplayerRuntimeLoaded(),d.instance.reportCoreLoaded(),(function(){if(!Lt()){var e=new RegExp("PAWebPlayerReloadCount=([0-9]*)");try{var t,n=new Core.Url(window.location.href),r=Core.Url.decode(n.fragment),o=null===(t=window.performance)||void 0===t?void 0:t.getEntriesByType("navigation"),i=(null==o?void 0:o.length)>0?o[0]:null;if("reload"===(null==i?void 0:i.type)){var a=e.exec(r),s=parseInt(a?a[1]:"0",10);if(++s>=10)d.instance.trackActivityEvent("PlayerConfig._trackIfWindowReloaded.infiniteReloads",{reloadCount:s}),De(500,"Infinite Reloads");else{d.instance.trackActivityEvent("PlayerConfig._trackIfWindowReloaded.startingSessionFromReload",{reloadCount:s});var c="PAWebPlayerReloadCount="+s;if(1===s)r=r+(r.length>0?"&":"")+c;else r=r.replace(e,c);window.location.hash=Core.Url.encode(r)}}}catch(e){d.instance.trackActivityEvent("PlayerConfig._trackIfWindowReloaded.failedToTrackReloads")}}})()}Mt=!0},contents:[]},{id:"openSource/oss-phase2.js",phase:j.UIPhase,contents:[]},{id:"bvt",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"js/testAppHostStartup.js",disabled:!window.isWebPlayerBVT}],postload:function(){window.jQuery&&!window.Velocity&&(window.Velocity=window.jQuery.Velocity)}}];if(xt()){t.push({id:"js/WebPlayerSdkOrchestrator.js",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"js/WebPlayerSdkOrchestrator.js"}]});var n=new RegExp("apps(.[a-z0-9_]+)?.powerapps.(com|us|cn|eaglex.ic.gov|microsoft.scloud)","i"),r=new RegExp("play.apps.appsplatform.us","i"),o="".concat(window.location.host);n.test(o)||r.test(o)?t.push({id:"sdk/metadata",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"metadata"}],skipMapping:!0}):t.push({id:"SDKMetadata",phase:j.NonUIPhase,contents:[{type:ScriptLoader.ResourceType.JS,src:"SDKMetadata"}],skipMapping:!0})}return{groups:Bt(t)}},Ut=function(e,t){var n=window.Core,r=t?t.toString():"",i=Object(o.scrubSensitiveDataSafe)(e),a=Object(o.scrubSensitiveDataSafe)(window.location.href);n&&n.Telemetry&&n.Telemetry.Log&&(n.Telemetry.Log.trackErrorEvent("WebPlayerAppLoader:ErrorLoadingHostScript",{script:i,href:a}),n.Telemetry.Log.flush()),p({sessionId:n&&n.Telemetry&&n.Telemetry.Log?n.Telemetry.Log.sessionId:"Unknown",eventName:"WebPlayerAppLoader:ErrorLoadingHostScript",message:"Error loading ".concat(i),data:JSON.stringify({webPlayerUrl:a}),error:r})},Nt=ScriptLoader.Platform.WebPlayer;function Vt(e){var t=Wt().groups.filter((function(t){return t.phase===e}));if(xt())Y(Nt,{groups:t});else if(window.webPlayerLoadStartDateTime=Date.now(),!window.isWebPlayerBVT&&window.webPlayerServerConfig.AuthConfig.UseClientSideAuth&&e===j.NonUIPhase){var n=window.webPlayerServerConfig.Environment;"local"!==n&&"tip1"!==n||(n="test"),"msinternal"===n&&(n="prod"),ht(Nt,n,(function(){ee(Nt,{groups:t},Ut),d.instance.trackActivityEvent("PlayerLifecycle.WebPlayer.Play.Boot.Login")}))}else ee(Nt,{groups:t},Ut)}function zt(e){var t=new URL(e),n=t.pathname.split("/").slice(0,-1).join("/"),r=window.webPlayerServerConfig.CdnConfig;r&&(r.CdnUrl=Gt(t.hostname,t.port,n,r.CdnUrl),r.StaticContentFallbackUrl=Gt(t.hostname,t.port,n,r.StaticContentFallbackUrl),r.StaticContentPathFormat=Gt(t.hostname,t.port,n,r.StaticContentPathFormat))}function Gt(e,t,n,r){if(r){var o=new URL(r);return o.hostname=e,o.port=t,o.pathname=n+o.pathname,decodeURIComponent(o.href)}return r}function Jt(e,t){var n=new kt.PowerPlatformApiDiscovery(e);return"https://".concat(n.getEnvironmentEndpoint(t))}window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),Lt()&&(window.webPlayerServerConfig.ServiceConfigs={DisableNpsService:!0},location.href.toLowerCase().indexOf("://localhost")>0&&(window.webPlayerServerConfig.ServiceConfigs.DisableAzureFootprint=!0,window.webPlayerServerConfig.IsMobileServer=!0,zt(location.href),(function(e){var t,n=null!==(t=new URLSearchParams(e).get("locale"))&&void 0!==t?t:"en-US";window.supportedLanguages&&-1===window.supportedLanguages.indexOf(n)&&(n="en-US"),window.webPlayerLocalization={language:n}})(window.location.search))),window.isWebPlayerBVT||window.addEventListener("message",(function e(t){t.origin.toLowerCase()===window.location.origin.toLowerCase()&&"apploaderResume"===t.data.messageType&&!0===t.data.success&&(window.removeEventListener("message",e),Vt(j.UIPhase))})),xt()||(jt()&&(Rt=new Promise((function(e){microsoftTeams.initialize((function(){e()}))}))),Ht.start(),(function(){try{var e,t;if(!window.webPlayerServerConfig||!window.webPlayerServerConfig.Environment)return;if(null!==(e=window.webPlayerServerConfig.FeatureGates)&&void 0!==e&&e.UsePowerPlatformAPI&&window.webPlayerServerConfig.AppEnvironmentId){if("test"===window.webPlayerServerConfig.Environment){var n="test";window.webPlayerServerConfig.FeatureGates.ForceTip2InTest||(n="preprod"),t="".concat(Jt(n,window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster")}else if("preprod"===window.webPlayerServerConfig.Environment)t="".concat(Jt("preprod",window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster");else if("prod"===window.webPlayerServerConfig.Environment)t="".concat(Jt("prod",window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster");else if("gccmoderate"===window.webPlayerServerConfig.Environment)t="".concat(Jt("gov",window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster");else if("gcchigh"===window.webPlayerServerConfig.Environment)t="".concat(Jt("high",window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster");else{if("dod"!==window.webPlayerServerConfig.Environment)return;t="".concat(Jt("dod",window.webPlayerServerConfig.AppEnvironmentId),"/gateway/cluster")}t="".concat(t,"?api-version=1");var r=new XMLHttpRequest;r.open("GET",t),r.setRequestHeader("Cache-Control","no-cache, no-store"),r.onload=function(){if(200===r.status){if(function(){switch(window.webPlayerServerConfig.Environment){case"gccmoderate":case"gcchigh":case"dod":case"mooncake":case"rx":case"ex":return!0;default:return!1}}())return;var e=JSON.parse(r.responseText);if(e&&e.geoLongName){if(window.webPlayerServerConfig.TelemetryConfig&&window.webPlayerServerConfig.TelemetryConfig.GeoLocation!==e.geoLongName){window.webPlayerServerConfig.TelemetryConfig.GeoLocation=e.geoLongName;var t=window.Core;t&&t.Telemetry&&t.Telemetry.Log&&t.Telemetry.Log.providerInstance.setDefaultProperties({geoLocation:e.geoLongName})}var n="";if(location.href.indexOf("/play/e/".concat(window.webPlayerServerConfig.AppEnvironmentId,"/"))>0?n="/play/e/".concat(window.webPlayerServerConfig.AppEnvironmentId,"/"):location.href.indexOf("/apphost/e/".concat(window.webPlayerServerConfig.AppEnvironmentId,"/"))>0&&(n="/apphost/e/".concat(window.webPlayerServerConfig.AppEnvironmentId,"/")),!n)return;for(var o="PA_GeoRegion_".concat(window.webPlayerServerConfig.AppEnvironmentId),i=document.cookie.split(";"),a="",s=0;s<i.length;s++)if(i[s].indexOf(o)>=0){a=i[s];break}if(a&&a.split("=")[1]!==e.geoLongName){var c=new Date;c.setDate(c.getDate()+30),a="".concat(o,"=").concat(e.geoLongName,";path=").concat(n,";expires=").concat(c.toUTCString(),";"),document.cookie=a}}}},r.send()}else{var o;if(null!==(o=window.webPlayerServerConfig.PublishedAppConfig)&&void 0!==o&&o.AppRuntimeEndpoint)t="".concat(window.webPlayerServerConfig.PublishedAppConfig.AppRuntimeEndpoint,"/api/invoke");else if("test"===window.webPlayerServerConfig.Environment){var i;t=null!==(i=window.webPlayerServerConfig.FeatureGates)&&void 0!==i&&i.ForceTip2InTest?"https://tip2.api.powerapps.com/api/invoke":"https://tip1.api.powerapps.com/api/invoke"}else if("tip2"===window.webPlayerServerConfig.Environment)t="https://tip2.api.powerapps.com/api/invoke";else if("prod"===window.webPlayerServerConfig.Environment)t="https://api.powerapps.com/api/invoke";else if("gccmoderate"===window.webPlayerServerConfig.Environment)t="https://gov.api.powerapps.us/api/invoke";else if("gcchigh"===window.webPlayerServerConfig.Environment)t="https://high.api.powerapps.us/api/invoke";else{if("dod"!==window.webPlayerServerConfig.Environment)return;t="https://api.apps.appsplatform.us/api/invoke"}var a=new XMLHttpRequest;a.open("POST",t),a.setRequestHeader("Cache-Control","no-cache, no-store"),a.setRequestHeader("Authorization","bearer"),a.setRequestHeader("x-ms-client-session-id","webplayer-"+Date.now()),a.setRequestHeader("x-ms-user-agent"," PowerApps (Web; Player)"),a.setRequestHeader("x-ms-path-query","/healthcheck/compute"),a.setRequestHeader("x-ms-client-request-id","webplayer-preload-"+Date.now()),a.send()}}catch(e){console.log("Failed to preload RP call.")}})()),_t(Rt,(function(){Vt(j.NonUIPhase),window.isWebPlayerBVT&&Vt(j.UIPhase)})),window.WebAuthenticationBootstrap={getBeforeLoginTimestamp:dt,getAfterLoginTimestamp:ft,getNumAttempts:mt,allGoodConfirmed:gt,dumpLogsToConsole:vt},window.ResourceLoader={mapResourceUrl:X},window.Utilities={reloadWindowWithLogging:je},window.AuthLibrary={useMSALAuthLibrary:Ze,useADALAuthLibrary:$e},window.WebPlayerAppLoader={getWebPlayerConfig:Wt,getAppLoaderTelemetryInstance:y},window.PerfProfiler={startMarker:H,setGlobalMarker:W,endMarker:U}})]);
//# sourceMappingURL=player-loader.js.map