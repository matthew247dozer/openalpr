"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var ScriptLoader;!(function(e){var t,n;!(function(e){e[e.JS=0]="JS",e[e.CSS=1]="CSS"})(n=e.ResourceType||(e.ResourceType={})),(function(e){e[e.All=1]="All",e[e.Desktop=2]="Desktop",e[e.Web=3]="Web",e[e.WebPlayer=4]="WebPlayer"})(e.Platform||(e.Platform={})),(function(e){e[e.All=1]="All",e[e.Windows=2]="Windows",e[e.NonWindows=3]="NonWindows"})(e.OperatingSystem||(e.OperatingSystem={}));var a=(function(){function e(){}return Object.defineProperty(e,"_cdnConfig",{get:function(){return window.webPlayerServerConfig&&window.webPlayerServerConfig.CdnConfig||{}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_useStaticContentFallback",{get:function(){if(!1===e._haveEvaluatedCookie){e._haveEvaluatedCookie=!0;try{e._useFallbackVal=document.cookie.split(";").filter((function(e){return-1!==e.trim().indexOf(window.staticContentFallBackKey+"=")})).length>0}catch(t){e._useFallbackVal=!1}}return e._useFallbackVal},enumerable:!1,configurable:!0}),e.mapResourceUrl=function(t,n){if(e._cdnConfig.StaticContentPathFormat){if(0===n.indexOf("hashedresources"))return e._staticContentFallbackEnabled&&e._useStaticContentFallback?e._cdnConfig.StaticContentFallbackUrl+"/"+n:e._cdnConfig.StaticContentPathFormat.replace("{0}",n);if(window.HostResourcesHashPaths&&window.HostResourcesHashPaths[n]){var a="hashedresources/"+window.HostResourcesHashPaths[n]+"/"+n;return e._staticContentFallbackEnabled&&e._useStaticContentFallback?e._cdnConfig.StaticContentFallbackUrl+"/"+a:e._cdnConfig.StaticContentPathFormat.replace("{0}",a)}}return e._fallbackToHost(t,n)},e._fallbackToHost=function(e,t){var n=e.createElement("link");n.href=t;var a=n.href.toLowerCase();if(a.indexOf("/teams/")>-1)return a.split("/teams/")[0]+"/webplayer/"+t;if(window.location.href.indexOf("/sdk/authoringmetadata")>-1)return a.split("/sdk/")[0]+"/webplayer/"+t;var o=a;if(a.indexOf("play/")>-1&&(o=a.split("play/")[0]+t),a.indexOf("consent/")>-1&&(o=a.split("consent/")[0]+t),a.indexOf("apphost/")>-1&&(o=a.split("apphost/")[0]+t),(o=o.toLowerCase().replace("providers/microsoft.powerapps/apps/","")).indexOf("webplayer/")>-1||o.indexOf("/webplayer-")>-1||window.isWebPlayerBVT)return o;var r=o.split("://"),i=r[0],l=r[1].split("/");return l.splice(1,0,"webplayer"),i+"://"+l.join("/")},e._hostname=location?location.hostname:"",e._anchor=document.createElement("a"),e._staticContentFallbackEnabled=!(!window.staticContentFallBackKey||!e._cdnConfig.StaticContentFallbackUrl),e._useFallbackVal=!1,e._haveEvaluatedCookie=!1,e})();function o(e){if(void 0===e&&(e=window.navigator.userAgent),!e)return!1;var t=function(t){return-1!==e.indexOf(t)};return!(t("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) GearGame UnrealEngine/4.11.2-0   depot UE4-Releases 4.9 Safari/537.36")||t("Mozilla/5.0 (Unknown; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) PingdomTMS/0.8.5 Safari/534.34")||t("Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.75 Safari/537.36"))&&(!t("CPU iPhone OS 12")&&!t("iPad; CPU OS 12")&&(!(t("Macintosh; Intel Mac OS X 10_14")&&t("Version/")&&t("Safari"))&&!(t("Chrome/49")||t("Chrome/5")||t("Chrome/6"))))}function r(t,n,a,o,r){var l=n?t.src:e.mapResourceUrl(document,t.src),c=document.createElement("SCRIPT");return c.setAttribute("crossorigin","anonymous"),c.type="text/javascript",c.src=l,t.tag&&c.setAttribute("tag",t.tag),a||(c.async=!1),c.addEventListener("load",(function(){o&&o(l)})),c.addEventListener("error",(function(e){r&&r(l,e),-1!==c.src.indexOf("/hashedresources/")&&i()})),c}function i(){if(a._staticContentFallbackEnabled&&!a._useStaticContentFallback&&(function(){var e=o()?"SameSite=None; Secure":"";try{document.cookie="value=1; "+e;var t=-1!==document.cookie.indexOf("value=");return document.cookie="value=1; "+e+"; expires="+new Date(0).toUTCString(),t}catch(e){return!1}})()){var e=o()?";samesite=none;secure":"";return document.cookie=window.staticContentFallBackKey+"=true;max-age=28800"+e,(function(e,t,n){void 0===e&&(e=window);(function(e){var t,n,a,o,r,i;try{var l=null!==(t=window.errorTelemetryEndpoint)&&void 0!==t?t:null===(a=null===(n=window.webPlayerServerConfig)||void 0===n?void 0:n.EndpointConfig)||void 0===a?void 0:a.ErrorTelemetryEndpoint,c=null!==(o=window.antiForgeryToken)&&void 0!==o?o:null===(i=null===(r=window.webPlayerServerConfig)||void 0===r?void 0:r.AuthConfig)||void 0===i?void 0:i.AntiForgeryToken;if(l&&c){var s=new FormData;Object.getOwnPropertyNames(e).forEach((function(t){s.append(t,e[t].toString())}));var d=new XMLHttpRequest;d.open("POST",l),d.setRequestHeader("__RequestVerificationToken",c),d.setRequestHeader("x-ms-client-session-id","webplayer-"+Date.now()),d.setRequestHeader("x-ms-user-agent"," PowerApps (Web; Player)"),d.setRequestHeader("x-ms-client-request-id","webplayer-logerror-"+Date.now()),d.send(s)}}catch(e){console.error("Failed to Log Error to Server.")}})({sessionId:n||"Unknown",eventName:"WebPlayer Reload",message:"Reload requested from "+t,data:"",error:""}),console.error("Reload WebPlayer requested from "+t),e.location.reload()})(window,"ScriptLoader.reloadPlayerWithStaticContentFallback"),!0}return!1}e.WebPlayerUrlMapper=a,e.allowSameSiteNone=o,e.mapResourceUrl=a.mapResourceUrl,e.createScriptTagWithFallback=r,e.reloadPlayerWithStaticContentFallback=i;for(var l=0,c=null!==(t=window.loaderScriptSrcs)&&void 0!==t?t:["js/player-loader.js"];l<c.length;l++){var s=c[l];document.body.appendChild(r({src:s,type:n.JS}))}})(ScriptLoader||(ScriptLoader={}));
//# sourceMappingURL=Player.AppLoader.ScriptLoader.js.map