/*! For license information please see spserviceworker.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var a in n)("object"==typeof exports?exports:e)[a]=n[a]}}(self,function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=47)}([function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(24),i=n(23);function r(e){if(e&&self._killSwitches){const t=a.e.normalizeUpper(e,!1);return self._killSwitches[t]||i.e.current.isKillswitchActivated(e)}return!1}const o={reinstall1:"678735B1-EA18-4783-8B7A-03EE43F0321A",reinstall2:"32244981-AEFA-4883-8137-71577A4AC625",reinstall3:"160741BD-8647-402B-9EAA-E85FE95E6F1C",reinstall4:"1EC134C1-0C32-4ECE-A5E1-E1D11EE7D005",cookieRedirectKillSwitch:"3FBEEB53-441C-4A84-82FC-C8221FCC50D8",hostedAppGlobalCache:"78ADB72B-9E10-412B-9933-23A063AF0114",waitListDataPrefetch:"9A266914-0BC3-4200-92B9-8923B3B7CC91",useCaseSensitiveResourceFetching:"05C51BE6-C03D-429C-89A5-283B4118EE36",breakOutStreamPrefetch:"45CB7663-935D-4AB9-AF1F-46B4B362F3E5",useBrotliDefeault:"9FF1CAC6-51F5-44D3-819D-8D7D6ED6D2C9",additionalKeysRouteConfig:"612E9A1C-DEE0-4A6F-A974-C5CD5073610C",periodicMaintenance:"DE187858-30DC-4F12-B505-9A11608DE844",skipPrefetchOfFilebrowser:"1DF6324A-E405-43B9-A803-9F9392B8EEAC",acceptFetchRequestForPrefetchUrl:"909DE8A2-F326-4907-9F9F-4BA70972F126",listEnableAuthRedirect:"94D885FE-310E-42B8-B15F-3DA148B0E201",reloadListsIframe:"ca3b7059-74a2-4f58-b60e-dea06c667153",keepFlightCheckInPrefetch:"0c381a81-f6ac-465e-a711-252ba1ec7afb",scopedFilebrowserCache:"fa0164b2-4ccb-4d88-93e1-e97d5745a9e8",resourceExceptionToString:"422eb8ea-c05c-4872-9c14-24ea01e85840",keepIsSiteListsHost:"4C4B4302-B3AF-4806-9F2E-FF70071FBEC8",reorderBypassUrl:"75BFE401-6BFA-426B-91DC-1A0B8032564D",pagesInlineAuth:"A9580BAB-AC13-471E-AC8B-932AFE2F70EC",durableGen2:"8D4CC17C-CB60-4FBD-B626-C6F8F1A01454",vivaHomeOptOutSetting:"DC8525F6-71FC-47CB-9347-C8E8B2320E5C",addPrefetchedToSWStats:"9390B694-49A9-4CBC-82F5-EFB5E9234D62",updateFilePickerBrowserClaimName:"6ABACB94-5D77-4C2F-87C4-DF93444C8FA3",newScrollForVivaHomePageLayout:"102fbf56-c9b6-4fb8-bd82-65c306a0e3a7",vivaHomeTopBarHeightFix:"43542cfb-6355-43a2-a743-137228be37a5",inlineAuthEnabled:"986148E3-F0BA-44E8-AE99-056C78251F58",betterInlineAuth2:"F1EC31A1-9C5A-48E5-946E-2DA3B1D3098C",vivaHomeStartsOffline:"BC4A1853-801C-46DB-8668-12BCB057EF41",vivaHomeInlineAuth:"29B8D6C2-0806-450D-957C-4965FC5E5057",vivaHomeFixMainContentWidth:"2719132a-8436-4b94-857f-9b6b06d9f390",secureBrokerSetTeamsBrowserHostedContainerKSActivated:"69981331-ce20-4d5c-94e2-29d2ca1f0672",secureBrokerQueryParamPassthrough:"e1fe6700-06d9-4f86-b29d-e203d4eebf7e",vivaHomeAccessibilityFixes:"7d155ade-137e-44f6-9f56-687127fb5f18",addStreamToEmbedControllerKnownPaths:"c06a219c-90fc-4a0e-b465-56dd09b4f98c",vivaHomeNavResultKeys:"7f6c6d6e-f88d-45e1-b24f-f86b6e34646f",usePersistedCookies:"4eaf8a4e-9be2-4110-b9f0-da14c88b8d97",removeVHSWRender:"a0f7c29b-0d30-40bf-9f01-98e2473dd7d4",useAppQSP:"af4fbcb8-3482-4621-a36f-e496d5daf59b",useSharedIframeSrc:"ec25caf3-e9a4-4d8c-83cc-1f2836ea8a2b",offlineRenderingErrorThrows:"F1331588-2177-47B2-A02B-556B7C70E265",retryToken:"560FCE0C-A4EC-42FD-A1DC-671833C2FA43",preserveClients:"770C0C20-42DF-40CF-9508-7392875B3924",retryToken2:"19860C48-0CA3-425E-B7D6-F58DE13C3070",vivaHomeTelemetry:"99343fd3-cf47-454e-be90-2864118cf7ea",precacheDeduplication:"9DFACED6-9E9F-43D9-B7CE-65B424B93E4F"}},function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function c(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}Object.create,Object.create},function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"Loader",function(){return i}),n.d(a,"LoaderAssembly",function(){return r}),n.d(a,"CoreLibrary",function(){return o}),n.d(a,"Telemetry",function(){return s}),n.d(a,"ApplicationBase",function(){return c}),n.d(a,"WebPartShared",function(){return d}),n.d(a,"DataProviders",function(){return l}),n.d(a,"OdspUtilities",function(){return u}),n.d(a,"LodashSubset",function(){return f}),n.d(a,"HeroLayout",function(){return p}),n.d(a,"CarouselLayout",function(){return m}),n.d(a,"FlexLayout",function(){return _}),n.d(a,"CardLayout",function(){return h}),n.d(a,"GridLayout",function(){return b}),n.d(a,"PagesCore",function(){return g}),n.d(a,"PagesPreloads",function(){return v}),n.d(a,"ComponentUtilities",function(){return y}),n.d(a,"DebugApplicationCustomizer",function(){return S}),n.d(a,"SPFlightInspector",function(){return D}),n.d(a,"Teams",function(){return I}),n.d(a,"MicrosoftGraphClient",function(){return x}),n.d(a,"HeroWebPart",function(){return C}),n.d(a,"NewsWebPart",function(){return O}),n.d(a,"QuickLinksWebPart",function(){return w}),n.d(a,"PeopleWebPart",function(){return E}),n.d(a,"CompanyFeedWebPart",function(){return A}),n.d(a,"PageTitle",function(){return L}),n.d(a,"DashboardWebPart",function(){return k}),n.d(a,"ConnectorWebPart",function(){return M}),n.d(a,"HighlightedContentWebPart",function(){return P}),n.d(a,"DocumentEmbedWebPart",function(){return T}),n.d(a,"EventsWebPart",function(){return U}),n.d(a,"FieldsWebPart",function(){return F}),n.d(a,"GroupCalendarWebPart",function(){return H}),n.d(a,"ImageWebPart",function(){return R}),n.d(a,"ImageGalleryWebPart",function(){return N}),n.d(a,"ContentCenterWebPart",function(){return B}),n.d(a,"RecentDocumentsWebPart",function(){return j}),n.d(a,"NewsfeedWebPart",function(){return V}),n.d(a,"NewsLinkWebPart",function(){return z}),n.d(a,"OfficeFeedWebPart",function(){return G}),n.d(a,"SavedForLaterWebPart",function(){return K}),n.d(a,"SiteActivityWebPart",function(){return W}),n.d(a,"SitesWebPart",function(){return q}),n.d(a,"YammerHighlightsWebPart",function(){return Q}),n.d(a,"YammerWebPart",function(){return Y}),n.d(a,"ACEWebpart",function(){return J}),n.d(a,"IsolatedACEWebpart",function(){return X}),n.d(a,"SiteApplication",function(){return Z}),n.d(a,"SPHomeApplication",function(){return $}),n.d(a,"ListApplication",function(){return ee}),n.d(a,"IsolatedWebPartApplication",function(){return te}),n.d(a,"VivaHomeApplication",function(){return ne}),n.d(a,"VinciApplication",function(){return ae}),n.d(a,"SPBrokerLoginApplication",function(){return ie}),n.d(a,"SecureBrokerApplication",function(){return re}),n.d(a,"SiteAssembly",function(){return oe}),n.d(a,"SPHomeAssembly",function(){return se}),n.d(a,"IsolatedWebPartAssembly",function(){return ce}),n.d(a,"VivaHomeAssembly",function(){return de}),n.d(a,"VinciAssembly",function(){return le}),n.d(a,"BrokerLoginAssembly",function(){return ue}),n.d(a,"SecureBrokerAssembly",function(){return fe}),n.d(a,"React",function(){return pe}),n.d(a,"ReactDom",function(){return me}),n.d(a,"ReactDomProfiling",function(){return _e});const i="1c6c9123-7aac-41f3-a376-3caea41ed83f",r="44bae1a2-d2eb-4e10-8c21-a1dbdce1036f",o="7263c7d0-1d6a-45ec-8d85-d4d1d234171b",s="8217e442-8ed3-41fd-957d-b112e841286a",c="4df9bb86-ab0a-4aab-ab5f-48bf167048fb",d="914330ee-2df2-4f6e-a858-30c23a812408",l="1cea229f-b208-4202-8014-22503d92a019",u="cc2cc925-b5be-41bb-880a-f0f8030c6aff",f="73e1dc6c-8441-42cc-ad47-4bd3659f8a3a",p="9586b262-54de-4b27-9eb9-34c671400c33",m="8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",_="0447e11d-bed9-4898-b600-8dbcd95e9cc2",h="62680648-d047-46ec-81e0-475ee78e482d",b="706e33c8-af37-4e7b-9d22-6e5694d92a6f",g="764afdc3-183e-47f5-8d20-a62aff2b0881",v="1e2cdec9-1360-4295-b73c-98d6f51866d5",y="8494e7d7-6b99-47b2-a741-59873e42f16f",S="d29758ba-0fc0-4eac-bcfd-7fe5a7d0bc32",D="a7f8537f-f742-423f-ad20-ed8feaaf0805",I="9ef3df07-744e-4793-9840-c67d47c41763",x="32b9363b-09ff-4959-929a-cab2663fb223",C="c4bd7b2f-7b6e-4599-8485-16504575f590",O="8c88f208-6c77-4bdb-86a0-0c47b4316588",w="c70391ea-0b10-4ee9-b2b4-006d3fcad0cd",E="7f718435-ee4d-431c-bdbf-9c4ff326f46e",A="d0a64d22-555c-44e4-b120-aed62c263632",L="cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",k="9cc0f495-db64-4d74-b06b-a3de16231fe1",M="893a257e-9c92-49bc-8a36-2f6bb058da34",P="daf0b71c-6de8-4ef7-b511-faae7c388708",T="b7dd04e1-19ce-4b24-9132-b60a1c2b910d",U="20745d7d-8581-4a6c-bf26-68279bc123fc",F="cf91cf5d-ac23-4a7a-9dbc-cd9ea2a4e859",H="6676088b-e28e-4a90-b9cb-d0d0303cd2eb",R="d1d91016-032f-456d-98a4-721247c305e8",N="af8be689-990e-492a-81f7-ba3e4cd3ed9c",B="f92bf067-bc19-489e-a556-7fe95f508720",j="b519c4f1-5cf7-4586-a678-2f1c62cc175a",V="0ef418ba-5d19-4ade-9db0-b339873291d0",z="c1b5736d-84dd-4fdb-a7be-e7e9037bd3c3",G="2f3b693c-1054-419c-af04-fee2782b414f",K="9ac82c99-6122-45e3-8fc6-b83d3cf1c0a8",W="eb95c819-ab8f-4689-bd03-0c2d65d47b1f",q="7cba020c-5ccb-42e8-b6fc-75b3149aba7b",Q="31e9537e-f9dc-40a4-8834-0e3b7df418bc",Y="cb3bfe97-a47f-47ca-bffb-bb9a5ff83d75",J="f3bc67ee-015d-4678-a95f-c7e90ea62c1e",X="e6b93447-8007-4f1e-934f-754a0031a769",Z="b6917cb1-93a0-4b97-a84d-7cf49975d4ec",$="1f019ae1-2de1-4f44-b723-00a6ec1d7445",ee="b1ab4aaa-f779-405c-8683-d3a750b5d18d",te="682c855d-1929-4602-a2fe-59962ccaea1a",ne="eb765a5a-9fec-4d59-8cca-6c623b450f0a",ae="42dde860-0f24-4f29-a2c5-69fa26a70c27",ie="efd6c8a7-f166-458c-905f-720088538e16",re="ad084475-d3a1-478e-859b-7d9a31e86828",oe="b5cca424-63d0-4e35-b6c5-794d04f61206",se="2ea25a0a-eab7-46fb-acb9-8b075dd847d3",ce="a4fc0dcf-a8b1-4a93-8d91-35f9eafe12e1",de="d0015b2b-bc92-4183-883f-5742929c3d9d",le="d832f602-4405-4268-8b75-e91805f4c066",ue="33a9cbd2-27af-4acb-a1ea-57ffad59c0f4",fe="bf99cad6-b812-4cf5-81ad-a059486e9db9",pe="0d910c1c-13b9-4e1c-9aa4-b008c5e42d7d",me="aa0a46ec-1505-43cd-a44a-93f3a5aa460a",_e="d0619256-3350-4eb2-95df-31fbc25c4451";t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"n",function(){return o});const a=self.location.protocol+"//"+self.location.host;var i;!function(e){e.NavigationPreload="Service-Worker-Navigation-Preload",e.ApplicationId="X-Service-Worker-Application-Id",e.InPlaceNav="X-Service-Worker-In-Place-Nav",e.NavPrefetch="X-RequestPrefetchLink",e.LkgPrefetch="X-RequestPrefetchData"}(i||(i={}));const r="Site",o="/_api/sw-loopback/"},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={};n.r(a),n.d(a,"spfxDebugEnabled",function(){return i}),n.d(a,"SuiteNavSearchBox",function(){return r}),n.d(a,"GuestSuiteNavSearchBox",function(){return o}),n.d(a,"SitesPWA",function(){return s}),n.d(a,"OfflineSiteController",function(){return c}),n.d(a,"WEXClassHomeOffline",function(){return d}),n.d(a,"AccountSwitcher",function(){return l}),n.d(a,"SuiteNavShyHeaderModeSupport",function(){return u}),n.d(a,"DashboardPassThrough",function(){return f}),n.d(a,"WebPartAudienceTargeting",function(){return p}),n.d(a,"PrefetchOnePlayerFluentMTC",function(){return m}),n.d(a,"MultipleHomeSiteGlobalNav",function(){return _}),n.d(a,"PrefetchOnePlayerMediaSettingsEditEmptyState",function(){return h}),n.d(a,"TeamsLogonController2",function(){return b}),n.d(a,"RemoveBypassOnDashboardWithScriptSyncPending",function(){return g}),n.d(a,"TeamsJsV2",function(){return v}),n.d(a,"BrokerLogon",function(){return y}),n.d(a,"OnePlayerFastNextGenEngineEnabled",function(){return S}),n.d(a,"OnePlayerFastNextGenEngineSPExperimentEnabled",function(){return D}),n.d(a,"SpfxDurableN1",function(){return I});const i=205,r=1240,o=60242,s=1267,c=60056,d=60915,l=60222,u=605,f=60860,p=60668,m=1276,_=60652,h=60844,b=60812,g=1100,v=1086,y=60940,S=1295,D=90118,I=1522},function(e,t,n){"use strict";n.d(t,"n",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l});var a,i=n(24);!function(e){e[e.start=1]="start",e[e.end=2]="end"}(a||(a={}));var r=n(12);const o="serviceworker-telemetry-event-cache",s=6048e5;function c(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}function d(e,t){const n=self._telemetry.startQos({start:e,event:t});return e=>{const a=n.then(t=>t(e));return t&&t.waitUntil(a),a}}class l{constructor(){this._cache=new r.t({cacheAppName:o}),this._debouncedPostDataToClient=this._getDebouncedPostDataToClient()}startQos(e){let t,n,r=e;e.start&&(r=e.start,n=e.event),t="string"==typeof r?{name:r}:r;const o=i.e.generate(),s={qos:t,type:a.start,id:o},c=n&&(n.resultingClientId||n.clientId);return this._logQosEvent({qos:s,clientId:c}).then(()=>e=>{e.extraData=Object.assign(Object.assign({},e.extraData),{name:t.name,id:o});const n={qos:e,type:a.end,id:o};return this._logQosEvent({qos:n,clientId:c})})}_getDebouncedPostDataToClient(){let e;return t=>{const n=t.getData;return t.getData=()=>n(),e=e||self._postMessageController.postDataToClient(t),Promise.race([e.then(()=>t.cleanupData()),new Promise(e=>{self.setTimeout(()=>{e()},5e3)})]).then(()=>{e=void 0}).catch(t=>{console.log("postDataToClient error: ",t),e=void 0})}}_sendTelemetry(e){let t=[];return this._debouncedPostDataToClient({clientId:e,getData:()=>this._cache.rangeQuery({index:"app_lastModified",range:IDBKeyRange.bound([o,Date.now()-s],[o,Date.now()]),direction:"prev",count:1/0}).then(e=>{t=e.data;const n=[];for(const t of e.data){const{original:e}=t;n.push(this._cache.read(e.key))}return Promise.all(n).then(e=>({qosEvents:e.filter(Boolean).map(e=>e.data),isQos:!0}))}),cleanupData:()=>t.length>0?this._cache.clean({expirationInMilliseconds:s,additionalItemsToClean:t,logQos:!1}):Promise.resolve()})}_logQosEvent(e){const{qos:t,clientId:n}=e;return this._cache.update(`${t.id}-${t.type}`,t).then(()=>{if(n)return this._sendTelemetry(n)})}}},function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return r}),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(a||(a={})),function(e){e.KeyValueKeyPath="key"}(i||(i={}));class r{constructor(e,t){this.name=e,this.version=t}open(){return new Promise((e,t)=>{const n=self.indexedDB.open(this.name,this.version);n.onerror=()=>{t(n.error)},n.onsuccess=()=>{this._db=n.result,e()},n.onupgradeneeded=e=>{this.upgrade(n.result,e)}})}maintain(){}snapshot(){const e=[];for(let t=0;t<this._db.objectStoreNames.length;t++){const n=this._db.objectStoreNames.item(t),i=this.store(n,a.ReadOnly);e.push(this.getAll(i).then(e=>({name:n,data:e})))}return Promise.all(e).then(e=>({name:this.name,stores:e}))}close(){this._db&&(this._db.close(),this._db=null)}get db(){return this._db}get opened(){return!!this._db}createStore(e,t,n){const a=n.createObjectStore(e,{keyPath:t});return a.createIndex(t,t),a}createKeyValueStore(e,t){return this.createStore(e,i.KeyValueKeyPath,t)}store(e,t){return this._db.transaction(e,t||a.ReadOnly).objectStore(e)}deleteStore(e,t){try{t.deleteObjectStore(e)}catch(e){}}count(e){return new Promise((t,n)=>{const a=e.count();a.onerror=e=>{n(e)},a.onsuccess=()=>{t(a.result)}})}byIndex(e,t,n,a){return new Promise((i,r)=>{const o=n.index(e).openCursor(null,t?"prev":"next");o.onerror=e=>{r(e)};let s=0;const c=[];o.onsuccess=()=>{const e=o.result;e&&(void 0===a||s++<a)?(c.push(e.value),e.continue()):i(c)}})}getAll(e){const t=e.getAll();return new Promise((e,n)=>{t.onerror=()=>{n(t.error)},t.onsuccess=()=>{e(t.result)}})}get(e,t){const n=t.get(e);return new Promise((e,t)=>{n.onerror=()=>{t(n.error)},n.onsuccess=()=>{e(n.result)}})}getValue(e,t){return this.get(e,t).then(e=>e&&e.value)}getKeyValuesAs(e){return this.getAll(e).then(e=>{const t={},n=e.length;for(let a=0;a<n;a++)t[e[a].key]=e[a].value;return t})}put(e,t){const n=t.put(e);return new Promise((e,t)=>{n.onerror=()=>{t(n.error)},n.onsuccess=()=>{e()}})}putValue(e,t,n){return this.put({key:e,value:t},n)}putMany(e,t){if(!e||!e.length)return Promise.resolve();const n=[];return e.forEach(e=>{n.push(this.put(e,t))}),Promise.all(n).then(void 0)}putKeyValuesFrom(e,t){const n=Object.keys(e),a=n.length,i=[];for(let t=0;t<a;t++)i.push({key:n[t],value:e[n[t]]});return this.putMany(i,t)}delete(e,t){const n=t.delete(e);return new Promise((e,t)=>{n.onerror=()=>{t(n.error)},n.onsuccess=()=>{e()}})}clearStore(e){const t=e.clear();return new Promise((e,n)=>{t.onerror=()=>{n(t.error)},t.onsuccess=()=>{e()}})}trimStore(e,t,n){return new Promise((a,i)=>this.count(e).then(r=>{if(r>n){const o=e.index(t).openCursor(null,"next");o.onerror=e=>{i(e)};let s=0;o.onsuccess=()=>{const e=o.result;e&&e.delete(),++s<r-n?e.continue():a()}}else a()}))}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(41);!function(e){e[e.StartDocument=0]="StartDocument",e[e.Head=1]="Head",e[e.Body=2]="Body",e[e.End=3]="End"}(a||(a={}));class r{constructor(e){this.readableStream=new ReadableStream(this),this._position=a.StartDocument,this.nonce=e||Math.random().toString(36).substring(2)}static isRtl(e){return this._rtl.test(e)}static dir(e){return this.isRtl(e)?"rtl":"ltr"}static htmlEncode(e,t){return(e||"").replace(r._specialChars,t?r._jsEncode:r._entityEncode)}get position(){return this._position}get durations(){return this._durations}static _encode(e){return r._encoder.encode(e.join(""))}static _entityEncode(e){return`&#${e.charCodeAt(0)};`}static _jsEncode(e){return`\\x${e.charCodeAt(0).toString(16)}`}start(e){this._controller=e,this._html=[],this._chunksWritten=0,this._startTime=performance.now(),this._durations=[]}send(e){if(this._controller)try{this._controller.enqueue(e)}catch(e){}}sendString(e){this.send(r._encoder.encode(e))}write(e){this._html.push(`${e}\n`)}flush(){const e=performance.now(),t=Math.round(e-this._startTime);this._html.push(`\x3c!--EOC${this._chunksWritten++}(${t}ms)--\x3e`),this.send(r._encode(this._html)),this._durations.push(t),this._html=[],this._startTime=e}close(){try{this._controller.close()}catch(e){}}startHtml(e){const t=r.dir(e);this._html.push(`<!DOCTYPE html>\n<html lang="${e}" dir="${t}"><head>\n`),this._position=a.Head}endHtml(){this._html.push("</body></html>"),this.flush(),this._position=a.End}title(e){this._html.push(`<title>${r.htmlEncode(e)}</title>\n`)}startBody(){this._html.push('</head><body class="ms-font-m">\n'),this._position=a.Body}meta(e,t){this._html.push(`<meta name="${e}" content="${t}">\n`)}charset(e){this._html.push(`<meta charset="${e||"UTF-8"}">`)}viewport(e){this.meta("viewport",e||"width=device-width,initial-scale=1")}generator(e){this.meta("GENERATOR",e)}manifest(e){this._html.push(`<link rel="manifest" crossOrigin="use-credentials" href="${e}">\n`)}shortcutIcon(e){this._html.push(`<link rel="shortcut icon" href="${e}" type="image/vnd.microsoft.icon" id="favicon">\n`)}preconnect(e){this._html.push(`<link rel="preconnect" href="${e}" crossorigin>`)}preload(e,t,n,a){this._html.push(`<link rel="preload" href="${e}" as="${t||i.e.Script}"`+(a?' integrity="'+a+'"':"")+(n?' type="'+n+'"':"")+" crossorigin>\n")}script(e,t,n){this._html.push(`<script src="${e}" nonce="${this.nonce}"${n?"":" crossorigin"}${t?` onerror="${t}"`:""}><\/script>\n`)}script2(e,t,n,a){this._html.push(`<script src="${e}" nonce="${this.nonce}"`),t&&this._html.push(` id="${t}"`),n&&this._html.push(" async");const i=a&&a.length||0;for(let e=0;e<i;e++){const t=a[e];this._html.push(` ${t[0]}`),"string"==typeof t[1]&&this._html.push(`="${t[1]}"`)}this._html.push(" crossorigin><\/script>\n")}xssStringify(e){return JSON.stringify(e||null).replace(r._ltChar,"\\u003c")}inlineScript(e,t){this._html.push(`<script nonce="${this.nonce}">${t?"":"(()=>{"}${e}${t?"":"})()"}<\/script>\n`)}copyStream(e){return new Promise(t=>{const n=e.getReader(),a=()=>{n.read().then(e=>{e.done?t():(this._controller.enqueue(e.value),a())})};a()})}sendResponse(e){return this.copyStream(e.body)}}r._encoder=new TextEncoder,r._rtl=/^(ar|ara|arc|ae|ave|egy|he|heb|nqo|pal|phn|sam|syc|syr|fa|per|fas|ku|kur|ur|urd)(-[A-Z]{2})?$/,r._specialChars=/[\x26\x0A\<>'"]/g,r._ltChar=/</g},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a,i,r=n(6);!function(e){e.Name="Site.Config",e.StateStoreName="State",e.SiteStoreName="Site",e.SiteStoreKeyPath="path",e.SiteStoreLastReadIndex="lastRead",e.PageStoreName="Page",e.PageStoreKeyPath="path",e.PageStoreRankIndex="rank",e.StatsStoreName="Stats"}(a||(a={})),function(e){e[e.MaxSites=55]="MaxSites",e[e.MaxPages=140]="MaxPages"}(i||(i={}));class o extends r.t{constructor(){super(a.Name,2)}getStateValue(e){const t=this.store(a.StateStoreName);return this.getValue(e,t)}getState(){const e=this.store(a.StateStoreName);return this.getKeyValuesAs(e)}getStats(){const e=this.store(a.StatsStoreName);return this.getKeyValuesAs(e)}getPages(){const e=this.store(a.PageStoreName);return this.getAll(e)}getTopPages(e){const t=this.store(a.PageStoreName);return this.byIndex(a.PageStoreRankIndex,!0,t,e)}getPage(e){const t=this.store(a.PageStoreName);return this.get(e,t)}deletePage(e){const t=this.store(a.PageStoreName,r.e.ReadWrite);return this.delete(e,t)}saveState(e){const t=this.store(a.StateStoreName,r.e.ReadWrite);return this.putKeyValuesFrom(e,t)}saveStats(e){const t=this.store(a.StatsStoreName,r.e.ReadWrite);return this.putKeyValuesFrom(e,t)}computeStats(){return Promise.all([this.count(this.store(a.PageStoreName)),this.count(this.store(a.SiteStoreName)),this.count(this.store(a.StateStoreName))]).then(e=>({pages:e[0],sites:e[1],states:e[2],lastMaintained:new Date}))}savePage(e){const t=this.store(a.PageStoreName,r.e.ReadWrite);return this.put(e,t)}getSites(){const e=this.store(a.SiteStoreName);return this.getAll(e)}getRecentSites(e){const t=this.store(a.SiteStoreName);return this.byIndex(a.SiteStoreLastReadIndex,!0,t,e)}getSite(e){const t=this.store(a.SiteStoreName);return this.get(e,t)}saveSite(e){const t=this.store(a.SiteStoreName,r.e.ReadWrite);return this.put(e,t)}deleteSite(e){const t=this.store(a.SiteStoreName,r.e.ReadWrite);return this.delete(e,t)}maintain(){return Promise.all([this.trimStore(this.store(a.SiteStoreName,r.e.ReadWrite),a.SiteStoreLastReadIndex,i.MaxSites),this.trimStore(this.store(a.PageStoreName,r.e.ReadWrite),a.PageStoreRankIndex,i.MaxPages)]).then(void 0)}upgrade(e,t){t.oldVersion&&t.oldVersion<2&&(this.deleteStore(a.StateStoreName,e),this.deleteStore(a.PageStoreName,e),this.deleteStore(a.SiteStoreName,e),this.deleteStore(a.StatsStoreName,e)),this.createKeyValueStore(a.StateStoreName,e),this.createStore(a.PageStoreName,a.PageStoreKeyPath,e).createIndex(a.PageStoreRankIndex,a.PageStoreRankIndex),this.createStore(a.SiteStoreName,a.SiteStoreKeyPath,e).createIndex(a.SiteStoreLastReadIndex,a.SiteStoreLastReadIndex),this.createKeyValueStore(a.StatsStoreName,e)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3);function i(e){if(!e)return"/";const t=new URL(e.toLocaleLowerCase(),a.e).pathname;return t.endsWith("/")&&t.length>1?t.substring(0,t.length-1):t}},function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"o",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return u});const a={active:!0};function i(e){return`${e}-${Date.now().toString(16)}`}function r(e,t){return caches.open(t.l1).then(t=>{const n=[],i=e.length;for(let r=0;r<i;r++)n.push(a.active?t.add(e[r]):t.match(e[r]).then(n=>(!n||o(n,e[r]instanceof Request?e[r]:void 0))&&t.add(e[r]).catch(()=>{})));return Promise.all(n).catch(()=>{}).then()})}function o(e,t){const n=((null==t?void 0:t.headers.get("Cache-Control"))||"").toLowerCase();if(n&&(n.includes("no-cache")||n.includes("max-age=0")))return!0;const a=(e.headers.get("Cache-Control")||"").toLowerCase().split(","),i=a.length;for(let t=0;t<i;t++){const n=a[t].trim().split("=");if("max-age"===n[0]){const t=Date.parse(e.headers.get("Date"));if(isNaN(t))return!0;const a=parseInt(n[1],10);if(!isNaN(a)){const n=parseInt(e.headers.get("Age"),10);return(Date.now()-t-(isNaN(n)?0:1e3*n))/1e3>a}}}}function s(e,t){return caches.open(t.l1).then(n=>n.match(e).then(a=>a&&[!o(a,e)&&a,n]||(t.l2?caches.open(t.l2).then(t=>t.match(e).then(a=>a&&!o(a,e)?Promise.all([n.put(e,a.clone()),t.delete(e)]).then(()=>[a,n,t]):[void 0,n,t])):[void 0,n])))}function c(e,t){const n={l2:e.l1,l1:i(t),l1Created:new Date};return Promise.resolve(e.l2&&caches.delete(e.l2)).then(()=>n)}function d(e,t){return caches.keys().then(n=>{const a=[],i=n&&n.length||0;for(let r=0;r<i;r++){const i=n[r];0!==i.indexOf(e+"-")||t&&(t.l1===i||t.l2===i)||a.push(caches.delete(i))}return Promise.all(a).then()})}function l(e,t){return s(e.request,t).then(t=>t[0]||function(e,t){return fetch(t.request).then(n=>Promise.resolve(function(e,t){if(t.ok)return!(t.headers.get("Cache-Control")||"").toLowerCase().includes("no-cache")&&(new URL(e.url).hostname!==self.location.hostname||(t.headers.get("Content-Type")||"").includes((e.headers.get("Accept")||"").replaceAll("*","")))}(t.request,n)&&e.put(t.request,n.clone())).then(()=>n))}(t[1],e))}function u(e,t,n){return s(e,t).then(t=>t[0]||n().then(n=>t[1].put(e.clone(),n.clone()).then(()=>n)))}},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(26),i=n(1),r=n(21);function o(e){var t,n,a=e||void 0;return Object(i.e)(Object(i.e)({error:e&&(e.message||e.name),resultCode:a&&(t=a,n=[],"object"==typeof t.extraData&&t.extraData&&void 0!==t.extraData.status&&n.push("[".concat(t.extraData.status,"]")),"string"==typeof t.code&&n.push("".concat(t.code)),n.join(" "))||e&&e.name||"Unknown"},a?Object(i.e)({},"boolean"==typeof a.isExpected?{resultType:a.isExpected?r.e.ExpectedFailure:r.e.Failure}:{resultType:r.e.Failure}):{resultType:r.e.Success}),{extraData:Object(i.e)({stack:e&&e.stack},a?Object(i.e)(Object(i.e)(Object(i.e)({},"object"==typeof a.innerError?{innerError:o(a.innerError)}:{}),"string"==typeof a.correlationId?{correlationId:a.correlationId}:{}),"object"==typeof a.extraData?Object(i.e)({},a.extraData):{}):{})})}function s(e,t,n){e&&!e.ended&&(e(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:Object(i.e)(Object(i.e)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:Object(i.e)(Object(i.e)({},e.extraData||{}),t.extraData||{})}:{})},e)}(t,{extraData:n})),e.ended=!0)}function c(e,t,n,i,r){s(e,o(t instanceof a.e?t:new a.e({innerError:t,code:n,isExpected:i})),r)}},function(e,t,n){"use strict";n.d(t,"e",function(){return H}),n.d(t,"t",function(){return R});var a={};n.r(a),n.d(a,"localStorage",function(){return o}),n.d(a,"indexedDB",function(){return s}),n.d(a,"none",function(){return c});var i,r=n(1),o=0,s=1,c=2,d=a,l=n(13),u="undefined"==typeof window?self:window,f=n(21);!function(e){e.success="success",e.error="error"}(i||(i={}));var p="app",m="app_lastRead",_="ODSP_DB",h="ODSP_DB_TABLE",b="lastModified",g="lastRead",v="ODSP_DB_METADATA_TABLE",y="database_metadata",S="parentKey",D="reads",I=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,i=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(i),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(i),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(i),u=i.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(i),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(r.e)(Object(r.e)(Object(r.e)(Object(r.e)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(i),isWindows10:!d&&i.indexOf("windows nt 10")>-1,isWindows7:!d&&i.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:a})}).isFirefox,x="indexedDB is not supported",C=function(){function e(t){if(!("indexedDB"in u)||!u.indexedDB)throw new Error(x);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.a)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([h],"readwrite").objectStore(h).index(m).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.a)(this,function(t){return[2,this._readInternal(h,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,b=this;return Object(r.a)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([h],"readonly"),c=s.objectStore(h),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){b._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(r.t)(this,void 0,void 0,function(){var t;return Object(r.a)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:h,key:t,row:Object(r.e)(Object(r.e)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:h,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(r.t)(this,void 0,void 0,function(){var e,t;return Object(r.a)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(h,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=I?indexedDB.open(_,{version:4,storage:"temporary"}):indexedDB.open(_,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(h,{keyPath:"key"})).createIndex(b,b,{unique:!1}),a.createIndex(D,D,{unique:!1}),t.createObjectStore(v,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(h)).createIndex(p,p,{unique:!1}),a.createIndex(g,g,{unique:!1}),a.createIndex(m,[p,g],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(h)).createIndex("app_lastModified",[p,b],{unique:!1}),a.createIndex("app_reads",[p,D],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(h)).createIndex(S,S,{unique:!1}),a.createIndex("parentKey_app",[S,p],{unique:!1}),a.createIndex("parentKey_app_lastModified",[S,p,b],{unique:!1}),a.createIndex("parentKey_app_lastRead",[S,p,g],{unique:!1}),a.createIndex("parentKey_app_reads",[S,p,D],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(v,function(e){return e.get(y)}).then(function(t){if(t)return t.data;var n={id:l.generate(),created:Date.now(),cacheType:d.indexedDB};return e._writeInternal({tableName:v,key:y,row:{key:y,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.a)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:f.e.Success,extraData:{io:Math.round(Date.now()-o)}}),e(d.result)},d.onerror=function(e){r({resultType:f.e.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s,c=this;return Object(r.a)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.a)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(r.t)(this,void 0,void 0,function(){var t,n=this;return Object(r.a)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:S,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:h,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),O="PersistentCache",w="PersistentCache_metadata",E=function(){function e(){try{if("localStorage"in u&&u.localStorage&&(this._localStorage=u.localStorage,!this._localStorage.getItem(w))){var e={id:l.generate(),created:Date.now(),cacheType:d.localStorage};this._localStorage.setItem(w,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(r.e)(Object(r.e)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(O)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(w)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.a)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(O,"_").concat(e)},e}(),A=0,L=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return Object(r.t)(n,void 0,void 0,function(){var e;return Object(r.a)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:A++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=u.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function k(){return u.performance&&performance.now?Math.round(performance.now()):Date.now()}var M="_odspcache_",P="_____",T={cacheType:d.indexedDB},U=function(){function e(e){var t=e.cacheType,n=void 0===t?T.cacheType:t,a=Object(r.i)(e,["cacheType"]);if(this._config=Object(r.e)(Object(r.e)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new L,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,p,m,_,h,b,g,v,y,S,D,I;return Object(r.a)(this,function(r){switch(r.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=k(),c=Date.now(),r.label=1;case 1:return r.trys.push([1,12,,13]),l=this._getCacheKey(t),u=!1,p={lastModified:NaN,lastRead:c,reads:1},m=void 0,l?(_=k(),[4,this._storage.read(l)]):[3,11];case 2:return d=r.sent(),o=Math.round(k()-_),d?(h=d.data,p={lastModified:d.lastModified,lastRead:c,reads:d.reads+1},(a=e._buffer[l])&&a.cacheStats.lastModified===d.lastModified?(a.app=d.app||this._app,a.key={original:t,encoded:d.key||l},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(k()-s)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===h)return[3,11];if(!this._dataIsEncrypted)return[3,10];b=h,g=this._cacheSecret,v=g.CurrentKey.Key,y=g.PreviousKey.Key,S=k(),r.label=4;case 4:return r.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:v})];case 5:return m=r.sent(),[3,9];case 6:return(D=r.sent())&&D.message&&D.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:y})]:[3,8];case 7:m=r.sent(),u=void 0!==m,n({resultType:f.e.ExpectedFailure,error:D.message,extraData:{cacheResult:"hit"}}),r.label=8;case 8:return[3,9];case 9:return i=Math.round(k()-S),[3,11];case 10:m=h,r.label=11;case 11:return a=a||{key:{original:t,encoded:d&&d.key||l},app:d&&d.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:i,io:o,total:Math.round(k()-s)}},e._buffer[l]=a,u&&this.update(t,m),[3,13];case 12:throw I=r.sent(),n({resultType:f.e.Failure,error:I.message?I.message:I.toString(),extraData:{cacheResult:"miss"}}),I;case 13:return n({resultType:f.e.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(r.t)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,l=this;return Object(r.a)(this,function(r){if(this._cacheType!==d.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=k(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=k(),o=this._storage.rangeQuery(e).then(function(e){return n=Math.round(k()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:l._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:l._cacheType,performance:{io:n,total:Math.round(k()-a)}}})}catch(e){throw t({resultType:f.e.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:f.e.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(k()-a)}})]})})},e.prototype.update=function(e,t){return Object(r.t)(this,void 0,void 0,function(){var n,a=this;return Object(r.a)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(r.t)(this,void 0,void 0,function(){return Object(r.a)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(r.t)(this,void 0,void 0,function(){return Object(r.a)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(r.t)(this,void 0,void 0,function(){var n,a,i,o,s,c,l=this;return Object(r.a)(this,function(r){switch(r.label){case 0:n=k(),a=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),o=t().then(function(t){var i={app:l._app,key:{original:e,encoded:l._getCacheKey(e)},data:t,cacheType:d.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(k()-n)}};return l.update(e,t),i}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!s||s.cacheType!==d.none&&void 0===s.data?[4,o]:[3,7];case 6:s=r.sent(),r.label=7;case 7:return[3,9];case 8:throw c=r.sent(),i({resultType:f.e.Failure,error:c.message?c.message:c.toString()}),c;case 9:return i({resultType:f.e.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){if(e===d.localStorage)this._storage=new E;else try{this._storage=new C(this._logQos.bind(this))}catch(e){e.message===x&&(this._storage=new E,this._cacheType=d.localStorage)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?P+e.user:""));return"".concat(M).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(M,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(P)>=0){var i=a.split(P);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(r.t)(this,void 0,void 0,function(){var a,i,o,s,c,l,u;return Object(r.a)(this,function(p){switch(p.label){case 0:a=this._logQos({name:"PersistentCache.update"}),p.label=1;case 1:return p.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((o=e._buffer[i]=Object(r.e)(Object(r.e)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:k(),reads:1}),s=n,c=NaN,this._dataIsEncrypted?(l=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:l,data:n,doSerialize:this._cacheType===d.localStorage})]):[3,3]);case 2:return s=p.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return p.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:throw u=p.sent(),a({resultType:f.e.Failure,error:u.message?u.message:u.toString()}),u;case 10:return a({resultType:f.e.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(r.t)(this,void 0,void 0,function(){var e=this;return Object(r.a)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(r.t)(e,void 0,void 0,function(){return Object(r.a)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),F=n(5);const H=18144e5;class R{constructor(e){const{cacheAppName:t}=e;this._cache=new U({app:t,cacheType:d.indexedDB,telemetry:void 0})}read(e){return this._cache.read({key:e}).then(e=>void 0===e.data?void 0:e)}update(e,t){return this._cache.update({key:e},t)}remove(e){return this._cache.remove({key:e})}keys(){const{app:e}=this._cache.configuration;return this._cache.rangeQuery({index:"app",range:IDBKeyRange.only(e),direction:"next"}).then(e=>e.data.map(e=>e.original.key))}clean(e){const{logQos:t=!0}=e||{},n=t&&Object(F.t)("SPServiceWorker.ListController.indexedDB.cleanup");return this._cleanInternal(e).then(e=>n&&n({resultType:f.e.Success,extraData:{entriesRemoved:e}})).catch(e=>n&&n({resultType:f.e.Failure,error:JSON.stringify(e)}))}rangeQuery(e){return this._cache.rangeQuery(e)}_cleanInternal(e){const{expirationInMilliseconds:t=H,additionalItemsToClean:n=[]}=e||{},{app:a}=this._cache.configuration,i=Date.now()-t;return this._cache.rangeQuery({index:"app_lastModified",range:IDBKeyRange.bound([a,0],[a,i]),direction:"next"}).then(e=>{const t=[];return new Set([...e.data,...n]).forEach(e=>{const{original:n}=e;t.push(this._cache.remove(n))}),Promise.all(t).then(e=>e?e.length:0)})}}},function(e,t,n){"use strict";function a(e){for(var t="";t.length<e;){var n=16*Math.random();t+=(n|=0).toString(16)}return t}n.r(t),n.d(t,"Empty",function(){return i}),n.d(t,"_guidRegEx",function(){return r}),n.d(t,"generate",function(){return o}),n.d(t,"normalizeLower",function(){return s}),n.d(t,"normalizeUpper",function(){return c}),n.d(t,"normalizeDashes",function(){return d}),n.d(t,"isValidGuid",function(){return l});var i="00000000-0000-0000-0000-000000000000",r=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function o(){var e=[];e.push(a(8)),e.push(a(4));var t="4"+a(3);e.push(t);var n=a(4),i=parseInt(n[0],16);return i&=3,n=(i|=8).toString(16)+n.substr(1),e.push(n),e.push(a(12)),e.join("-")}function s(e,t){return void 0===t&&(t=!1),e?u(e.toLowerCase(),t):""}function c(e,t){return void 0===t&&(t=!1),e?u(e.toUpperCase(),t):""}function d(e,t){if(void 0===t&&(t=!1),e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return u("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function l(e){return!(!e||!r.test(s(e)))}function u(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n(3),i=n(43),r=n(10),o=n(23);const s="/_layouts/15/spwebworkerproxy.ashx",c=`${a.e}${s}?${self._wwBuildNumber}`;class d extends i.e{install(){return super.install().then(()=>o.e.current.install())}precacheWithContext(e){const t=e.config.state,n=[c];return t.suiteNavBootUrl&&n.push(t.suiteNavBootUrl),Object(r.i)(n,t.cache)}isWorkerFetch(e){return e===s}fetchWorker(e){return this.context.then(t=>{const n=new Request(c,e.request);return Object(r.n)(n,t.config.state.cache,()=>fetch(n))})}resourceRoutes(){return super.resourceRoutes().concat([{match:this.isWorkerFetch.bind(this),fetch:this.fetchWorker.bind(this)}])}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",function(){return BaseSpfxHandler});var _microsoft_sp_lodash_subset__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(28),_microsoft_sp_lodash_subset__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_microsoft_sp_lodash_subset__WEBPACK_IMPORTED_MODULE_0__),_ms_utilities_error__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(26),_substring__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(22),_semver__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(37),_BaseServiceWorker__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(32),_FlightId__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4),_HtmlWriter__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7),_site_interfaces__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3),_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(27),_SpfxInternalId__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2),_SpfxConfig__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(25);const InlineFetchNewDataJs=`const u=new URL(location.href);u.searchParams.set('as','json');fetch(u.href,{credentials:'include',headers:{Accept:'application/json','${_site_interfaces__WEBPACK_IMPORTED_MODULE_7__.t.LkgPrefetch}':'1'}}).then(r=>r.json()).then(data=>{const ks=Object.keys(data||[]);for(const k of ks){window[k]=data[k];window[k+'Loaded']&&window[k+'Loaded'](false,true);}});`;class BaseSpfxHandler extends _SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.t{constructor(){super(...arguments),this.maxWebPartPreloads=4,this.maxComponentPreloads=5}get scriptLang(){return this.forcedLocale||this.site&&this.site.scriptLang||this.lang}get debugMode(){return void 0===this._debugMode&&(this._debugMode=("true"===this.url.searchParams.get("debug")||_BaseServiceWorker__WEBPACK_IMPORTED_MODULE_4__.e)&&"true"!==this.url.searchParams.get("reset")&&this.isFlightEnabled(_FlightId__WEBPACK_IMPORTED_MODULE_5__.e.spfxDebugEnabled)),this._debugMode}get testMode(){return!!this.url.searchParams.get("buildId")}get debugLoaderUrl(){return this.debugMode&&(this.url.searchParams.get("loader")||this.context.spfxConfig.loaderAssemblyUrl(this.scriptLang))}get forcedLocale(){return this.url.searchParams.get("forceLocale")}get scriptSyncPending(){return this._scriptSyncPending}get components(){return this._components}loaderUrl(){return this._loaderUrl||(this._loaderUrl=this.debugLoaderUrl||(this.context.spfxConfig.assemblyMode&&this.assemblyId?this.context.spfxConfig.scriptUrl(this.assemblyId,this.scriptLang):this.context.spfxConfig.loaderAssemblyUrl(this.scriptLang)))}initialize(e,t){return this.testMode?Promise.reject():super.initialize(e,t)}parseNavigationResult(e){return super.parseNavigationResult(e).then(e=>"string"!=typeof e?e:this._parseUnexpectedHtml(e))}get spPageContext(){return this.preloadedData.spPageContextInfo}extensions(){if(!this._extensions){const e=this.preloadedData.manifests,t=e&&e.length||0;this._extensions=new Map;for(let n=0;n<t;n++)e[n].isInternal||this._extensions.set(e[n].id,e[n])}return this._extensions}preloads(){const e=super.preloads();return this.debugMode?e:e.concat(this.loaderUrl(),(this.context.spfxConfig.scriptUrls((this.spfxPreloads||[]).concat((this._getWebPartIds()||[]).slice(0,this.maxWebPartPreloads),(this.page.dynamicComponents||[]).slice(0,this.maxComponentPreloads)),this.scriptLang)||[]).filter(e=>new URL(e).host!==self.location.host))}getComponents(){const e=this.page;return this.context.spfxConfig.getComponents([this.componentId].concat(this._getWebPartIds()||[],e.dynamicComponents||[],e.extensions||[],this.additionalComponents()),this.scriptLang)}syncScript(e){const t=this.context.spfxConfig,n=Array.from(new Set(t.scriptSyncState?t.scriptSyncState.langs:void 0).add(e));let a;return t.syncManifests(n,!0,this.site).catch(e=>{if(!(e instanceof _ms_utilities_error__WEBPACK_IMPORTED_MODULE_1__.e)||"401"!==e.code&&"403"!==e.code)throw e;this.abandonUnlessRedirected=!0,this.error=a=e}).then(()=>!a&&this.swapCaches().then(()=>this.controller.precache((t,n)=>n===e)))}ensureScript(e){return void 0===this._scriptSync&&(e||(e=this.scriptLang),this._scriptSync=this.context.spfxConfig.requiresScriptSync([e],this.offlineMode)?this.syncScript(e):null),this._scriptSync}hydrateNavigationResult(){const e=this.context.spfxConfig,t=this.navigationResultFromConfig;return Promise.all([t&&this.ensureScript(),t&&super.hydrateNavigationResult()]).then(()=>{this._version=this.preloadedData.buildNumber,this.preloadedData.manifests=this._components=this.getComponents(),e.scriptSyncState&&(this.preloadedData.buildNumber=e.scriptSyncState.version)})}processNavigationResult(){const e=this.context.spfxConfig,t=this.navigationResultFromConfig;return Promise.all([this._saveExtensions(),!t&&this.ensureScript(this.preloadedData.appScriptLang)]).then(super.processNavigationResult.bind(this)).then(!t&&this.hydrateNavigationResult.bind(this)).then(()=>{this._scriptSyncPending=!this._scriptSync&&e.scriptSyncState&&e.scriptSyncState.version!==this._version&&!this.inPlace&&!this.offline&&!this.debugMode})}isConfigValid(){return super.isConfigValid()&&(this.navigationResultFromConfig||!this.ensureScript())}saveConfig(){return this.preloadedData&&(this.preloadedData.manifests=void 0),Promise.resolve(this._deletedManifests&&this.context.spfxConfig.deleteManifests(Array.from(this._deletedManifests))).then(super.saveConfig.bind(this))}finalize(e){return Promise.resolve(this._scriptSyncPending&&this.syncScript(this.scriptLang)).then(super.finalize.bind(this,e))}renderLoaderAssembly(e){this.renderMark(e,_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.e.moduleLoaderScriptStart),e.script(this.loaderUrl(),`location.href='${_HtmlWriter__WEBPACK_IMPORTED_MODULE_6__.e.htmlEncode(this.bypassUrl(),!0)}'`,this.debugMode),this.renderMark(e,_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.e.moduleLoaderScriptEnd)}renderAppChrome(e){e.write('<div class="spAppAndPropertyPanelContainer">\n<div class="SPPageChrome-app" id="spPageChromeAppDiv" data-sp-feature-tag="Page Chrome" data-sp-feature-instance-id="_Page Chrome" data-sp-a11y-navigatebyhierarchy="true">'),this.renderAppChromeContent(e),e.write("</div></div>")}renderShell(e){super.renderShell(e),this.renderLoaderAssembly(e),this.navigationResultFromConfig||e.flush()}additionalComponents(){const e=[];return this.context.userAgent.teams&&e.push(_SpfxInternalId__WEBPACK_IMPORTED_MODULE_9__.e.Teams),(this.debugMode||this.isFlightEnabled(_FlightId__WEBPACK_IMPORTED_MODULE_5__.e.spfxDebugEnabled))&&(e.push(_SpfxInternalId__WEBPACK_IMPORTED_MODULE_9__.e.DebugApplicationCustomizer),e.push(_SpfxInternalId__WEBPACK_IMPORTED_MODULE_9__.e.SPFlightInspector)),e}renderStart(e){const t=[`const e=()=>{location.href='${_HtmlWriter__WEBPACK_IMPORTED_MODULE_6__.e.htmlEncode(this.bypassUrl(),!0)}';};`];this.useSecureBroker&&t.push("try{sessionStorage.setItem('useSecureBroker','true');}catch{}"),this.requiresInlineAuthentication()?(t.push(`fetch(location.href,{credentials:'include',headers:{Accept:'application/json','${_site_interfaces__WEBPACK_IMPORTED_MODULE_7__.t.NavigationPreload}':'true','${_site_interfaces__WEBPACK_IMPORTED_MODULE_7__.t.InPlaceNav}':'true'}}).then(r=>r.json()).then(preloadedData=>{${this._startJs("preloadedData")}});${this.appDataEnabled?InlineFetchNewDataJs:""}`),this.renderAuthenticateInline(e,t.join(""))):(t.push(this._startJs(e.xssStringify(this.preloadedData))),e.inlineScript(t.join("")),this.lkgFromConfig||e.flush())}authenticate(e,t){return!e&&this.appDataEnabled&&(e=InlineFetchNewDataJs),super.authenticate(e,t)}start(){return this.navigationResultReady.then(()=>this.renderStart.bind(this))}renderJson(){return JSON.stringify(this.preloadedData)}createSite(){return Object.assign(Object.assign({},super.createSite()),{scriptLang:this.preloadedData.appScriptLang})}createPage(){const e=new Set(this.extensions().keys()),t=this.preloadedData.customActions,n=t&&t.length||0;for(let a=0;a<n;a++){const n=t[a].clientSideComponentId;if(!e.has(n)){const e=this.context.spfxConfig.getComponent(n);e&&!e.isInternal&&this.deleteManifest(n)}}return Object.assign(Object.assign({},super.createPage()),{extensions:Array.from(e)})}createStats(e){return Object.assign(Object.assign({},super.createStats(e)),{scriptSyncPending:this._scriptSyncPending})}hasAppDataChanged(e,t,n){return"_spWebPartData"===n?!Object(_microsoft_sp_lodash_subset__WEBPACK_IMPORTED_MODULE_0__.isEqual)(e&&e.Items,t&&t.Items):super.hasAppDataChanged(e,t,n)}deleteManifest(e){this._deletedManifests||(this._deletedManifests=new Set),this._deletedManifests.add(e)}_startJs(e){return`__spfxMark('${_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.e.executionScriptStart}');__spfxMark('${_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.e.spModuleLoaderStart}');window.moduleLoaderPromise=spModuleLoader.start(${e},e).catch(e);__spfxMark('${_SPPageHandler__WEBPACK_IMPORTED_MODULE_8__.e.executionScriptEnd}');`}_scanForVersionMismatch(e,t){const n=this.context.spfxConfig.getComponent(t.id,t.version);if(n&&!Object(_semver__WEBPACK_IMPORTED_MODULE_3__.t)(n.version,t.version)){const a=!n.isInternal&&this.extensions().get(t.id);if(!a||!Object(_semver__WEBPACK_IMPORTED_MODULE_3__.t)(a.version,t.version))throw new _ms_utilities_error__WEBPACK_IMPORTED_MODULE_1__.e({code:"VersionMismatch",extraData:{component:`${e.id}_${e.version} (${e.alias})`,requestedComponentId:n.id,requestedVersion:t.version,installedVersion:n.version}})}}_validateExtensions(e){const t=e.length;for(let n=0;n<t;n++){const t=e[n],a=t.loaderConfig&&t.loaderConfig.scriptResources;if(a){const e=Object.keys(a),n=e.length;for(let i=0;i<n;i++){const n=a[e[i]];Object(_SpfxConfig__WEBPACK_IMPORTED_MODULE_10__.n)(n)&&this._scanForVersionMismatch(t,n)}}}}_saveExtensions(){const e=Array.from(this.extensions().values()),t=this.context.spfxConfig.scriptSyncState;return t&&t.version!==this.preloadedData.buildNumber&&this._validateExtensions(e),this.context.spfxConfig.saveManifests(e)}_parseUnexpectedHtml(navigationResult){let s=Object(_substring__WEBPACK_IMPORTED_MODULE_2__.e)(navigationResult,",spClientSidePageContext=JSON.parse('","');\r\n");if(s){const escapedString=`'${s}'`,evaluatedString=eval(escapedString);return JSON.parse(evaluatedString)}return s=Object(_substring__WEBPACK_IMPORTED_MODULE_2__.e)(navigationResult,",spClientSidePageContext=",";\r\n                var startSpfx ="),s?JSON.parse(s):Promise.reject()}_getWebPartIds(){if(this._audienceFilteredWebPartIds)return this._audienceFilteredWebPartIds;const e=this.page.webParts,t=this.page.audienceFilteredWebPartComponentIds;return this._audienceFilteredWebPartIds=this.context.config.isFlightEnabled(_FlightId__WEBPACK_IMPORTED_MODULE_5__.e.WebPartAudienceTargeting)&&e?e.filter(e=>!t||-1!==t.indexOf(e)):e,this._audienceFilteredWebPartIds}}},function(e,t,n){"use strict";var a;function i(){return a||"function"!=typeof BroadcastChannel||(a=new BroadcastChannel("sw_broadcast")),a}n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var r={OfflineNotification:"OfflineNotification",CheckOffline:"CheckOffline"},o={ScriptSynced:"SpfxScriptSynced"}},function(e,t,n){"use strict";function a(e,t){if(Promise.allSettled&&!t)return Promise.allSettled(e);const n=[],a=e.length;for(let t=0;t<a;t++)e[t]=Promise.resolve(e[t]).then(e=>{n.push({status:"fulfilled",value:e})}).catch(e=>{n.push({status:"rejected",reason:e})}).then();return Promise.all(e).then(()=>n)}function i(e){for(const t of e)if("rejected"===t.status)return t.reason||new Error(t.status)}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});const a={Precache:"Precache",ReloadConfigs:"ReloadConfigs",Maintain:"Maintain",Prerender:"Prerender",SavePage:"SavePage"}},,function(e,t,n){"use strict";n.d(t,"i",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"t",function(){return b});var a,i=n(26),r=n(21),o=n(5),s=n(11),c=n(17),d=n(33),l=n(3),u=n(18),f=n(39);function p(e,t){return fetch(e,Object.assign(Object.assign({credentials:"include"},!t&&{redirect:"manual"}),{headers:Object.assign({Accept:(t?"":"text/html,")+"application/json","Service-Worker-Navigation-Preload":"true"},t&&{"X-Service-Worker-In-Place-Nav":"true"})}))}!function(e){e.SameOrigin="same-origin",e.NoCors="no-cors",e.Cors="cors",e.Navigate="navigate"}(a||(a={}));const m={active:!0},_={active:!0};function h(e){if(m.active){const t=new URL(e);return t.searchParams.set("sw","bypass"),t.href}const t=new URL(e),n=new URL(`${t.origin}${t.pathname}?sw=bypass`);return t.searchParams.forEach((e,t)=>{"sw"!==t&&n.searchParams.set(t,e)}),n.href}class b{constructor(e){this._applications=new Map,this._clients=new Map,this._bypassQueryString=/[?&]sw=bypass(&|#|$)/,this._onInstall=e=>{console.log(`[Router] Installing ${self._swBuildNumber}...`);const t=Object(o.t)("Router.install"),n={};let a;e.waitUntil(this._context.then(()=>Object(c.e)(this._installControllers(n).concat([this._installRoutes()])).then(e=>{(a=Object(c.t)(e))&&(console.error(a),Object(s.t)(t,a,void 0,void 0,n))}).then(()=>self.skipWaiting()).then(()=>{a||Object(s.e)(t,{resultType:r.e.Success},n)})))},this._onActivate=e=>{const t=Object(o.t)("Router.activate");let n;const a=Object(c.e)([this._enableNavigationPreload(),this._registerPeriodicSync()].concat(this._executeLifecycle(e=>e.activate()))).then(e=>{(n=Object(c.t)(e))&&(console.error(n),Object(s.t)(t,n))}).then(()=>{console.log("[Router] Idle."),n||Object(s.e)(t,{resultType:r.e.Success})});_.active?e.waitUntil(self.clients.claim().then(()=>a)):e.waitUntil(a.then(()=>self.clients.claim()).then(this._restoreClients.bind(this)))},this._onStateChange=e=>{const t=Object(o.t)("Router.stateChange");Object(s.e)(t,{resultType:r.e.Success},{state:e.target&&e.target.state})},this._onSync=e=>{this._sync(e)},this._onPeriodicSync=e=>{this._sync(e)},this._onFetch=e=>{if(this.isNavigation(e)){if(this.isNavigationIntercepted(e.request)){const t=this.getNavigationPreloadResponse(e);e.waitUntil(t),e.respondWith(this.navigate(e,t))}}else if(!self._shouldBypass){const t=this.fetch(e);t&&e.respondWith(t)}},this._onMessage=e=>{let t;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){return}else t=e.data;if(t&&t.applicationId){const e=this._applications.get(t.applicationId);e&&e.message(t)}self._postMessageController.onMessageReceived(e)},this._controllerFactory=e}start(){this._context=(new f.e).initialize(),self.addEventListener("install",this._onInstall),self.addEventListener("activate",this._onActivate),self.addEventListener("sync",this._onSync),self.addEventListener("periodicsync",this._onPeriodicSync),self.addEventListener("message",this._onMessage),self.addEventListener("fetch",this._onFetch),self.addEventListener("statechange",this._onStateChange)}register(e){e&&this._applications.set(e.applicationId,e)}unregister(e){const t=this._applications.get(e);t&&(t.deactivate(),this._applications.delete(e))}get enablePeriodicSync(){return!1}isNavigationIntercepted(e){return"GET"===e.method&&!this._bypassQueryString.test(e.url)}isNavigation(e){return e.request.mode===a.Navigate}isInPlaceNavigation(e){return"true"===e.request.headers.get(l.t.InPlaceNav)}isPrefetch(e){return!(!e.request.headers.get(l.t.NavPrefetch)&&!e.request.headers.get(l.t.LkgPrefetch))}readResponseHeader(e,t,n,a){const i=Object(o.t)("Router.readResponseHeader",e),c=e.request.url;return t.then(t=>{if(t.ok){const o=t.headers.get(l.t.ApplicationId);if(o){Object(s.e)(i,{resultType:r.e.Success,resultCode:"Found header"},{App:o}),e.waitUntil(this._saveRoute(c,o));const d=this.navigateTo(o,e,Promise.resolve(t),n,a);if(d)return d}Object(s.t)(i,void 0,"Missing header",!0)}return t}).catch(e=>this._abandon(e,c,i))}navigateTo(e,t,n,a,i){let r=this._applications.get(e);if(r||this.register(r=this._controllerFactory.createController(e)),r){const e=i?t.clientId:this._startSession(t,r);return r.navigate(t,n,e,a)||n}}navigate(e,t,n,a){return this._context.then(i=>{const r=i.config.lookupRoute(e.request.url);return r?this.navigateTo(r,e,t,n,a)||t:this.readResponseHeader(e,t,n,a)})}fetch(e){let t=this._clients.get(e.clientId);if(!t&&(t=this._clients.get(""))&&(this._startSession(e,t),this._clients.delete("")),t)return this.isInPlaceNavigation(e)?this.navigate(e,p(e.request.url,!0),!0,this.isPrefetch(e)):t.fetch(e)}getNavigationPreloadResponse(e){return d.e.current.firefox&&+((navigator.userAgent.match(/Firefox\/([0-9]+)\./)||[])[1]||0)<107?p(e.request.url):e.preloadResponse||p(e.request.url)}_startSession(e,t){e.replacesClientId&&this._clients.delete(e.replacesClientId);const n=e.resultingClientId||e.clientId;return n?(this._clients.set(n,t),n):(this._clients.has("")||this._clients.set("",t),"")}_restoreClients(){return Promise.all([self.clients.matchAll(),this._context]).then(e=>{const t=e[0],n=e[1];for(const e of t){const t=n.config.lookupRoute(e.url);if(t){let n=this._applications.get(t);!n&&(n=this._controllerFactory.createController(t))&&this._applications.set(t,n),n&&this._clients.set(e.id,n)}}})}_saveRoute(e,t){return this._context.then(n=>n.config.saveRoute(e,t).catch(e=>{console.error(e)}))}_abandon(e,t,n){return console.error(e),Object(s.t)(n,e,"ReadResponseHeaderError"),fetch(h(t),{credentials:"include",headers:{Accept:"text/html"}})}_executeLifecycle(e,t){const n=[];return(t||this._applications).forEach(t=>{t&&n.push(e(t))}),n}_installControllers(e){let t;return this._executeLifecycle(n=>{const a=performance.now();return n.install().catch(e=>{t=e}).then(()=>{const i=performance.now()-a;if(e[n.applicationId]=i,t)throw console.error(t),console.warn(`[Router] Installed controller with error: ${n.applicationId} (${(i/1e3).toFixed(2)}s)`),t;console.log(`[Router] Installed controller: ${n.applicationId} (${(i/1e3).toFixed(2)}s)`)})})}_installRoutes(){const e=[];return this._applications.forEach(t=>{const n=t.knownPaths();n&&n.forEach(n=>{e.push(Object.assign(Object.assign({},n),{applicationId:t.applicationId,lastRead:new Date}))})}),this._context.then(t=>t.config.saveRoutes(e))}_enableNavigationPreload(){const e=self.registration.navigationPreload;return e&&e.getState().then(t=>!t.enabled&&e.enable().catch(e=>Promise.reject(new i.e({code:"EnableNavigationPreloadFailed",innerError:e}))))}_registerPeriodicSync(){if(self.registration.periodicSync&&this.enablePeriodicSync)return navigator.permissions.query({name:"periodic-background-sync"}).catch().then(e=>{if(e){const t=()=>"granted"===e.state&&self.registration.periodicSync.register(u.e.Maintain,{minInterval:864e5,minDelay:6e4}).then().catch(e=>Promise.reject(new i.e({code:"RegisterPeriodicSyncFailed",innerError:e})));if("granted"===e.state)return t();e.onchange=t}})}_syncApplications(e,t){const n=this._executeLifecycle(t=>Promise.resolve(t.willSync(e)).catch(),t);return Promise.all(n).then(()=>Promise.all(this._executeLifecycle(t=>Promise.resolve(t.sync(e)).catch(e=>{console.error(e)}),t)))}_sync(e){let t;try{t=JSON.parse(e.tag)}catch(e){return}if(t.tag){const n=t.applicationId?[this._applications.get(t.applicationId)]:Array.from(this._applications.values()),a=this._syncApplications(t,n);e.waitUntil(a)}}}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}))},function(e,t,n){"use strict";function a(e,t,n){const a=t.length,i=e.indexOf(t)+a;if(i>=a)return e.substring(i,void 0!==n?e.indexOf(n,i):void 0)}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a,i=n(28),r=n(9),o=n(10),s=n(3),c=n(34),d=n(31),l=n(8);!function(e){e[e.MaxPages=8]="MaxPages",e[e.MaxSites=5]="MaxSites"}(a||(a={}));class u extends c.e{get state(){return this._state}get stats(){return this._stats}getState(){return Object.assign({},this._state)}getPage(e){return this._getPageOrSite(e,u._pageCache,l.e.prototype.getPage)}savePage(e){return this._savePageOrSite(e,u._pageCache,l.e.prototype.savePage)}deletePage(e){return this._deletePageOrSite(e,u._pageCache,l.e.prototype.deletePage)}getSite(e){return this._getPageOrSite(e,u._siteCache,l.e.prototype.getSite)}getPageAndSite(e){const t=u._pageCache.get(e=Object(r.e)(e));if(t){const e=u._siteCache.get(t.sitePath);if(e)return Promise.resolve([t,e])}const n=new l.e;return n.open().then(()=>Promise.resolve(t||this._getPageOrSite(e,u._pageCache,l.e.prototype.getPage,n)).then(e=>e&&e.sitePath?this._getPageOrSite(e.sitePath,u._siteCache,l.e.prototype.getSite,n).then(t=>(n.close(),[e,t])):[e,void 0]))}saveSite(e){return this._savePageOrSite(e,u._siteCache,l.e.prototype.saveSite)}deleteSite(e){return this._deletePageOrSite(e,u._siteCache,l.e.prototype.deleteSite)}save(e,t,n){const a=new l.e;return a.open().then(()=>Promise.all([e&&this._saveState(e,a),t&&this._savePageOrSite(t,u._pageCache,l.e.prototype.savePage,a),n&&this._savePageOrSite(n,u._siteCache,l.e.prototype.saveSite,a)]).then(a.close.bind(a)))}deletePageAndSite(e,t){const n=new l.e;return n.open().then(()=>Promise.all([e&&this._deletePageOrSite(e,u._pageCache,l.e.prototype.deletePage,n),t&&this._deletePageOrSite(t,u._siteCache,l.e.prototype.deleteSite,n)]).then(n.close.bind(n)))}saveState(e){const t=new l.e;return t.open().then(this._saveState.bind(this,e,t)).then(t.close.bind(t))}createDatabase(){return new l.e}loadConfig(e){return Promise.all([this._loadState(e),this._loadPages(e),this._loadSites(e),this._loadStats(e)]).then()}emitStats(e){const t=new d.e;return Promise.all([e.computeStats(),t.open().then(t.getAllRoutes.bind(t)),navigator.storage.estimate().catch(),indexedDB.databases&&indexedDB.databases(),caches.keys()]).then(n=>{t.close();const a=Object.assign({version:self._swBuildNumber,storage:n[2],databases:n[3]&&n[3].length,caches:n[4].length,routes:n[1].length},n[0]);return Object.assign(this._stats,a),e.saveStats(a)})}maintainDatabase(e){return Promise.resolve(super.maintainDatabase(e)).then(this.emitStats.bind(this,e))}getChangedState(e){const t={},n=Object.keys(e);for(const a of n)Object(i.isEqual)(e[a],this._state[a])||(t[a]=e[a]);return t}_getPageOrSite(e,t,n,a){const i=t.get(e=Object(r.e)(e));if(i)return Promise.resolve(i);let o,s;return a?o=Promise.resolve():(o=(a=new l.e).open(),s=!0),o.then(()=>n.call(a,e).then(n=>(n&&t.set(e,n),s&&a.close(),n)))}_savePageOrSite(e,t,n,a){let i,r;return t.set(e.path,e),a?i=Promise.resolve():(i=(a=new l.e).open(),r=!0),i.then(()=>n.call(a,e).then(()=>{r&&a.close()}))}_deletePageOrSite(e,t,n,a){let i,o;return t.delete(e=Object(r.e)(e)),a?i=Promise.resolve():(i=(a=new l.e).open(),o=!0),i.then(()=>n.call(a,e).then(()=>{o&&a.close()}))}_ensureCacheState(e){if(!this._state.cache||!this._state.cache.l1){const t={l1:Object(o.e)(s.a),l1Created:new Date};return this._state.cache=t,e.saveState({cache:t})}}_loadState(e){return e.getState().then(t=>(this._state=t,this._ensureCacheState(e)))}_saveState(e,t){const n=this.getChangedState(e);if(n&&Object.keys(n).length)return Object.assign(this._state,n),t.saveState(n)}_loadPages(e){return u._pageCache.clear(),e.getTopPages(a.MaxPages).then(e=>{const t=e.length;for(let n=0;n<t;n++){const t=e[n];u._pageCache.set(t.path,t)}})}_loadSites(e){return u._siteCache.clear(),e.getRecentSites(a.MaxSites).then(e=>{const t=e.length;for(let n=0;n<t;n++){const t=e[n];u._siteCache.set(t.path,t)}})}_loadStats(e){return e.getStats().then(e=>{this._stats=e})}}u._pageCache=new Map,u._siteCache=new Map;class f extends u{static _ctoi(e){const t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63}static get current(){return this._current||(this._current=new f)}isKillswitchActivated(e){return this.state&&this.state.killswitches2&&this.state.killswitches2[e.toUpperCase()]}isFlightEnabled(e,t){if(!t&&!(t=this.state&&this.state.flights))return!1;e>=6e4&&(e-=57999);const n=e>>5;return n<t.length&&0!=(t[n]&1<<(31&e))}getExperimentVariant(e,t){if(t||(t=this.state&&this.state.experiments)){if((e-=9e4)>Math.floor(3*t.length/2)-1)return 0;const n=Math.floor(e/3*2);switch(e%3){case 0:return f._ctoi(t[n])>>2;case 1:return(3&f._ctoi(t[n]))<<2|f._ctoi(t[n+1])>>4;case 2:return 15&f._ctoi(t[n])}}return 0}install(){return Promise.resolve()}}},function(e,t,n){"use strict";var a=n(13);t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return D}),n.d(t,"n",function(){return w}),n.d(t,"t",function(){return A});var a,i=n(28),r=n(26),o=n(21),s=n(16),c=n(5),d=n(11),l=n(29),u=n(42),f=n(35),p=n(33),m=n(9),_=n(37),h=n(32),b=n(34),g=n(3),v=n(38),y=n(6);!function(e){e.Name="SPFx.Config",e.MetadataStoreName="Metadata",e.ManifestStoreName="Manifest",e.ManifestKeyPath="id",e.ScriptSyncStateKey="ScriptSyncState",e.Generation1Key="Generation1"}(a||(a={}));class S extends y.t{constructor(){super(a.Name,1)}getScriptSyncState(){const e=this.store(a.MetadataStoreName,y.e.ReadOnly);return this.getValue(a.ScriptSyncStateKey,e)}setScriptSyncState(e){const t=this.store(a.MetadataStoreName,y.e.ReadWrite);return this.putValue(a.ScriptSyncStateKey,e,t)}getGeneration1(){const e=this.store(a.MetadataStoreName,y.e.ReadOnly);return this.getValue(a.Generation1Key,e)}saveGeneration1(e){const t=this.store(a.MetadataStoreName,y.e.ReadWrite);return this.putValue(a.Generation1Key,e,t)}getManifests(e){return new Promise((t,n)=>{const i=this.store(a.ManifestStoreName,y.e.ReadOnly),r=[];let o=0;e.forEach(e=>{const a=i.get(e);++o,a.onerror=()=>{n(a.error)},a.onsuccess=()=>{r.push(a.result),0==--o&&t(r)}})})}getAllManifests(){const e=this.store(a.ManifestStoreName,y.e.ReadOnly);return this.getAll(e)}saveManifests(e,t,n){const i=this.store(a.ManifestStoreName,y.e.ReadWrite);return Promise.resolve(t&&this.clearStore(i)).then(()=>this.putMany(e,i).then(()=>n&&this.setScriptSyncState(n)))}deleteManifests(e){const t=this.store(a.ManifestStoreName,y.e.ReadWrite),n=[],i=e.length;for(let a=0;a<i;a++)n.push(this.delete(e[a],t));return Promise.all(n).then()}upgrade(e,t){this.createKeyValueStore(a.MetadataStoreName,e),this.createStore(a.ManifestStoreName,a.ManifestKeyPath,e)}}var D,I=n(2),x=n(0);function C(e){return!!e.version}function O(e){return!!e.versions}function w(e){return"component"===e.type}!function(e){e[e.WebPart=1]="WebPart",e[e.Application=2]="Application",e[e.Library=3]="Library",e[e.Extension=4]="Extension",e[e.ProviderHostedApp=5]="ProviderHostedApp",e[e.Assembly=6]="Assembly",e[e.AdaptiveCardExtension=7]="AdaptiveCardExtension"}(D||(D={}));const E="securebroker.sharepointonline.com"===self.location.host;class A extends b.e{constructor(){super(...arguments),this.assemblyMode=!0,this._scriptSyncState=[],this._manifests=[]}static get current(){return this._current||(this._current=new A)}get manifests(){return this._manifests[0]}get scriptSyncState(){return this._scriptSyncState[0]}requiresScriptSync(e,t){const n=this._scriptSyncState[0];if(!n||!n.lastSync||!n.langs||!this._manifestCount||this._manifestCount<n.manifestCount)return!0;if(!t&&Math.floor(((new Date).getTime()-n.lastSync.getTime())/864e5)>21)return!0;const a=e&&e.length||0;for(let t=0;t<a;t++)if(!n.langs.has(e[t]))return!0;return!1}getComponent(e,t,n){const a=this._manifests[n||0];return a&&this._getComponent(a.get(e),t)}scriptUrl(e,t,n){let a=this._scriptUrlCache.get(t);a||this._scriptUrlCache.set(t,a=new Map);const i=this._cacheKey(e,n);let r=a.get(i);if(!r){const o=this.getComponent(e,n);o&&(r=this._computeScriptUrl(o,t),a.set(i,r))}return r||""}scriptUrls(e,t){const n=e&&e.length||0;if(n){const a=new Set;for(let i=0;i<n;i++){const n=this.scriptUrl(e[i],t);n&&a.add(n)}return Array.from(a)}}loaderAssemblyUrl(e){return this.scriptUrl(I.e.LoaderAssembly,e)}getGeneration(e){var t;const n=e.request.headers.get(v.e.Version);if(n&&n!==this._scriptSyncState[0].version){if(n===(null===(t=this._scriptSyncState[1])||void 0===t?void 0:t.version))return Promise.resolve(1);if(!this._loadedGeneration1){const e=new S;return e.open().then(()=>e.getGeneration1().then(t=>(e.close(),this._loadedGeneration1=!0,t&&(this._scriptSyncState[1]=t.scriptSyncState,this._manifests[1]=t.manifests,n===t.scriptSyncState.version)?1:0)))}}return Promise.resolve(0)}old_getGeneration(e){const t=e.request.headers.get(v.e.Version),n=t&&this._scriptSyncState[1]&&t===this._scriptSyncState[1].version?1:0;return!n&&p.e.current.webView&&this.deleteGeneration(1),n}getComponents(e,t,n){void 0===n&&(n=0),t&&t!==this._lang&&this._scriptSyncState[n]&&this._scriptSyncState[n].langs.has(t)&&this._localizeDefault(this._manifests[n],t);const a=this._getDependencies(e,this._manifests[n]);return Array.from(a)}findComponents(e,t,n){if(n)return this.getGeneration(t).then(n=>{const a=[],i=[],r=e.length;for(let t=0;t<r;t++){const r=e[t],o=this.getComponent(r.id,r.version,n);(null==o?void 0:o.isInternal)?a.push(r):i.push(r)}return this._fetchAndSaveComponents(i,n,t).then(()=>this.getComponents(a.concat(i),void 0,n))});{const n=this.old_getGeneration(t),a=[],i=[],r=e.length;for(let t=0;t<r;t++){const r=e[t],o=this.getComponent(r.id,r.version,n);(null==o?void 0:o.isInternal)?a.push(r):i.push(r)}return this._fetchAndSaveComponents(i,n,t).then(()=>this.getComponents(a.concat(i),void 0,n))}}syncManifests(e,t,n){if(t||this.requiresScriptSync(e)){const a=Object(c.t)("SpfxConfig.syncScript"),i=new S;return i.open().then(()=>this.loaded?this._syncManifests(e,i,n):this.loadConfig(i).catch(e=>{if(!t)throw e}).then(()=>(t||this.requiresScriptSync(e)||!this._manifests[0]||!this._manifests[0].size)&&this._syncManifests(e,i,n))).catch(e=>{throw Object(d.t)(a,e),i.close(),e}).then(()=>{Object(d.e)(a,{resultType:o.e.Success}),i.close()})}}saveManifests(e,t){const n=[],a=e.length;for(let r=0;r<a;r++){const a=e[r],o=this._manifests[t||0].get(a.id);o&&Object(i.isEqual)(o,a)||(this._unload(a,!0,t),n.push(a))}if(n.length&&!t){const e=new S;return e.open().then(()=>e.saveManifests(n)).then(()=>{e.close()})}}deleteManifests(e){const t=e&&e.length;if(t){for(let n=0;n<t;n++){const t=this._manifests[0].get(e[n]);t&&this._unload(t)}const n=new S;return n.open().then(()=>n.deleteManifests(e)).then(()=>{n.close()})}}sync(){return this.syncManifests(void 0,!0)}deleteGeneration(e){this._scriptSyncState[e]=this._manifests[e]=void 0}createDatabase(){return new S}loadConfig(e,t){return Promise.all([!t&&e.getAllManifests(),e.getScriptSyncState()]).then(e=>{if(t&&(this._scriptSyncState[0]=e[1]),e[1]&&(this._lang=e[1].lang),!t)return this._loadConfig(e[1],e[0])})}_toMap(e){const t=new Map,n=e.length;for(let a=0;a<n;a++){const n=e[a];t.set(n.id,n)}return t}_cacheKey(e,t){return`${e}${t?"_"+t:""}`}_saveGeneration1(e,t){const n=new S;return n.open().then(()=>n.saveGeneration1({scriptSyncState:e,manifests:t})).then(n.close.bind(n))}_loadConfig(e,t){this._manifestCount=t.length,this._dependencies=new Map,this._manifests[0]&&this._scriptSyncState[0]&&e&&this._scriptSyncState[0].version!==e.version&&this._saveGeneration1(this._scriptSyncState[1]=this._scriptSyncState[0],this._manifests[1]=this._manifests[0]),this._scriptSyncState[0]=e,this._manifests[0]=this._toMap(t),this._scriptUrlCache=new Map}_getComponents(e){if(!e||C(e))return[e];const t=[];if(O(e))for(const n in e.versions)e.versions.hasOwnProperty(n)&&t.push(e.versions[n]);return t}_getComponent(e,t){if(!e||C(e))return e;if(O(e)){const n=e.versions;if(n[t])return n[t];const a=Object.keys(n).sort(_.e),i=a.length;if(!t)return n[a[i-1]];for(let e=0;e<i;e++)if(Object(_.t)(a[e],t)||e===i-1)return n[a[e]]}}_localizedValue(e,t){return e&&(e[t]||e[t.split("-")[0]])}_copyLocalizedValues(e,t){for(const n in t)"default"===n||e[n]||(e[n]=t[n])}_mergePaths(e,t){const n=t.loaderConfig,a=n.scriptResources[n.entryModuleId];if(a&&"localizedPath"===a.type&&a.paths){const t=e.loaderConfig.scriptResources[e.loaderConfig.entryModuleId];this._copyLocalizedValues(t.paths||(t.paths={}),a.paths)}}_mergePreconfiguredEntries(e,t){const n=t.preconfiguredEntries;if(n){const t=e.preconfiguredEntries,a=n.length;for(let e=0;e<a;e++){const a=t[e],i=n[e];i.group&&this._copyLocalizedValues(a.group||(a.group={}),i.group),i.title&&this._copyLocalizedValues(a.title||(a.title={}),i.title),i.description&&this._copyLocalizedValues(a.description||(a.description={}),i.description)}}}_mergeManifests(e,t){return e.getAllManifests().then(e=>{const n=this._toMap(e),a=t.length;for(let e=0;e<a;e++){const a=t[e],i=this._getComponents(a),r=n.get(a.id),o=this._getComponents(r);for(let e=0;e<o.length;e++)this._mergePaths(o[e],i[e]),this._mergePreconfiguredEntries(o[e],i[e]);this._manifests[0].has(r.id)&&this._manifests[0].set(r.id,r)}return e})}_localizeDefaultStrings(e){const t=e.preconfiguredEntries,n=t&&t.length||0;for(let e=0;e<n;e++){const n=t[e],a=this._localizedValue(n.group,this._lang);a&&(n.group.default=a);const i=this._localizedValue(n.title,this._lang);i&&(n.title.default=i);const r=this._localizedValue(n.description,this._lang);r&&(n.description.default=r)}}_localizeDefaultPath(e){const t=e.loaderConfig,n=null==t?void 0:t.scriptResources[t.entryModuleId];if(n&&"localizedPath"===n.type){const e=this._localizedValue(n.paths,this._lang);e&&(n.defaultPath=e,n.paths&&(n.paths.default=e))}}_localizeDefault(e,t){this._lang=t;const n=e.entries();let a;for(;!(a=n.next()).done;){const e=this._getComponents(a.value[1]);for(const t of e)this._localizeDefaultStrings(t),this._localizeDefaultPath(t)}}_addDependencyRecursive(e,t,n){if(!e||n.has(e))return;let a;n.add(e);const i=e.loaderConfig&&e.loaderConfig.scriptResources;if(i){const e=Object.keys(i);a=e.length;for(let r=0;r<a;r++){const a=i[e[r]];w(a)&&this._addDependencyRecursive(this._getComponent(t.get(a.id),a.version),t,n)}}const r=e.preloadComponents;a=r&&r.length||0;for(let e=0;e<a;e++){const a=r[e];this._addDependencyRecursive(this._getComponent(t.get(a)),t,n)}}_getDependencies(e,t){const n=new Set,a=e.length;for(let i=0;i<a;i++){let a=e[i];"string"==typeof a&&(a={id:a});const r=this._getComponent(t.get(a.id),a.version);if(r){let e=this._dependencies.get(r);e||(this._dependencies.set(r,e=new Set),this._addDependencyRecursive(r,t,e));const a=e.values();let i;for(;!(i=a.next()).done;)n.add(i.value)}}return n}_addLangs(e){const t=e&&e.length||0;for(let n=0;n<t;n++){const t=e[n];this._scriptSyncState[0].langs.has(t)||(this._scriptSyncState[0].langs.add(t),this._scriptUrlCache&&this._scriptUrlCache.delete(t))}}_saveConfig(e,t,n,a){const i=this._scriptSyncState[0],r=i&&i.version===n&&this._manifestCount>=i.manifestCount,o=r&&i.lang||a[0],s={version:n,lang:o,langs:r&&i.langs||new Set,lastSync:new Date,manifestCount:t.length};return r?this._scriptSyncState[0]=s:(this._localizeDefault(t,o),this._loadConfig(s,t)),this._addLangs(a),Promise.resolve(r&&this._mergeManifests(e,t).then(e=>{t=e})).then(()=>e.saveManifests(t,!1,this._scriptSyncState[0]))}_onScriptSynced(){if(!h.e){const e={name:s.t.ScriptSynced,data:{version:this._scriptSyncState[0].version}};Object(f.e)(e)}}_installedLangs(e){return(this.loaded?Promise.resolve():this.loadConfig(e,!0)).then(()=>Array.from(this._scriptSyncState[0]&&this._scriptSyncState[0].langs||[]))}_syncManifests(e,t,n){return Promise.resolve(e||this._installedLangs(t)).then(e=>{const a=!E&&n?Object(m.e)(n.path):"",i=`${g.e}${a}/_layouts/15/SPComponentRegistry.ashx?languages=${encodeURIComponent("["+(e&&e[0]?'"'+e.join('","')+'"]':"]"))}`;return Object(l.e)(i).then(n=>{if(!n||!n.ok)throw new r.e(Object(u.e)(n));const a=n.headers.get("X-SPClient-BuildNumber");return e&&e.length||(e=[n.headers.get("X-SPClient-Language")]),n.json().then(n=>{const i=Array.isArray(n)?n:JSON.parse(n.value);return this._saveConfig(t,i,a,e).then(this._onScriptSynced.bind(this))})})})}_saveComponents(e,t){const n=[],a=e.length;for(let i=0;i<a;i++){const a=e[i],r=this._manifests[t].get(a.id);r?O(r)&&!r.versions[a.version]?(r.versions[a.version]=a,n.push(r)):a.isInternal||n.push(a):n.push(a)}return this.saveManifests(n,t)}_fetchComponents(e,t){const n={components:e,project:I.e.SiteApplication},a=t.request.headers.get("x-requestdigest");return fetch(t.request.url,{credentials:"include",headers:Object.assign(Object.assign({},a&&{"x-requestdigest":a}),{Accept:"application/json","Content-Type":"application/json"}),method:"POST",body:JSON.stringify(n)}).then(e=>e.json())}_fetchAndSaveComponents(e,t,n){return Promise.resolve(e.length&&this._fetchComponents(e,n).then(e=>this._saveComponents(e.value.filter(e=>!(!e||!e.Manifest)).map(e=>JSON.parse(e.Manifest)),t)))}_computeScriptUrl(e,t){const n=e.loaderConfig;let a=n.internalModuleBaseUrls[0];a.endsWith("/")||(a+="/");const i=n.scriptResources[n.entryModuleId],r="localizedPath"===i.type?this._localizedValue(i.paths,t)||i.defaultPath:i.path;return a+("string"==typeof r?r:r.path)}_unload(e,t,n){const a=e.id,i=this._cacheKey(a),r=this._getComponents(e);for(const e of r){const t=this._cacheKey(a,e.version),n=this._scriptUrlCache.values();let r;for(;!(r=n.next()).done;)r.value.delete(t),r.value.delete(i);this._dependencies.delete(e)}t?this._manifests[n||0].set(a,e):this._manifests[n||0].delete(a)}}A.durableGen2Killswitch=Object(x.t)(x.e.durableGen2)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error));var r=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,r=t.wrapErrorCode,o=i||void 0,s=o?Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)(Object(a.e)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},c=t.correlationId,d=void 0===c?s.correlationId:c,l=t.isExpected,u=void 0===l?s.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=r&&s.code&&t.code&&"".concat(t.code," (").concat(s.code,")")||t.code||s.code||"",n.extraData=Object(a.e)(Object(a.e)({},s.extraData||{}),f||{}),n}return Object(a.n)(t,e),t}(i)},function(e,t,n){"use strict";n.d(t,"e",function(){return Q}),n.d(t,"t",function(){return $});var a={};n.r(a),n.d(a,"Default",function(){return g}),n.d(a,"Tenant",function(){return v}),n.d(a,"Hub",function(){return y}),n.d(a,"Site",function(){return S});var i=n(28),r=n(45),o=n(13),s="KillSwitchOverrides",c="".concat(s,"_").concat("enableKillSwitches"),d="".concat(s,"_").concat("disableKillSwitches");function l(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function u(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(c,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(d,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}function f(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++){var s=r[i];e[o.normalizeUpper(s,!1)]=!0}if(n)for(var c=0,d=n.split(",");c<d.length;c++)s=d[c],e[o.normalizeUpper(s,!1)]=!1;if(a)for(var l=0,u=a.split(",");l<u.length;l++)"!"===(s=u[l])[0]?e[o.normalizeUpper(s.slice(1),!1)]=!1:e[o.normalizeUpper(s,!1)]=!0;return e}var p={},m=function(){p=f({},l(c),l(d),void 0);var e=function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}(),t=Object(r.e)(e),n=t.enableKillSwitches,a=t.disableKillSwitches,i=t.debugKillSwitches;"undefined"!=typeof DEBUG&&DEBUG&&f(p,n,a,i),u(p);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),p[o.normalizeUpper(e,!1)]=!!t,u(p)}}catch(e){}m=function(){}},_=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=h({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(m(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=h(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=h({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function h(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var i=!1;if(e){var r=o.normalizeUpper(e,!1);r in p?i=!!p[r]:t&&(i=!!t[r])}return i}}}var b,g=0,v=1,y=2,S=3;_.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(b||(b={}));var D,I,x=n(24),C=n(16),O=n(9),w=n(29);D||(D={}),function(e){e.SharePoint="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABmJLR0QA/wD/AP+gvaeTAAAOq0lEQVR42u1dCXBUZRL+uRQ0DwTJiy5P0AGHIm6NEs2uuwqruAUBIQiacEhghQUJJNmQmNOck0wOMrkTrkAIoEQC4T4F5BDWo8Rrq7Z2LXcVt7QoFVZd0ABJ/u3/vX9gEiZzJHO85PVX1ZWAmLx/vu7+u/vv/h8hCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAqEm9LKS3nbE+t8hegDpjNR+IANABJDBIENB/EECuIj8z3eD3AXiB3I7SB8rpUB0Q9L9ZGKXx00JSE4vF9KMJ4Rs0+dCzsofhDxzk5Bf3AJfW4TcwiYhy/SDkJr1hRCXfIZEx9aQeQvC4f8dwRVmAFcGVASVoze33CEkOv4FIcu4Xyws/Uk0V1CxqBykjIorS6lQWEKFgmIq5JupkFdEBdNKRXILqZBTQAVjPhWy86iQlnVZiHnlJJkdsYQrg8AVCxVBhVZ/Gxk3zl9MevUVsaDkC7GkiorFlSBAvrk9+SD57RTAmnxjnqIAWSYqZOZSISOHCvEp35CIlwoJMYzmitAXFUEdxDPXPJDEJr8oriw5L5ZWU7EUyC+xJh9kZRkVOrJ+Rn5767cmP8NIhfRs8Agg8UkXyAvhr3CP0J97HYTPrH7ixAeAvINiWXUrCCefW7/ZlvUXK9af14H1M/KzTW0VIN2okJ+WBZJJhdSMViEy6h3y6KNPwjMMwvjAN+T3J1Gxk4Hkr8Xy1VQsW0VtW3+ZYv2Fdqyfkd+R9adbrD9LkVRQgJQMKiSnUyE2/iIJCXmZZxIYG3iR/DtJfGIEEP6zTH45kF9mTT63fnuBX0fWz8jPyrVt/amy9YMCAPnJaVRISmOxwTUyMzwHnuk+VAIvkR+Qkh4LpF8XKyzkc+svsWX9pYr1F9ixfjnwc2T9mW2tP4krQGIqKEFyMwmbU8bjgtuQJs+RP4AkpkSI5WuuiRVr6A3XX9be9VfcCPxcSvss5GdaAr921p/SzvoTQRJAARJSqBCX2EKmzsyDZ5R4hoBwM24jKxJCgPBfZPIrrF1/NbWf9hXbT/uy82xbf9vAr631J3LrZ+QnJFMSn0RJbPw18sykv/CqYh+kzH3oQ+bOHSGWVvxHrFxL21i/p9O+9oFfspXrl8lPYVuAogBxiZRERv9Ahg17ltcKMEV0U3VvoJBfdPAG+RXtAz9HaZ/ZibQv14H1p7e1/oR21s/IX5EAXgBkwcJz8MwP86okosuuPz5hjli1plWstJC/2kHg56G07xbrT1asP66dAsTGUzJxSj48+724FXTV+p96aiiQfL6N6+9M2mdylPblOJf2ObJ+iwIsXn4Rnv8PIHdgath53C6mZiTI5Fdau/5VTgR+nUz70pxI+9qQD7KinfXHxFESvYKSqdNreH0As4JOpn1DxKLSL28J/OykfR0Hfu5I+1JvWn+8Levn5FsUYOES5gXGE+U4Gb2Ai+hH4lNesB34uSPtMzmR9qXbT/tk8hPbun4L+VGxiox7xkiUhhPMCFy0fj/BWLhfcf2O0j4nAj9PpX22XL+1AsyZ9zGsxYAVQtdTP38g+ifbgV8X074sZ9M+FwO/9tbPZOmyJljLZAwGXUNfEpcwxfm0z4l6f06+62lfkgtpny3yLfL4+DSi9CHiNuBszT8g01jeceDXxbQv051pHyPfgQLMCDsIaxqF2YDzCjBQyC044d60z031fntpny3ymcyL+Aes6TFeGcRtwAkFGCzkl/yr47SvXF1pX7QDBfjTIpYOTsB00PkAcCgQ/aPNtM/s67TPicCvvSyRA8FQorSpW9rHUBHsKIAIhDd5rM0rw5V6f4rjwM+RAkRGNcOaXgIZTpThk0E8K+hHcPDEpgIEgOW3uBb4md3X5tWZtA/+jv0e5qmkVRuoVPsalTa9QaXN26hUB183bLkmra69BAr92X0F5qP+6ZkmMvPFJ2Ct95Cb8waYJdxQgFJQAF+2ed1I++wEfvCV/T6pZjPVb99Lddv2UN0bu6hu606qe30H1W1p4ApQT6WNr4MSgFKs3wz/vo6KazdScfWGVsFc9m8x+dVq6G5+lJW+ecGoN24BxRVNNuv9RV1p88pxrc2ro7QvNlFWRka2fsf+zpG/phYUYD0Vq2uoWLWOKfrPQlJ6I7Sa/5Yo84maHTxRqoAFZT+6fbqnU2lfYhvrZz+fkazfedB95Fda1TvYKNvy5WZeN7hDi96ALfhuIPRLr7R5OZv2wVdGmH7XIc+Rb/F44O2EtIy/kaDxE8jNwRNN1QHuEjJMZ7ve5mVyS5sX+2+MXG+Rb1mrmGn6DgZP5vAych8tKYCff3xyjRravJii6Nle72XylS3OzBT5f+S559h0sqiVUnIvuWS6eHF416d7ulbvly2/3ofkW9aXYbxMnp40n9cQNBETMHc3XCwwX/Z22mep98PIl0/c/i3kW9aWknGRPPzwJKKRdnPlPCA546TdwM/k5nq/lfVLQJxqyGfrYmuKWsGaS8YSZSy95x8Jk5cWvez16R7m+uEgSXXk8/WQ8HlreEm5x8cDbIEjgNBvvNnmxb6X930Vks/W4ZeQcoUYDKF8K+jV072AAC1Vhe5t87Kf9rHUU63kW5QYJo+Owmej5+cHPRr9IPDRA7EX3Jb22WnzYt+7tbzrAfJl7xWXdJVI0vPa8QIvLoiHD6jV09M9jAzVky8/ewrEArO3w2fzgFZigeFA1Dudq/c7P90jrd/SLciXn3vpsgvwuTzJM4Ief2jUn13IBMR+76k2L/Z3+oY93YN89swr4FRy7NhF/KygxytAb3mhz4UtAcKvemK6B4ZQuhH5/Gg6NHSLVlJCS3UwAO7iyQDim92S9lm1ebHuo25FPutLmBvxCVHuIdDM1BHTdInMX1QGQV+zO6d7oF2re5HPWtEWLGJxwHitxAEWMG0fQcLDjfCBXe1cm9etTZ5S7dbuRT7rQ1wU+Qt8FlOIxsbOevECyDASMi0GiL3kjuke1sDZrciX5w7lbuOZhN2bqLH2sV58O/CHsmiI39Loc3DVe6sz9X5ZgAxpHTRyNuyjhkOnaNDJ9+njZz+SJfjMOfjze9Rw+DTV7z5Mda9tp+K6OvWRz2RZTCt8BuFaVADrwJANWxhI6MwcYUXCxQ7TvvQcqtu4lQYd+ysNZkS7IEwh2OGQVLNJPeTfVIBZ/DPQ7GyB0kCi9NePI2Gz1wsx8RdvWD9sDWxvDz79AVj3h12T0+doIHgF2Qv4mvybW0CYlj2AtRL0IcrsHbuT5ykyIaQEegm+Czr+Lg1++5xbJejEe3LM4FPylSCQjZxNJ3j3QDtvEBo6yrD70BnZ6j0o+sYDSs+iL8hnErGQDZ1OJDh0alUnSE7WGQ4c/zTo1PvUGxK457DsAbxOPpPwef+ENf+O4Ng5Dwjnzx9mOHDsExa0eVOYEsg9C94kn0nItN2w7jFa6Atw5qzgLsOuw8eCTrxLfSG6+p3eJX9ZDCUjxyQS5WUVmp4llPsHx2zabgw6/g71pbCpYK+QL186sfC/sO5pWk8B5X3/wSzTI4Yjp64EHTtLfSmGwyeVfgVPky+7/+lvwdofIRq/fk7uGDI07D8adPQMVYPoNm3zPPlLo64T/wej0f2D9Y80rnzCcOR0s+HNt6kq5MgpJRbwFPlMpj//EVG6gTSd/snvD3qovnEnKABVk0g1WzxH/pLIqyRgNHsrya+Ixq+iB9cXdk/gvmM/Gg6fomqSwL1vKucR7iafyYTJ7M7Bx4gGpoMcoZ++al2E4dAJqkaRg0F3kz834it+/DsEUz9w//q6+i2BB9+iahSxaq17yV+0+AoJCIglyqvpNF/4YQowSF+/85PAA8epGkXaWO8+8pdEXoO+hyJYcyCWfW9W/u6GIY5vIQagahRd/W73kR8cXE2UqeA7CV4ld0MB/AN3HWoK3HuUqlHYSaFb3L5i+WN5xQ/Jt1KAgMBdh1sC9xyhahTWQdQl8uctuACX5bHX1D+Elt+BAuh3HWxhfXuqFJgw7nSe/3TIIaJ0+txPNNby7YoCiPrt+5rkixzUKA17XS/vsgqfUuQJJsp9QPg2cjsKMPSBrY3fy7P8KhTd5gbnT/WmTT9B/P2jYE3s7uB7udWjy3egAENG1m79Owu21CjSqvWtYNUtcucuE/b9YujhY21crJOHNXOMNCTwI92x/GCnP7l5nTzCQR1goFS5tlG/Yx9Vo4jGAtauFQcyF2Q239NZAyfr4WNtXGM46X78SBeJd1EB+vtnm5azeX41SkBkTC0v3AziJLNI/g5+gnc739+R9C6AfXijdK81XNaxuX41yeZt1+HZFvCavfUbQqwF4QYvMFgqX3NM98ZuqiYR882fEXxlrHe2AbJw+QxdfWMLa8pUhby+ozVgxowCnsPja+K8sA3cI5Wvel+3tZGqQWBI5Dw8UwjRwA1eavECA8isWZN1dQ1N8ny/L6WuvplMmmRE6/e+FxgqZpnWslFuX4oQl3iSF3NwVs/LYCmVXiyuOiexSx58IP75xV/xXF9TL3dQ11ag1/8G3jf8ubSZva7NexJQWnUJfvcyotzY1Q/p8F152I88Of2PcIHDeWkTXPPiBQkorbxEDE+wY9tRvKKHrt/HSjAQLlAcLxaVfizVbaWeFP/cwq/I6NGR8DtHEmzVUpkngAMWMSl1i7Su7ppUCxc+uVPWbmwWouNO8j1/OJKv1iIRu0x56tT5Yl7xp3DTV6t861dXBH6GaMw/T8ZPyIKf/Xse8PVF8tWrBCwgG0zYbZphYVFSTt4HUnVNk3z1mytSVXNdzMj+jEybVsCLPPcTjb7UsbtuCcxFs4OZX4M8K/55qVnIyD4Lr6D5Gm77uiKt3tAsrdvYKsvqDeyl1b/AbR/fDkxK/5BELFhPlIOd8Zx4P7T67ukNenOPwI5l2Y1igbxowyx6BlHu25vF93X2SpZniDKCpePKMwCJ7znK0IcrQ39O7J1cbJ3b9+XKg8T3UGVwJAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBALRw/B/rxUowV9lSa8AAAAASUVORK5CYII="}(I||(I={}));var E=n(41),A=n(7);const L="SuiteNavPlaceholder";var k;!function(e){e.BlackForest="https://shell.cdn.office.net/api/de/ShellBootstrapper/business/OneShell",e.Gallatin="https://shell.cdn.office.net/api/cn/ShellBootstrapper/business/OneShell",e.Pathfinder="https://shell.cdn.office.net/api/mil/ShellBootstrapper/business/OneShell",e.Prod="https://shell.cdn.office.net/api/ShellBootstrapper/business/OneShell",e.Trailblazer="https://shell.cdn.office.net/api/us/ShellBootstrapper/business/OneShell",e.USNat="https://shell.azurefd.eaglex.ic.gov/api/shellbootstrapper/business/oneshell",e.USSec="https://shell.azurefd.microsoft.scloud/api/shellbootstrapper/business/oneshell"}(k||(k={}));var M=n(21),P=n(26),T=n(5),U=n(11),F=n(17),H=n(36),R=n(42),N=n(20),B=n(10),j=n(3),V=n(0);const z="https://securebroker.sharepointonline.com",G="delete __authenticatedError;delete __authenticatedSuccess;";function K(e){return`__authenticatedSuccess({didAuthenticate:${e}});${G}`}const W=`__authenticatedError();${G}`;var q,Q,Y=n(14),J=n(35),X=n(30),Z=n(4);!function(e){e.Title="SharePoint",e.Generator="Microsoft SharePoint (Service worker)",e.Manifest="/_layouts/15/spwebappmanifest.ashx?app=Sites",e.ShortcutIcon="/_layouts/15/images/favicon.ico?rev=43"}(q||(q={})),function(e){e.headStart="headStart",e.preconnectStart="preconnectStart",e.preconnectEnd="preconnectEnd",e.scriptPreloadStart="scriptPreloadStart",e.scriptPreloadEnd="scriptPreloadEnd",e.moduleLoaderScriptStart="moduleLoaderScriptStart",e.moduleLoaderScriptEnd="moduleLoaderScriptEnd",e.headEnd="headEnd",e.bodyStart="bodyStart",e.bodyEnd="bodyEnd",e.executionScriptStart="executionScriptStart",e.executionScriptEnd="executionScriptEnd",e.spModuleLoaderPrestart="spModuleLoaderPrestart",e.spModuleLoaderStart="spModuleLoaderStart",e.suiteNavScriptStart="suiteNavScriptStart",e.suiteNavScriptEnd="suiteNavScriptEnd",e.suiteNavRenderScriptStart="suiteNavRenderScriptStart",e.suiteNavRenderScriptEnd="suiteNavRenderScriptEnd",e.suiteNavScriptAsyncEnd="suiteNavScriptAsyncEnd",e.suiteNavRenderAsyncEnd="suiteNavRenderAsyncEnd",e.postFlush="postFlush",e.spWorkerInit="spWorkerInit",e.spWorkerStarted="spWorkerStarted"}(Q||(Q={}));class $ extends class{constructor(e,t){this.controller=e,this.context=t}navigate(e,t,n,a){if(this._request=e.request,this._url=new URL(this._request.url),this._clientId=n,this._qosMonitor=Object(T.t)("BaseNavigationHandler.navigate",n&&e),this._inPlace=a)return this.inPlaceNavigate(e,t);const i=new A.e;let r,o;try{r=this.initialize(e,t).then(this.render.bind(this,i)).catch(e=>this.onError(i,o=e)).then(this.endResponse.bind(this,i)).then(()=>this.finalize(!o))}catch(e){r=Promise.all([this.onError(i,e),this.finalize(!1)]).then()}return n&&e.waitUntil(r),this.startResponse(i)}get inPlace(){return this._inPlace}get offlineMode(){return this.startOffline&&(this._offline||this.state.offline)}get appDataEnabled(){return!1}get preloadResponseReady(){return this._preloadResponseReady}get navigationResultReady(){return this._navigationResult?Promise.resolve():this._preloadResponseReady}get navigationResult(){return this._navigationResult}set navigationResult(e){this._navigationResult=e}get navigationResultKey(){}get state(){return this._state}get page(){return this._page}get pageFromConfig(){return this._pageFromConfig}get siteFromConfig(){return this._siteFromConfig}get navigationResultFromConfig(){return this._navigationResultFromConfig}get lkgFromConfig(){return this._lkgFromConfig}get site(){return this._site}get request(){return this._request}get url(){return this._url}get canonicalPath(){return Object(O.e)(this._request.url)}get lang(){return this.site&&this.site.lang||this.context.userAgent.lang}get offline(){return!!this._offline}get preloadResponse(){return this._preloadResponse}get redirected(){return this._redirected}get notFound(){return this._notFound}get error(){return this._error}set error(e){this._error=e}get deleted(){return this._deleted}get endedResponse(){return this._endedResponse}get clientId(){return this._clientId}get client(){return self.clients.get(this._clientId)}bypassUrl(e){return Object(N.e)(e||this._url.href)}headersInit(){return{"Content-Type":"text/html; charset=utf-8","Transfer-Encoding":"Chunked"}}responseInit(){return{headers:this.headersInit()}}inPlaceNavigate(e,t){let n;const a=this.initialize(e,t).then(()=>this._preloadResponseReady).catch(t=>(this.failQosMonitor(n=t),this._processPreloadResponse(e,Object(w.e)(this._url.href)))).then(()=>new Response(this.renderJson(),{headers:{"Content-Type":"application/json"}})),i=a.catch(e=>{this.failQosMonitor(n=e)}).then(()=>this.finalize(!n));return e.waitUntil(i),a}onError(e,t){return this.failQosMonitor(this._error=t),console.error(t),Promise.resolve((!this.offlineRenderingErrorThrowsKillswitch||!this._offline)&&this.abandon(e,!0))}loopbackPath(e){return j.n+e}createState(){return{cache:this._state.cache,offline:this._offline,wasOffline:this.state.offline}}createPage(){const e=new Date,t=(this._page&&this._page.reads||0)+1,n={path:this.canonicalPath,applicationId:this.controller.applicationId,lastRead:e,reads:t,rank:this._computeRank(t,e)};return this.startOffline&&(this.navigationResultKey?(n.navigationResults=this._page&&this._page.navigationResults||new Map,n.navigationResults.set(this.navigationResultKey,this.navigationResult)):n.navigationResult=this.navigationResult),this.appDataEnabled&&this._page&&(n.lkgData=this._page.lkgData),n}createSite(){const e=new Date;return Object.assign({lastRead:e},this._site)}updateModels(e){e===this._navigationResultFromConfig&&(this._state=this.createState(),this._site=this.createSite(),this._page=this.createPage())}createStats(e){return{version:self._swBuildNumber,durations:e.durations,pageFromConfig:this._pageFromConfig,siteFromConfig:this._siteFromConfig,navigationResultFromConfig:this._navigationResultFromConfig,lkgFromConfig:this._lkgFromConfig,offline:this.offline,site:this.context.config.stats}}get stats(){return this._stats}postRender(){}initializeOfflineMode(e,t){return this._offline=!0,Promise.resolve()}parseNavigationResult(e){const t=e.headers.get("content-type");return!t||t.includes("application/json")?e.json():e.text()}processNavigationResult(){this.updateModels(!1)}hydrateNavigationResult(){return Promise.resolve()}isConfigValid(){return this._pageFromConfig&&this._siteFromConfig&&this._state&&!!this._state.user}initialize(e,t){return this._preloadResponse=t,this._state=this.context.config.getState(),this.context.config.getPageAndSite(this._url.pathname).then(e=>(this._siteFromConfig=!!(this._site=e[1]),this._page=e[0],this._navigationResult=(this._pageFromConfig=!!this._page)&&this.startOffline&&(this.navigationResultKey&&this._page.navigationResults?this._page.navigationResults.get(this.navigationResultKey):this._page.navigationResult),this._lkgFromConfig=this._pageFromConfig&&!!this._page.lkgData,this._navigationResultFromConfig=!!this._navigationResult,this._navigationResultFromConfig&&this.hydrateNavigationResult().then(()=>{this._navigationResultFromConfig=!!this._navigationResult}))).then(this._processPreloadResponse.bind(this,e,t))}saveConfig(){return this._offline?Promise.resolve(!this.state.wasOffline&&this.context.config.saveState({offline:!0,wasOffline:!0})):this.context.config.save(this._state,this._page,this._site)}finalize(e){return e&&this.endQosMonitor({resultType:M.e.Success}),this.saveConfig()}redirect(e,t){const n=()=>{t.inlineScript(`location.href='${e}'`,!0),t.flush()};return this.client.then(a=>{if(a instanceof WindowClient&&"nested"!==a.frameType)return t.inlineScript("stop()",!0),t.flush(),a.navigate(e);n()}).catch(n).then()}deletePage(){return this._deleted=!0,Promise.all([this._page&&this.context.config.deletePageAndSite(this._page.path,this._page.sitePath),this.context.routeConfig.deleteRoute(this._url.pathname)]).then()}abandon(e,t){return this._qosMonitor.ended||this.failQosMonitor(this._error),Object(F.e)([t&&this.deletePage(),this.redirect(this.bypassUrl(),e)]).then()}renderStats(e){e.inlineScript(`window.__swstats=${e.xssStringify(this._stats)}`,!0)}abandoning(){return this._notFound}renderPostRender(e){return this._preloadResponseReady.then(()=>{if(this.abandoning())return this.abandon(e,this._notFound);this.updateModels(!0);const t=this.postRender();return Promise.resolve(t&&t.then(t=>Promise.resolve(t&&t(e)))).catch(()=>{}).then(()=>{this._stats=this.createStats(e),this.renderStats(e)})})}render(e){let t;return this.renderPhases().concat([void 0]).reduce((n,a,i,r)=>n.then(t=>Promise.resolve(t&&t(e)).then(()=>a)).catch(e=>{t=e,this.offlineRenderingErrorThrowsKillswitch&&this._offline||r.splice(i)})).then(this.renderPostRender.bind(this,e)).then(()=>{if(t&&(!this.offlineRenderingErrorThrowsKillswitch||!this._offline)&&!this._redirected&&!this._notFound)throw t})}startResponse(e){const t=this.responseInit();return Promise.resolve(new Response(e.readableStream,t))}endResponse(e){e.close(),this._endedResponse=!0}qosData(){return{app:this.controller.applicationId,stats:this._stats,didNetworkRetry:this._didNetworkRetry}}endQosMonitor(e){Object(U.e)(this._qosMonitor,e,this.qosData())}failQosMonitor(e,t,n){Object(U.t)(this._qosMonitor,e,t,n)}swapCaches(){return Object(B.o)(this._state.cache,j.a).then(e=>{this._state.cache=e})}renderJson(){return JSON.stringify(this.navigationResult)}_processPreloadResponseError(e,t,n){const a=!t||"NetworkError"===(null==n?void 0:n.name);this._notFound=!(this._redirected=Object(H.e)(t))&&t&&404===t.status;const i=!this._notFound&&!this._redirected&&(!t||t.status>=400||a),r=!t||this._redirected||this._notFound||i,o=new P.e(Object.assign(Object.assign({},Object(R.e)(t)),{isExpected:r,innerError:n}));if(this.failQosMonitor(o),!this._redirected){if(i&&this.startOffline&&(this.offlineRenderingErrorThrowsKillswitch||this.suppressNetworkErrors))return this.initializeOfflineMode(e,o);throw o}}_processPreloadResponse(e,t){let n;return this._preloadResponseReady=t.then(t=>(n=t)&&n.ok?this.parseNavigationResult(n).then(e=>(this._navigationResult=e)?this.processNavigationResult():Promise.reject()).catch(e=>{throw this.failQosMonitor(e,"PreloadResponseParseFailed"),e}):this._processPreloadResponseError(e,n,void 0)).catch(t=>this._processPreloadResponseError(e,n,t)),!this.isConfigValid()&&this._preloadResponseReady}_computeRank(e,t){const n=Math.log10(e||1);return Math.round(1e3*(n+1*(t.getTime()-1596092819016)/58e3))/1e3}}{constructor(e,t){super(e,t),this.offlineRenderingErrorThrowsKillswitch=Object(V.t)(V.e.offlineRenderingErrorThrows)}get title(){return q.Title}get generator(){return q.Generator}get manifest(){return q.Manifest}get shortcutIcon(){return q.ShortcutIcon}get workloadApp(){return this.url.searchParams.get("app")}get embedded(){return"portals"===this.workloadApp||"true"===this.url.searchParams.get("classhome")}get chromeless(){return void 0===this._chromeless&&(this._chromeless=this.context.userAgent.chromeless||this.embedded||-1!==(this.url.searchParams.get("env")||"").indexOf("WebView")||"true"===this.url.searchParams.get("disableSuiteNav")),this._chromeless}get mobile(){return void 0===this._mobile&&(this._mobile=this.context.userAgent.mobile||"Mobile"===this.url.searchParams.get("env")),this._mobile}get useSecureBroker(){return void 0===this._useSecureBroker&&(this._useSecureBroker="true"===this.url.searchParams.get("useSecureBroker")),this._useSecureBroker}get appBarVisible(){return this.state.appBarScriptUrl&&!this.chromeless}get teamsTheme(){return this.url.searchParams.get("theme")||this.state.teamsTheme}bypassUrl(){return this.useSecureBroker?function(e){const t=new URL(location.origin+X.t+"?sw=bypass");return t.searchParams.set("dest",Object(N.e)(e)),t.href}(this.url.href):super.bypassUrl()}isFlightEnabled(e){const t=this.url.searchParams.get("debugFlights");if(t){const n=t.split(",");for(const t of n){const n="!"!==t[0];if(parseInt(n?t:t.substring(1),10)===e)return n}}return this.context.config.isFlightEnabled(e,this.state.flights)}getExperimentVariant(e){const t=this.url.searchParams.get("expOverrides");if(t){const n=JSON.parse(t);for(const t of n)if(t[0]===e)return t[1]}return this.context.config.getExperimentVariant(e,this.state.experiments)}isConfigValid(){return super.isConfigValid()&&!!this.state.suiteNavBootUrl}headersInit(){return Object.assign(Object.assign({},super.headersInit()),this.url.searchParams.get("OOPIF")&&{"Origin-Agent-Cluster":"?1"})}preloads(){return this.chromeless?[]:[this.state.suiteNavBootUrl,!this.embedded&&this.state.appBarScriptUrl&&{href:this.state.appBarScriptUrl,integrity:this.state.appBarIntegrity,as:E.e.Script}]}preconnects(){}style(e){return"html,body{margin:0;padding:0;height:100%;}"+(e?"":".SPPageChrome{height:100%;display:flex;flex-direction:column;}\n.spAppAndPropertyPanelContainer,.SPPageChrome-app{height:100%;display:flex;flex-grow:1;}"+(this.appBarVisible?".sp-appBar{z-index:12;width:47px;height:100%;@media print{display:none}}.sp-appBar-linkContainer{list-style:none;padding:0;margin:0}.sp-appBar-dividerElement{border-style:solid;border-width:1px 1px 0 0;margin:2px 7px}@media (max-width:1024px){.sp-appBar{position:fixed;bottom:0;width:100%;max-width:100%;height:47px;border-top:1px solid #eaeaea;@media print{display:none}}.sp-appBar-linkContainer{display:flex;flex-direction:row;justify-content:space-evenly;padding-left:15px;padding-right:15px}.sp-appBar-mobile{max-width:none;@media print{display:none}border-top:1px solid #eaeaea;}.sp-appBar-linkLi{max-width:47px;width:47px;height:47px;display:flex;box-sizing:border-box;margin:2px 0}.sp-appBar-dividerElement{height:42px}}":""))}sendErrorToSecureBroker(e,t){e.inlineScript(function(e){return`parent.postMessage({action:'error',error:${JSON.stringify(e||null)}},'${z}');`}(t),!0),e.flush()}onError(e,t){return this.useSecureBroker&&this.sendErrorToSecureBroker(e,t),super.onError(e,t)}createState(){const e=this.spPageContext,t={displayName:e.userDisplayName,userId:e.aadUserId},n=e.killSwitches,a=e.ExpFeatures,i=e.experimentData,r=function(e,t){switch(t){case"AG08_1_Content":return k.USNat;case"AG09_1_Content":return k.USSec}switch(e){case"prod":break;case"gallatin":return k.Gallatin;case"blackforest":return k.BlackForest;case"trailblazer":return k.Trailblazer;case"pathfinder":return k.Pathfinder}return k.Prod}(e.env2,e.farmLabel),o=function(e){return!function(e){return!!(e.isAnonymousGuestUser||e.isExternalGuestUser||e.isEmailAuthenticationGuestUser||e.isNativeFederatedUser)}(e)&&e.appBarParams&&!e.appBarParams.isDisabled}(e)&&e.spAppBarManifestScript,s=o&&e.appBarParams,c=o&&e.spAppBarManifestScriptIntegrity;return Object.assign(Object.assign({},super.createState()),{user:t,killswitches2:n,flights:a,experiments:i,suiteNavBootUrl:r,appBarScriptUrl:o,appBarParams:s,appBarIntegrity:c,teamsTheme:this.teamsTheme})}createPage(){return Object.assign(Object.assign({},super.createPage()),{sitePath:Object(O.e)(this.spPageContext.webServerRelativeUrl),siteType:this.spPageContext.webTemplate})}createSite(){const e=this.spPageContext,t=3!==e.searchBoxInNavBar&&!e.isAnonymousGuestUser&&(this.isFlightEnabled(Z.e.GuestSuiteNavSearchBox)||!e.isExternalGuestUser&&!e.isEmailAuthenticationGuestUser),n=this.isFlightEnabled(Z.e.MultipleHomeSiteGlobalNav)?e.isCurrentSiteAHomeSite:e.companyPortalReference&&x.e.normalizeLower(e.companyPortalReference.SiteId)===x.e.normalizeLower(e.siteId)&&x.e.normalizeLower(e.companyPortalReference.WebId)===x.e.normalizeLower(e.webId);return Object.assign(Object.assign({},super.createSite()),{path:Object(O.e)(e.webServerRelativeUrl),siteType:e.webTemplate,lang:e.currentUICultureName,authContext:e.siteAuthContext,isHomeSite:n,searchBoxEnabled:t})}hydrateNavigationResult(){const e=this.spPageContext;if(e){const t=this.state;t.flights&&(e.ExpFeatures=t.flights),t.experiments&&(e.experimentData=t.experiments),t.killswitches2&&(e.killSwitches=t.killswitches2),t.appBarScriptUrl&&(e.spAppBarManifestScript=t.appBarScriptUrl),t.appBarParams&&(e.appBarParams=t.appBarParams),t.appBarIntegrity&&(e.spAppBarManifestScriptIntegrity=t.appBarIntegrity)}return Promise.resolve()}renderMark(e,t){e.inlineScript(`__spfxMark('${t}')`,!0)}renderSplash(e){e.write('<div id="splash" style="z-index:99;position:absolute;width:128px;left:calc(50% - 64px);height:128px;top:calc(50% - 64px);">\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><title>SharePoint</title><g filter="url(#s)"><circle cx="54" cy="46" r="26" fill="url(\'#g0\')"/><circle cx="79" cy="68" r="23" fill="url(\'#g1\')"/><circle cx="57" cy="87" r="20" fill="url(\'#g2\')"/></g>\n<defs><filter id="s" x="-42%" y="-42%" width="210%" height="210%"><feOffset result="offOut" in="SourceAlpha" dx=".3" dy=".3"/><feGaussianBlur result="blurOut" in="offOut" stdDeviation="1"/><feBlend in="SourceGraphic" in2="blurOut" mode="normal"/></filter><linearGradient id="g0" gradientTransform="rotate(30)"><stop offset="5%" stop-color="#1A9BA1"/><stop offset="97%" stop-color="#036C70"/></linearGradient><linearGradient id="g1" gradientTransform="rotate(45)"><stop offset="0%" stop-color="#37C6D0"/><stop offset="44%" stop-color="#1A9BA1"/><stop offset="100%" stop-color="#036C70"/></linearGradient><linearGradient id="g2" gradientTransform="rotate(90)"><stop offset="2%" stop-color="#37C6D0"/><stop offset="99%" stop-color="#1A9BA1"/></linearGradient>\n</defs></svg></div>')}fetchAppData(){const e=new URL(this.url.href);return e.searchParams.append("as","json"),Object(w.e)(e.href,{"x-requestprefetchdata":"1"}).then(e=>e.json())}hasAppDataChanged(e,t,n){return e!==t&&!Object(i.isEqual)(t&&t[n],e&&e[n])}renderAppData(e,t,n){const a=[],i=Object.keys(e||{}),r=i.length,o=this.page.lkgData;for(let s=0;s<r;s++){const r=i[s];if(t||this.hasAppDataChanged(o,e,r)){const i=n.xssStringify(e[r]);a.push(`window.${r}=${i};window.${r}Loaded&&${r}Loaded(${t?"":"false,"}true);`)}else a.push(`window.${r}Loaded&&${r}Loaded();`)}a.push(`window._internalIsLKG=${t};window._internalIsLKGLoaded&&_internalIsLKGLoaded(${t});`),n.inlineScript(a.join(""),!0),n.flush()}newData(){return this.fetchAppData().then(e=>t=>{this.renderAppData(e,!1,t),this.page.lkgData=e}).catch(()=>{})}lkgData(){var e;const t=null===(e=this.page)||void 0===e?void 0:e.lkgData;return Promise.resolve(t?e=>{this.renderAppData(t,!0,e)}:void 0)}renderMeta(e){e.charset(),e.viewport(),e.generator(this.generator),this.isFlightEnabled(Z.e.SitesPWA)&&this.site.isHomeSite&&e.manifest(this.manifest),e.shortcutIcon(this.shortcutIcon)}renderStyle(e){e.write(`<style>${this.style()}</style>`)}renderSuiteNavScript(e){this.renderMark(e,Q.suiteNavRenderScriptStart);const t=this.isFlightEnabled(Z.e.AccountSwitcher)&&self.location.host;!function(e,t){const n=t.authProviderConfigOptions,a=`let i,load,render,postRender;try{i=window.parent&&parent!==window}catch(e){i=1}\nif(i){const e=document.getElementById('${L}');return e&&e.remove()}window.o365ShellLoadPromise=new Promise(r=>{load=r;});\nwindow.o365ShellRenderPromise=new Promise(r=>{render=r;});\nwindow.o365ShellPostRenderPromise=new Promise(r=>{postRender=r;});\nwindow.__suiteNav=()=>{load&&load();O365Shell.RenderAsync({top:'${L}',layout:'Mouse',enableSearchUX:!${t.searchBox?"":"!"}0,lazyLoadSearchPackage:!0,initialSearchUXVisibility:!${t.searchBox?"":"!"}0,initialSearchUXSearchText:'${t.initialSearchText?A.e.htmlEncode(t.initialSearchText,!0):""}',enableDelayLoading:!0,collapseO365Settings:!0,disableDelayLoad:!!0,disableShellPlus:!!0,isThinHeader:!0,\nenableLegacyResponsiveBehavior:!!0,expectSearchBoxSettings:!0${n?",shellAuthProviderConfig:"+function(e){const t=e&&e.launchDestination,n=`'https://www.office.com/login?prompt=select_account&ru=%2Flaunch%2F${t}'`,a=`function(a){var n=a&&a.nextAccount;if(!n){return''}return(!n.type||n.type.toLowerCase()==='aad'?'https://www.office.com/login?ru=%2Flaunch%2F${t}':'https://onedrive.live.com/?gologin=1')+(n.memberName?'&login_hint='+encodeURIComponent(n.memberName):'')}`;return e?`{type:'webAadWithMsaProxy',appSignInUrl:${n},appSignOutUrl:'${A.e.htmlEncode(e.appSignOutUrl,!0)}',appSwitchUrl:${n},appSwitchToUrl:${a},aad:{appId:'00000003-0000-0ff1-ce00-000000000000',wreply:'${A.e.htmlEncode(e.wreplyUrl,!0)}'},msa:{siteId:'250206',wreply:'${A.e.htmlEncode(e.wreplyUrl,!0)}'}}`:null}(n):""},shellDataOverrides:{${n?"AccountSwitchingEnabled:!0,DisableMASTPopup:!0":""}},supportShyHeaderMode:${t.supportShyHeaderMode?"!0,shyHeaderActivationHeight:480":"!!0"},initialRenderData:{AppBrandTheme:{Primary:'#0078D4'},Culture:'${t.lang}',CurrentMainLinkElementId:'ShellSites',IsConsumer:!!0,UserDisplayName:'${t.user?A.e.htmlEncode(t.user.displayName,!0):""}',UserID:'${t.user&&t.user.userId||"0"}',WorkloadId:'Sharepoint',ShellBootHost:'${t.bootHost}',EnableVanillaSearchBox:!0}},render,postRender,e=>{\nconsole.error(e);\n});};`;e.inlineScript(a)}(e,{bootHost:`https://${new URL(this.state.suiteNavBootUrl).host}`,lang:this.lang,user:this.state.user,searchBox:!1!==this.site.searchBoxEnabled&&this.isFlightEnabled(Z.e.SuiteNavSearchBox),initialSearchText:this.url.searchParams.get("q"),authProviderConfigOptions:t?{appSignOutUrl:`${self.location.protocol}//${t}${"/"===this.site.path?"":this.site.path}/_layouts/15/SignOut.aspx`,launchDestination:"21"===this.site.siteType?"onedrive":"sharepoint",wreplyUrl:`${self.location.protocol}//${t}/_forms/default.aspx`}:void 0,supportShyHeaderMode:this.isFlightEnabled(Z.e.SuiteNavShyHeaderModeSupport)});const n=`o365ShellLoadPromise.then(()=>{__spfxMark('${Q.suiteNavScriptAsyncEnd}')});\no365ShellRenderPromise.then(()=>{__spfxMark('${Q.suiteNavRenderAsyncEnd}')});\n__spfxMark('${Q.suiteNavRenderScriptEnd}');__spfxMark('${Q.suiteNavScriptStart}')`;e.inlineScript(n,!0)}renderSuiteNavScriptImport(e){!function(e,t){e.script2(t,"SuiteNavShellCore",!0,[["onload","window.__suiteNav&&__suiteNav()"]])}(e,this.state.suiteNavBootUrl),this.renderMark(e,Q.suiteNavScriptEnd)}renderAppBar(e){this.appBarVisible&&function(e,t,n,a,i,r){e.write(`<div id="sp-appBar" class="sp-appBar${i?" sp-appBar-mobile":""}"></div>`);const o=Object.assign(Object.assign({},a),{isMobile:i}),s=`window.__appBar=()=>{spAppBar.addAppBar(${e.xssStringify(o)});}`;e.inlineScript(s,!0);const c=[["onload","__appBar()"],["onerror",`location.href='${A.e.htmlEncode(r,!0)}'`]];n&&c.push(["integrity",n]),e.script2(t,void 0,!0,c)}(e,this.state.appBarScriptUrl,this.state.appBarIntegrity,this.state.appBarParams,this.mobile,this.bypassUrl())}renderAppChromeContent(e){this.renderAppBar(e)}renderAppChrome(e){}renderChrome(e){this.renderMark(e,Q.bodyStart),e.write('<div id="SPPageChrome" class="SPPageChrome isFluent">');const t=this.chromeless;t||function(e){e.write(`<div id="${L}" style="min-height:48px;background-color:#000;"></div>`)}(e),function(e){e.write('<div id="SuiteNavWrapper"></div>')}(e),this.renderAppChrome(e),e.write("</div>"),t||(this.renderSuiteNavScript(e),this.renderSuiteNavScriptImport(e))}renderWorkerScript(e){const t=`(function(global){\ntry{\n__spfxMark('${Q.spWorkerInit}');\nglobal.__spWorker=new Worker('${Y.e}',{name:'SP Worker'});\nglobal.__spWorker.addEventListener('message',(ev)=>{\nif(ev.data==='SPWebWorker started.'){\n__spfxMark('${Q.spWorkerStarted}');\nglobal.__spWorkerStarted=true;\n}});\nglobal.__spWorker.onerror=(er)=>{\nif (er.message.includes('Failed to fetch web worker script')||er.message.includes('Failed to eval')){\nglobal.__spWorkerStarted=false;\nglobal.__spWorkerError=er.message;\nglobal.__spWorker.terminate();\ndelete global.__spWorker;\n}};}catch(e){}})(self);`;e.inlineScript(t)}renderHeadScript(e){const t=`if(window.PerformanceLongTaskTiming){try{\nconst g=window.__tti={e:[],f:[],o:new PerformanceObserver(l=>{g.e=g.e.concat(l.getEntriesByType('longtask'));\ng.f=g.f.concat(l.getEntriesByType('first-input'));})};g.o.observe({entryTypes:['longtask','first-input']});\nconst h=window.__fci={e:[],o:new PerformanceObserver(l=>{h.e=h.e.concat(l.getEntries())})};\nh.o.observe({entryTypes:['longtask']})}catch(e){}}\nwindow.spfxPerfMarks={};\n(window.__spfxMark=(n)=>{window.spfxPerfMarks[n]=performance.now();performance.mark(n)})('${Q.headStart}');\n__spfxMark('${Q.preconnectStart}');\n${!$.betterInlineAuth2Killswitch&&this.startOffline?"window.__authenticated=new Promise((s,e)=>{window.__authenticatedSuccess=s;window.__authenticatedError=e;});":""}`;e.inlineScript(t),this.renderWorkerScript(e)}renderHeadContent(e){this.renderMeta(e),e.title(this.title),this.renderHeadScript(e),this.renderPreconnects(e),this.renderPreloads(e),this.renderStyle(e),this.renderMark(e,Q.headEnd)}renderShell(e){e.startHtml(this.lang),this.renderHeadContent(e),e.startBody(),this.renderChrome(e),this.renderSplash(e)}shell(){return Promise.resolve(this.renderShell.bind(this))}renderPreconnects(e){const t=this.preconnects(),n=t&&t.length||0;for(let a=0;a<n;a++)e.preconnect(t[a]);this.renderMark(e,Q.preconnectEnd)}renderPreloads(e){this.renderMark(e,Q.scriptPreloadStart);const t=this.preloads(),n=t.length;for(let a=0;a<n;a++){const n=t[a];n&&e.preload.apply(e,"string"==typeof n?[n]:[n.href,n.as,n.type,n.integrity])}this.renderMark(e,Q.scriptPreloadEnd)}renderAuthenticateInline(e,t,n){var a;const i=function(e,t,n){const a=!Object(V.t)(V.e.retryToken),i=!Object(V.t)(V.e.retryToken2);return`parent.postMessage({action:'getBrokerWindow'},'${z}');\nlet tid,retry=0;\ntry{sessionStorage.setItem('TeamsLogonIsAuthRequired',true);}catch{}\nlet authHandler = e => {\n  ${a?"clearTimeout(tid);":""}\n  if (e.origin === '${z}' && e.data && e.data.action === 'returnToken') {\n    removeEventListener('message', authHandler);\n    try{ sessionStorage.setItem('TeamsLogonAuthTokenFetched', Date.now()); }catch{}\n    const token=e.data.result;\n    ${Object(V.t)(V.e.betterInlineAuth2)?"const detail={hasToken:true,token};dispatchEvent(new CustomEvent('authenticated',{detail}));":""}\n    fetch('/_api/SP.OAuth.NativeClient/Authenticate', {\n      method: 'POST',\n      credentials: 'same-origin',\n      headers: {\n          'Authorization': 'Bearer ' + token\n          ${Object(V.t)(V.e.usePersistedCookies)?"":",'X-FeatureVersion': '2'"}\n      }\n    })\n    .then(r => {\n      if (r.ok) {\n        try{sessionStorage.setItem('TeamsLogonSuccess', Date.now());}catch{}\n        ${Object(V.t)(V.e.betterInlineAuth2)?"detail.hasCookie=true;dispatchEvent(new CustomEvent('authenticated',{detail}));":K(!0)}\n        ${e||""}\n      } else {\n        if (r.status === 401 && retry++ < 5) {\n          const h = r.headers.get('WWW-Authenticate');\n          if (h?.includes('claims=')) {\n            const dirs = h.split(',');\n            for (let i = 0; i < dirs.length; i++) {\n              const p = dirs[i].trim().split('=');\n              if (p[0] === 'claims') {\n                addEventListener('message', authHandler);\n                parent.postMessage({\n                    action: 'requestToken',\n                    claims: p[1],\n                    resource: location.origin,\n                    identifier: 0\n                }, '${z}');\n                return;\n              }\n            }\n          }\n        }\n        ${Object(V.t)(V.e.betterInlineAuth2)?"":W}\n        ${t||""}\n      }\n    });\n  }};\n  addEventListener('message', authHandler);\n  try{ sessionStorage.setItem('TeamsLogonAuthTokenRequested', Date.now()); }catch{}\n  let identifier=0,timeout=550;\n  const requestToken = () => {\n    parent.postMessage({\n      action: 'requestToken',\n      claims: ${n?`'${n}'`:"undefined"},\n      resource: location.origin,\n      identifier,\n      isRetry: !!identifier\n    }, '${z}');\n    ${i?"if(++identifier<7){timeout+=identifier*550;tid=setTimeout(()=>requestToken(),timeout);}":""}\n  };\n  requestToken();${i?"":"++identifier;tid=setTimeout(()=>requestToken(),11000);"}`}(t,n||`location.href='${A.e.htmlEncode(this.bypassUrl(),!0)}'`,null===(a=this.site)||void 0===a?void 0:a.authContext);e.inlineScript(i),e.flush(),this._didAuthenticate=!0}renderNotifyAlreadyAuthenticated(e){this._notifiedAuthenticated||(e.inlineScript(K("auth"===this.url.searchParams.get("sw")),!0),e.flush(),this._notifiedAuthenticated=!0)}renderAuthenticateRedirect(e){this._didAuthenticate=!0;const t=new URL(this.url.href);if("auth"===t.searchParams.get("sw"))return this.abandon(e);t.searchParams.set("sw","auth");const n=`${j.e}/_layouts/15/${this.useSecureBroker?"BrokerLogon":"Authenticate"}.aspx?${this.useSecureBroker?"useSecureBroker=true&dest":"Source"}=${encodeURIComponent(decodeURIComponent(t.pathname+t.search))}`;return this.redirect(n,e)}authenticate(e,t){return this.preloadResponseReady.then(()=>n=>{this.requiresInlineAuthentication()?this.renderAuthenticateInline(n,e,t):!$.betterInlineAuth2Killswitch&&this.requiresAuthentication()?this.renderAuthenticateRedirect(n):!$.betterInlineAuth2Killswitch&&this.startOffline&&this.renderNotifyAlreadyAuthenticated(n)})}get abandonUnlessRedirected(){return this._abandonUnlessRedirected}set abandonUnlessRedirected(e){this._abandonUnlessRedirected=e}abandoning(){return this._abandonUnlessRedirected&&!this.redirected||super.abandoning()}requiresAuthentication(){return this.redirected&&!this._didAuthenticate}requiresInlineAuthentication(){return!$.inlineAuthEnabledKillswitch&&this.requiresAuthentication()&&this.useSecureBroker&&this.useInlineAuthentication}renderPostRender(e){return this.preloadResponseReady.then(()=>this.requiresAuthentication()?this.renderAuthenticateRedirect(e):($.betterInlineAuth2Killswitch||this._didAuthenticate||!this.startOffline||this.renderNotifyAlreadyAuthenticated(e),this.renderMark(e,Q.postFlush),super.renderPostRender(e)))}endResponse(e){this.renderMark(e,Q.bodyEnd),e.endHtml(),super.endResponse(e)}showOfflineNotification(){let e,t;return this.offline?(console.warn("SharePoint: Offline"),e="Disconnected from SharePoint",t="You are viewing a previous version of this page. We will let you know when connectivity has been restored."):(console.log("SharePoint: Online"),e="Connected to SharePoint",t="Connectivity has been restored. You can now continue working online."),function(e,t){return Promise.resolve("granted"!==Notification.permission&&Notification.requestPermission&&Notification.requestPermission()).then(n=>"granted"===(n||Notification.permission)&&self.registration.showNotification(e,t).then(()=>!0).catch(()=>!1))}(e,{body:t,lang:this.lang,icon:I.SharePoint})}sendOfflineUpdateEvent(){const e={name:C.e.OfflineNotification,data:{offline:this.offline}};Object(J.e)(e)}onOfflineStatusChanged(){return this.sendOfflineUpdateEvent(),this.showOfflineNotification()}finalize(e){return Promise.all([super.finalize(e),this.isOfflineEnabled&&this.state.offline!==this.state.wasOffline&&this.onOfflineStatusChanged()]).then()}get isOfflineEnabled(){return!1}}$.inlineAuthEnabledKillswitch=Object(V.t)(V.e.inlineAuthEnabled),$.betterInlineAuth2Killswitch=Object(V.t)(V.e.betterInlineAuth2)},function(e,t,n){(function(e,n){var a;a=function(){"use strict";function a(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function i(e,t,n,a){for(var i=-1,r=null==e?0:e.length;++i<r;){var o=e[i];t(a,o,n(o),e)}return a}function r(e,t){for(var n=-1,a=null==e?0:e.length;++n<a&&!1!==t(e[n],n,e););return e}function o(e,t){return!(null==e||!e.length)&&f(e,t,0)>-1}function s(e,t,n){for(var a=-1,i=null==e?0:e.length;++a<i;)if(n(t,e[a]))return!0;return!1}function c(e,t){for(var n=-1,a=null==e?0:e.length,i=Array(a);++n<a;)i[n]=t(e[n],n,e);return i}function d(e,t){for(var n=-1,a=t.length,i=e.length;++n<a;)e[i+n]=t[n];return e}function l(e,t){for(var n=-1,a=null==e?0:e.length;++n<a;)if(t(e[n],n,e))return!0;return!1}function u(e,t,n,a){for(var i=e.length,r=n+(a?1:-1);a?r--:++r<i;)if(t(e[r],r,e))return r;return-1}function f(e,t,n){return t==t?function(e,t,n){for(var a=n-1,i=e.length;++a<i;)if(e[a]===t)return a;return-1}(e,t,n):u(e,p,n)}function p(e){return e!=e}function m(e){return function(t){return null==t?pt:t[e]}}function _(e){return function(t){return null==e?pt:e[t]}}function h(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}function b(e){return function(t){return e(t)}}function g(e,t){return e.has(t)}function v(e){return aa.test(e)}function y(e){var t=-1,n=Array(e.size);return e.forEach(function(e,a){n[++t]=[a,e]}),n}function S(e,t){return function(n){return e(t(n))}}function D(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function I(e){return v(e)?function(e){return e.match(ta)||[]}(e):function(e){return e.split("")}(e)}function x(e){for(var t=e.length;t--&&_n.test(e.charAt(t)););return t}function C(){}function O(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function w(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function E(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function A(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new E;++t<n;)this.add(e[t])}function L(e){this.size=(this.__data__=new w(e)).size}function k(e,t){var n=Fi(e),a=!n&&Ui(e),i=!n&&!a&&Hi(e),r=!n&&!a&&!i&&ji(e),o=n||a||i||r,s=o?h(e.length,String):[],c=s.length;for(var d in e)!t&&!Aa.call(e,d)||o&&("length"==d||i&&("offset"==d||"parent"==d)||r&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||Se(d,c))||s.push(d);return s}function M(e,t,n){(n===pt||He(e[t],n))&&(n!==pt||t in e)||F(e,t,n)}function P(e,t,n){var a=e[t];Aa.call(e,t)&&He(a,n)&&(n!==pt||t in e)||F(e,t,n)}function T(e,t){for(var n=e.length;n--;)if(He(e[n][0],t))return n;return-1}function U(e,t,n,a){return bi(e,function(e,i,r){t(a,e,n(e),r)}),a}function F(e,t,n){"__proto__"==t&&Ka?Ka(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function H(e,t,n,a,i,o){var s,c=t&bt,d=t&gt,l=t&vt;if(n&&(s=i?n(e,a,i,o):n(e)),s!==pt)return s;if(!Ve(e))return e;var u=Fi(e);if(u){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Aa.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return de(e,s)}else{var f=Ii(e),p=f==Pt||f==Tt;if(Hi(e))return re(e,c);if(f==Rt||f==wt||p&&!i){if(s=d||p?{}:ve(e),!c)return d?function(e,t){return le(e,Di(e),t)}(e,function(e,t){return e&&le(t,tt(t),e)}(s,e)):function(e,t){return le(e,Si(e),t)}(e,function(e,t){return e&&le(t,et(t),e)}(s,e))}else{if(!oa[f])return i?e:{};s=function(e,t,n){var a=e.constructor;switch(t){case qt:return oe(e);case Lt:case kt:return new a(+e);case Qt:return function(e,t){return new e.constructor(t?oe(e.buffer):e.buffer,e.byteOffset,e.byteLength)}(e,n);case Yt:case Jt:case Xt:case Zt:case $t:case en:case tn:case nn:case an:return se(e,n);case Ut:case Vt:return new a;case Ft:case zt:return new a(e);case jt:return function(e){var t=new e.constructor(e.source,gn.exec(e));return t.lastIndex=e.lastIndex,t}(e);case Gt:return function(e){return mi?Object(mi.call(e)):{}}(e)}}(e,f,c)}}o||(o=new L);var m=o.get(e);if(m)return m;o.set(e,s),Bi(e)?e.forEach(function(a){s.add(H(a,t,n,a,e,o))}):Ri(e)&&e.forEach(function(a,i){s.set(i,H(a,t,n,i,e,o))});var _=u?pt:(l?d?me:pe:d?tt:et)(e);return r(_||e,function(a,i){_&&(a=e[i=a]),P(s,i,H(a,t,n,i,e,o))}),s}function R(e,t,n,a){var i=-1,r=o,d=!0,l=e.length,u=[],f=t.length;if(!l)return u;n&&(t=c(t,b(n))),a?(r=s,d=!1):t.length>=mt&&(r=g,d=!1,t=new A(t));e:for(;++i<l;){var p=e[i],m=null==n?p:n(p);if(p=a||0!==p?p:0,d&&m==m){for(var _=f;_--;)if(t[_]===m)continue e;u.push(p)}else r(t,m,a)||u.push(p)}return u}function N(e,t,n,a,i){var r=-1,o=e.length;for(n||(n=ye),i||(i=[]);++r<o;){var s=e[r];t>0&&n(s)?t>1?N(s,t-1,n,a,i):d(i,s):a||(i[i.length]=s)}return i}function B(e,t){return e&&gi(e,t,et)}function j(e,t){for(var n=0,a=(t=ae(t,e)).length;null!=e&&n<a;)e=e[Ae(t[n++])];return n&&n==a?e:pt}function V(e,t,n){var a=t(e);return Fi(e)?a:d(a,n(e))}function z(e){return null==e?e===pt?Kt:Ht:Ga&&Ga in Object(e)?function(e){var t=Aa.call(e,Ga),n=e[Ga];try{e[Ga]=pt;var a=!0}catch(e){}var i=ka.call(e);return a&&(t?e[Ga]=n:delete e[Ga]),i}(e):function(e){return ka.call(e)}(e)}function G(e,t){return null!=e&&Aa.call(e,t)}function K(e,t){return null!=e&&t in Object(e)}function W(e){return ze(e)&&z(e)==wt}function q(e,t,n,a,i){return e===t||(null==e||null==t||!ze(e)&&!ze(t)?e!=e&&t!=t:function(e,t,n,a,i,r){var o=Fi(e),s=Fi(t),c=o?Et:Ii(e),d=s?Et:Ii(t),l=(c=c==wt?Rt:c)==Rt,u=(d=d==wt?Rt:d)==Rt,f=c==d;if(f&&Hi(e)){if(!Hi(t))return!1;o=!0,l=!1}if(f&&!l)return r||(r=new L),o||ji(e)?fe(e,t,n,a,i,r):function(e,t,n,a,i,r,o){switch(n){case Qt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case qt:return!(e.byteLength!=t.byteLength||!r(new Fa(e),new Fa(t)));case Lt:case kt:case Ft:return He(+e,+t);case Mt:return e.name==t.name&&e.message==t.message;case jt:case zt:return e==t+"";case Ut:var s=y;case Vt:var c=a&yt;if(s||(s=D),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;a|=St,o.set(e,t);var l=fe(s(e),s(t),a,i,r,o);return o.delete(e),l;case Gt:if(mi)return mi.call(e)==mi.call(t)}return!1}(e,t,c,n,a,i,r);if(!(n&yt)){var p=l&&Aa.call(e,"__wrapped__"),m=u&&Aa.call(t,"__wrapped__");if(p||m){var _=p?e.value():e,h=m?t.value():t;return r||(r=new L),i(_,h,n,a,r)}}return!!f&&(r||(r=new L),function(e,t,n,a,i,r){var o=n&yt,s=pe(e),c=s.length;if(c!=pe(t).length&&!o)return!1;for(var d=c;d--;){var l=s[d];if(!(o?l in t:Aa.call(t,l)))return!1}var u=r.get(e),f=r.get(t);if(u&&f)return u==t&&f==e;var p=!0;r.set(e,t),r.set(t,e);for(var m=o;++d<c;){var _=e[l=s[d]],h=t[l];if(a)var b=o?a(h,_,l,t,e,r):a(_,h,l,e,t,r);if(!(b===pt?_===h||i(_,h,n,a,r):b)){p=!1;break}m||(m="constructor"==l)}if(p&&!m){var g=e.constructor,v=t.constructor;g!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v)&&(p=!1)}return r.delete(e),r.delete(t),p}(e,t,n,a,i,r))}(e,t,n,a,q,i))}function Q(e){return"function"==typeof e?e:null==e?st:"object"==typeof e?Fi(e)?function(e,t){return Ie(e)&&Ce(t)?Oe(Ae(e),t):function(n){var a=Ze(n,e);return a===pt&&a===t?$e(n,e):q(t,a,yt|St)}}(e[0],e[1]):function(e){var t=function(e){for(var t=et(e),n=t.length;n--;){var a=t[n],i=e[a];t[n]=[a,i,Ce(i)]}return t}(e);return 1==t.length&&t[0][2]?Oe(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,a){var i=n.length,r=i;if(null==e)return!r;for(e=Object(e);i--;){var o=n[i];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<r;){var s=(o=n[i])[0],c=e[s],d=o[1];if(o[2]){if(c===pt&&!(s in e))return!1}else{var l=new L;if(!q(d,c,yt|St,undefined,l))return!1}}return!0}(n,0,t)}}(e):lt(e)}function Y(e){if(!xe(e))return Xa(e);var t=[];for(var n in Object(e))Aa.call(e,n)&&"constructor"!=n&&t.push(n);return t}function J(e,t,n,a,i){e!==t&&gi(t,function(r,o){if(i||(i=new L),Ve(r))!function(e,t,n,a,i,r,o){var s=Ee(e,n),c=Ee(t,n),d=o.get(c);if(d)return M(e,n,d),pt;var l=r?r(s,c,n+"",e,t,o):pt,u=l===pt;if(u){var f=Fi(c),p=!f&&Hi(c),m=!f&&!p&&ji(c);l=c,f||p||m?Fi(s)?l=s:Ne(s)?l=de(s):p?(u=!1,l=re(c,!0)):m?(u=!1,l=se(c,!0)):l=[]:Ge(c)||Ui(c)?(l=s,Ui(s)?l=Je(s):Ve(s)&&!Be(s)||(l=ve(c))):u=!1}u&&(o.set(c,l),i(l,c,a,r,o),o.delete(c)),M(e,n,l)}(e,t,o,n,J,a,i);else{var s=a?a(Ee(e,o),r,o+"",e,t,i):pt;s===pt&&(s=r),M(e,o,s)}},tt)}function X(e,t){return xi(we(e,t,st),e+"")}function Z(e,t,n,a){if(!Ve(e))return e;for(var i=-1,r=(t=ae(t,e)).length,o=r-1,s=e;null!=s&&++i<r;){var c=Ae(t[i]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=o){var l=s[c];(d=a?a(l,c,s):pt)===pt&&(d=Ve(l)?l:Se(t[i+1])?[]:{})}P(s,c,d),s=s[c]}return e}function $(e,t,n){var a=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(i);++a<i;)r[a]=e[a+t];return r}function ee(e){if("string"==typeof e)return e;if(Fi(e))return c(e,ee)+"";if(We(e))return _i?_i.call(e):"";var t=e+"";return"0"==t&&1/e==-Dt?"-0":t}function te(e,t,n){var a=-1,i=o,r=e.length,c=!0,d=[],l=d;if(n)c=!1,i=s;else if(r>=mt){var u=t?null:yi(e);if(u)return D(u);c=!1,i=g,l=new A}else l=t?[]:d;e:for(;++a<r;){var f=e[a],p=t?t(f):f;if(f=n||0!==f?f:0,c&&p==p){for(var m=l.length;m--;)if(l[m]===p)continue e;t&&l.push(p),d.push(f)}else i(l,p,n)||(l!==d&&l.push(p),d.push(f))}return d}function ne(e){return Ne(e)?e:[]}function ae(e,t){return Fi(e)?e:Ie(e,t)?[e]:Ci(Xe(e))}function ie(e,t,n){var a=e.length;return n=n===pt?a:n,!t&&n>=a?e:$(e,t,n)}function re(e,t){if(t)return e.slice();var n=e.length,a=Ha?Ha(n):new e.constructor(n);return e.copy(a),a}function oe(e){var t=new e.constructor(e.byteLength);return new Fa(t).set(new Fa(e)),t}function se(e,t){return new e.constructor(t?oe(e.buffer):e.buffer,e.byteOffset,e.length)}function ce(e,t){if(e!==t){var n=e!==pt,a=null===e,i=e==e,r=We(e),o=t!==pt,s=null===t,c=t==t,d=We(t);if(!s&&!d&&!r&&e>t||r&&o&&c&&!s&&!d||a&&o&&c||!n&&c||!i)return 1;if(!a&&!r&&!d&&e<t||d&&n&&i&&!a&&!r||s&&n&&i||!o&&i||!c)return-1}return 0}function de(e,t){var n=-1,a=e.length;for(t||(t=Array(a));++n<a;)t[n]=e[n];return t}function le(e,t,n,a){var i=!n;n||(n={});for(var r=-1,o=t.length;++r<o;){var s=t[r],c=a?a(n[s],e[s],s,n,e):pt;c===pt&&(c=e[s]),i?F(n,s,c):P(n,s,c)}return n}function ue(e){return X(function(t,n){var a=-1,i=n.length,r=i>1?n[i-1]:pt,o=i>2?n[2]:pt;for(r=e.length>3&&"function"==typeof r?(i--,r):pt,o&&De(n[0],n[1],o)&&(r=i<3?pt:r,i=1),t=Object(t);++a<i;){var s=n[a];s&&e(t,s,a,r)}return t})}function fe(e,t,n,a,i,r){var o=n&yt,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var d=r.get(e),u=r.get(t);if(d&&u)return d==t&&u==e;var f=-1,p=!0,m=n&St?new A:pt;for(r.set(e,t),r.set(t,e);++f<s;){var _=e[f],h=t[f];if(a)var b=o?a(h,_,f,t,e,r):a(_,h,f,e,t,r);if(b!==pt){if(b)continue;p=!1;break}if(m){if(!l(t,function(e,t){if(!g(m,t)&&(_===e||i(_,e,n,a,r)))return m.push(t)})){p=!1;break}}else if(_!==h&&!i(_,h,n,a,r)){p=!1;break}}return r.delete(e),r.delete(t),p}function pe(e){return V(e,et,Si)}function me(e){return V(e,tt,Di)}function _e(){var e=C.iteratee||ct;return e=e===ct?Q:e,arguments.length?e(arguments[0],arguments[1]):e}function he(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function be(e,t){var n=function(e,t){return null==e?pt:e[t]}(e,t);return function(e){return!(!Ve(e)||function(e){return!!La&&La in e}(e))&&(Be(e)?Pa:Sn).test(Le(e))}(n)?n:pt}function ge(e,t,n){for(var a=-1,i=(t=ae(t,e)).length,r=!1;++a<i;){var o=Ae(t[a]);if(!(r=null!=e&&n(e,o)))break;e=e[o]}return r||++a!=i?r:!!(i=null==e?0:e.length)&&je(i)&&Se(o,i)&&(Fi(e)||Ui(e))}function ve(e){return"function"!=typeof e.constructor||xe(e)?{}:hi(Ra(e))}function ye(e){return Fi(e)||Ui(e)||!!(Va&&e&&e[Va])}function Se(e,t){var n=typeof e;return!!(t=null==t?It:t)&&("number"==n||"symbol"!=n&&In.test(e))&&e>-1&&e%1==0&&e<t}function De(e,t,n){if(!Ve(n))return!1;var a=typeof t;return!!("number"==a?Re(n)&&Se(t,n.length):"string"==a&&t in n)&&He(n[t],e)}function Ie(e,t){if(Fi(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!We(e))||ln.test(e)||!dn.test(e)||null!=t&&e in Object(t)}function xe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Oa)}function Ce(e){return e==e&&!Ve(e)}function Oe(e,t){return function(n){return null!=n&&n[e]===t&&(t!==pt||e in Object(n))}}function we(e,t,n){return t=Za(t===pt?e.length-1:t,0),function(){for(var i=arguments,r=-1,o=Za(i.length-t,0),s=Array(o);++r<o;)s[r]=i[t+r];r=-1;for(var c=Array(t+1);++r<t;)c[r]=i[r];return c[t]=n(s),a(e,this,c)}}function Ee(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ae(e){if("string"==typeof e||We(e))return e;var t=e+"";return"0"==t&&1/e==-Dt?"-0":t}function Le(e){if(null!=e){try{return Ea.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ke(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var i=null==n?0:Qe(n);return i<0&&(i=Za(a+i,0)),u(e,_e(t,3),i)}function Me(e){var t=null==e?0:e.length;return t?e[t-1]:pt}function Pe(e,t){return(Fi(e)?r:bi)(e,_e(t,3))}function Te(e,t){var n;if("function"!=typeof t)throw new TypeError(_t);return e=Qe(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=pt),n}}function Ue(e,t,n){function a(t){var n=d,a=l;return d=l=pt,_=t,f=e.apply(a,n)}function i(e){return _=e,p=setTimeout(o,t),h?a(e):f}function r(e){var n=e-m;return m===pt||n>=t||n<0||b&&e-_>=u}function o(){var e=Ti();return r(e)?s(e):(p=setTimeout(o,function(e){var n=t-(e-m);return b?$a(n,u-(e-_)):n}(e)),pt)}function s(e){return p=pt,g&&d?a(e):(d=l=pt,f)}function c(){var e=Ti(),n=r(e);if(d=arguments,l=this,m=e,n){if(p===pt)return i(m);if(b)return clearTimeout(p),p=setTimeout(o,t),a(m)}return p===pt&&(p=setTimeout(o,t)),f}var d,l,u,f,p,m,_=0,h=!1,b=!1,g=!0;if("function"!=typeof e)throw new TypeError(_t);return t=Ye(t)||0,Ve(n)&&(h=!!n.leading,u=(b="maxWait"in n)?Za(Ye(n.maxWait)||0,t):u,g="trailing"in n?!!n.trailing:g),c.cancel=function(){p!==pt&&clearTimeout(p),_=0,d=m=l=p=pt},c.flush=function(){return p===pt?f:s(Ti())},c}function Fe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(_t);var n=function(){var a=arguments,i=t?t.apply(this,a):a[0],r=n.cache;if(r.has(i))return r.get(i);var o=e.apply(this,a);return n.cache=r.set(i,o)||r,o};return n.cache=new(Fe.Cache||E),n}function He(e,t){return e===t||e!=e&&t!=t}function Re(e){return null!=e&&je(e.length)&&!Be(e)}function Ne(e){return ze(e)&&Re(e)}function Be(e){if(!Ve(e))return!1;var t=z(e);return t==Pt||t==Tt||t==At||t==Bt}function je(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=It}function Ve(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ze(e){return null!=e&&"object"==typeof e}function Ge(e){if(!ze(e)||z(e)!=Rt)return!1;var t=Ra(e);if(null===t)return!0;var n=Aa.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ea.call(n)==Ma}function Ke(e){return"string"==typeof e||!Fi(e)&&ze(e)&&z(e)==zt}function We(e){return"symbol"==typeof e||ze(e)&&z(e)==Gt}function qe(e){return e?(e=Ye(e))===Dt||e===-Dt?(e<0?-1:1)*xt:e==e?e:0:0===e?e:0}function Qe(e){var t=qe(e),n=t%1;return t==t?n?t-n:t:0}function Ye(e){if("number"==typeof e)return e;if(We(e))return Ct;if(Ve(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ve(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e?e.slice(0,x(e)+1).replace(mn,""):e}(e);var n=yn.test(e);return n||Dn.test(e)?ca(e.slice(2),n?2:8):vn.test(e)?Ct:+e}function Je(e){return le(e,tt(e))}function Xe(e){return null==e?"":ee(e)}function Ze(e,t,n){var a=null==e?pt:j(e,t);return a===pt?n:a}function $e(e,t){return null!=e&&ge(e,t,K)}function et(e){return Re(e)?k(e):Y(e)}function tt(e){return Re(e)?k(e,!0):function(e){if(!Ve(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=xe(e),n=[];for(var a in e)("constructor"!=a||!t&&Aa.call(e,a))&&n.push(a);return n}(e)}function nt(e){return null==e?[]:function(e,t){return c(t,function(t){return e[t]})}(e,et(e))}function at(e){return Qi(Xe(e).toLowerCase())}function it(e){return(e=Xe(e))&&e.replace(xn,Sa).replace(ea,"")}function rt(e,t,n){return e=Xe(e),(t=n?pt:t)===pt?function(e){return ia.test(e)}(e)?function(e){return e.match(na)||[]}(e):function(e){return e.match(hn)||[]}(e):e.match(t)||[]}function ot(e){return function(){return e}}function st(e){return e}function ct(e){return Q("function"==typeof e?e:H(e,bt))}function dt(){}function lt(e){return Ie(e)?m(Ae(e)):function(e){return function(t){return j(t,e)}}(e)}function ut(){return[]}function ft(){return!1}var pt,mt=200,_t="Expected a function",ht="__lodash_hash_undefined__",bt=1,gt=2,vt=4,yt=1,St=2,Dt=1/0,It=9007199254740991,xt=17976931348623157e292,Ct=NaN,Ot=4294967295,wt="[object Arguments]",Et="[object Array]",At="[object AsyncFunction]",Lt="[object Boolean]",kt="[object Date]",Mt="[object Error]",Pt="[object Function]",Tt="[object GeneratorFunction]",Ut="[object Map]",Ft="[object Number]",Ht="[object Null]",Rt="[object Object]",Nt="[object Promise]",Bt="[object Proxy]",jt="[object RegExp]",Vt="[object Set]",zt="[object String]",Gt="[object Symbol]",Kt="[object Undefined]",Wt="[object WeakMap]",qt="[object ArrayBuffer]",Qt="[object DataView]",Yt="[object Float32Array]",Jt="[object Float64Array]",Xt="[object Int8Array]",Zt="[object Int16Array]",$t="[object Int32Array]",en="[object Uint8Array]",tn="[object Uint8ClampedArray]",nn="[object Uint16Array]",an="[object Uint32Array]",rn=/&(?:amp|lt|gt|quot|#39);/g,on=/[&<>"']/g,sn=RegExp(rn.source),cn=RegExp(on.source),dn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ln=/^\w*$/,un=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fn=/[\\^$.*+?()[\]{}|]/g,pn=RegExp(fn.source),mn=/^\s+/,_n=/\s/,hn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,bn=/\\(\\)?/g,gn=/\w*$/,vn=/^[-+]0x[0-9a-f]+$/i,yn=/^0b[01]+$/i,Sn=/^\[object .+?Constructor\]$/,Dn=/^0o[0-7]+$/i,In=/^(?:0|[1-9]\d*)$/,xn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Cn="\\ud800-\\udfff",On="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",wn="\\u2700-\\u27bf",En="a-z\\xdf-\\xf6\\xf8-\\xff",An="A-Z\\xc0-\\xd6\\xd8-\\xde",Ln="\\ufe0e\\ufe0f",kn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Mn="["+Cn+"]",Pn="["+kn+"]",Tn="["+On+"]",Un="\\d+",Fn="["+wn+"]",Hn="["+En+"]",Rn="[^"+Cn+kn+Un+wn+En+An+"]",Nn="\\ud83c[\\udffb-\\udfff]",Bn="[^"+Cn+"]",jn="(?:\\ud83c[\\udde6-\\uddff]){2}",Vn="[\\ud800-\\udbff][\\udc00-\\udfff]",zn="["+An+"]",Gn="(?:"+Hn+"|"+Rn+")",Kn="(?:"+zn+"|"+Rn+")",Wn="(?:['](?:d|ll|m|re|s|t|ve))?",qn="(?:['](?:D|LL|M|RE|S|T|VE))?",Qn="(?:"+Tn+"|"+Nn+")?",Yn="["+Ln+"]?",Jn=Yn+Qn+"(?:\\u200d(?:"+[Bn,jn,Vn].join("|")+")"+Yn+Qn+")*",Xn="(?:"+[Fn,jn,Vn].join("|")+")"+Jn,Zn="(?:"+[Bn+Tn+"?",Tn,jn,Vn,Mn].join("|")+")",$n=RegExp("[']","g"),ea=RegExp(Tn,"g"),ta=RegExp(Nn+"(?="+Nn+")|"+Zn+Jn,"g"),na=RegExp([zn+"?"+Hn+"+"+Wn+"(?="+[Pn,zn,"$"].join("|")+")",Kn+"+"+qn+"(?="+[Pn,zn+Gn,"$"].join("|")+")",zn+"?"+Gn+"+"+Wn,zn+"+"+qn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Un,Xn].join("|"),"g"),aa=RegExp("[\\u200d"+Cn+On+Ln+"]"),ia=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ra={};ra[Yt]=ra[Jt]=ra[Xt]=ra[Zt]=ra[$t]=ra[en]=ra[tn]=ra[nn]=ra[an]=!0,ra[wt]=ra[Et]=ra[qt]=ra[Lt]=ra[Qt]=ra[kt]=ra[Mt]=ra[Pt]=ra[Ut]=ra[Ft]=ra[Rt]=ra[jt]=ra[Vt]=ra[zt]=ra[Wt]=!1;var oa={};oa[wt]=oa[Et]=oa[qt]=oa[Qt]=oa[Lt]=oa[kt]=oa[Yt]=oa[Jt]=oa[Xt]=oa[Zt]=oa[$t]=oa[Ut]=oa[Ft]=oa[Rt]=oa[jt]=oa[Vt]=oa[zt]=oa[Gt]=oa[en]=oa[tn]=oa[nn]=oa[an]=!0,oa[Mt]=oa[Pt]=oa[Wt]=!1;var sa=parseFloat,ca=parseInt,da="object"==typeof e&&e&&e.Object===Object&&e,la="object"==typeof self&&self&&self.Object===Object&&self,ua=da||la||Function("return this")(),fa=t&&!t.nodeType&&t,pa=fa&&"object"==typeof n&&n&&!n.nodeType&&n,ma=(Ji=pa&&pa.exports===fa)&&da.process,_a=function(){try{return pa&&pa.require&&pa.require("util").types||ma&&ma.binding&&ma.binding("util")}catch(e){}}(),ha=_a&&_a.isMap,ba=_a&&_a.isRegExp,ga=_a&&_a.isSet,va=_a&&_a.isTypedArray,ya=m("length"),Sa=_({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Da=_({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Ia=_({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),xa=Array.prototype,Ca=Function.prototype,Oa=Object.prototype,wa=ua["__core-js_shared__"],Ea=Ca.toString,Aa=Oa.hasOwnProperty,La=function(){var e=/[^.]+$/.exec(wa&&wa.keys&&wa.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ka=Oa.toString,Ma=Ea.call(Object),Pa=RegExp("^"+Ea.call(Aa).replace(fn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ta=Ji?ua.Buffer:pt,Ua=ua.Symbol,Fa=ua.Uint8Array,Ha=Ta?Ta.allocUnsafe:pt,Ra=S(Object.getPrototypeOf,Object),Na=Object.create,Ba=Oa.propertyIsEnumerable,ja=xa.splice,Va=Ua?Ua.isConcatSpreadable:pt,za=Ua?Ua.iterator:pt,Ga=Ua?Ua.toStringTag:pt,Ka=function(){try{var e=be(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Wa=Math.ceil,qa=Math.floor,Qa=Object.getOwnPropertySymbols,Ya=Ta?Ta.isBuffer:pt,Ja=ua.isFinite,Xa=S(Object.keys,Object),Za=Math.max,$a=Math.min,ei=Date.now,ti=Math.random,ni=be(ua,"DataView"),ai=be(ua,"Map"),ii=be(ua,"Promise"),ri=be(ua,"Set"),oi=be(ua,"WeakMap"),si=be(Object,"create"),ci=Le(ni),di=Le(ai),li=Le(ii),ui=Le(ri),fi=Le(oi),pi=Ua?Ua.prototype:pt,mi=pi?pi.valueOf:pt,_i=pi?pi.toString:pt,hi=function(){function e(){}return function(t){if(!Ve(t))return{};if(Na)return Na(t);e.prototype=t;var n=new e;return e.prototype=pt,n}}();O.prototype.clear=function(){this.__data__=si?si(null):{},this.size=0},O.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},O.prototype.get=function(e){var t=this.__data__;if(si){var n=t[e];return n===ht?pt:n}return Aa.call(t,e)?t[e]:pt},O.prototype.has=function(e){var t=this.__data__;return si?t[e]!==pt:Aa.call(t,e)},O.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=si&&t===pt?ht:t,this},w.prototype.clear=function(){this.__data__=[],this.size=0},w.prototype.delete=function(e){var t=this.__data__,n=T(t,e);return!(n<0||(n==t.length-1?t.pop():ja.call(t,n,1),--this.size,0))},w.prototype.get=function(e){var t=this.__data__,n=T(t,e);return n<0?pt:t[n][1]},w.prototype.has=function(e){return T(this.__data__,e)>-1},w.prototype.set=function(e,t){var n=this.__data__,a=T(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this},E.prototype.clear=function(){this.size=0,this.__data__={hash:new O,map:new(ai||w),string:new O}},E.prototype.delete=function(e){var t=he(this,e).delete(e);return this.size-=t?1:0,t},E.prototype.get=function(e){return he(this,e).get(e)},E.prototype.has=function(e){return he(this,e).has(e)},E.prototype.set=function(e,t){var n=he(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this},A.prototype.add=A.prototype.push=function(e){return this.__data__.set(e,ht),this},A.prototype.has=function(e){return this.__data__.has(e)},L.prototype.clear=function(){this.__data__=new w,this.size=0},L.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},L.prototype.get=function(e){return this.__data__.get(e)},L.prototype.has=function(e){return this.__data__.has(e)},L.prototype.set=function(e,t){var n=this.__data__;if(n instanceof w){var a=n.__data__;if(!ai||a.length<mt-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new E(a)}return n.set(e,t),this.size=n.size,this};var bi=function(e,t){return function(t,n){if(null==t)return t;if(!Re(t))return e(t,n);for(var a=t.length,i=-1,r=Object(t);++i<a&&!1!==n(r[i],i,r););return t}}(B),gi=function(e,t,n){for(var a=-1,i=Object(e),r=n(e),o=r.length;o--;){var s=r[++a];if(!1===t(i[s],s,i))break}return e},vi=Ka?function(e,t){return Ka(e,"toString",{configurable:!0,enumerable:!1,value:ot(t),writable:!0})}:st,yi=ri&&1/D(new ri([,-0]))[1]==Dt?function(e){return new ri(e)}:dt,Si=Qa?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,a=null==e?0:e.length,i=0,r=[];++n<a;){var o=e[n];t(o)&&(r[i++]=o)}return r}(Qa(e),function(t){return Ba.call(e,t)}))}:ut,Di=Qa?function(e){for(var t=[];e;)d(t,Si(e)),e=Ra(e);return t}:ut,Ii=z;(ni&&Ii(new ni(new ArrayBuffer(1)))!=Qt||ai&&Ii(new ai)!=Ut||ii&&Ii(ii.resolve())!=Nt||ri&&Ii(new ri)!=Vt||oi&&Ii(new oi)!=Wt)&&(Ii=function(e){var t=z(e),n=t==Rt?e.constructor:pt,a=n?Le(n):"";if(a)switch(a){case ci:return Qt;case di:return Ut;case li:return Nt;case ui:return Vt;case fi:return Wt}return t});var xi=function(e){var t=0,n=0;return function(){var a=ei(),i=16-(a-n);if(n=a,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(pt,arguments)}}(vi),Ci=function(e){var t=Fe(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(un,function(e,n,a,i){t.push(a?i.replace(bn,"$1"):n||e)}),t},function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(),Oi=X(function(e,t){return Ne(e)?R(e,N(t,1,Ne,!0)):[]}),wi=X(function(e,t){var n=Me(t);return Ne(n)&&(n=pt),Ne(e)?R(e,N(t,1,Ne,!0),_e(n,2)):[]}),Ei=X(function(e,t){var n=Me(t);return Ne(n)&&(n=pt),Ne(e)?R(e,N(t,1,Ne,!0),pt,n):[]}),Ai=X(function(e){var t=c(e,ne);return t.length&&t[0]===e[0]?function(e,t,n){for(var a=o,i=e[0].length,r=e.length,s=r,c=Array(r),d=1/0,l=[];s--;){var u=e[s];d=$a(u.length,d),c[s]=i>=120&&u.length>=120?new A(s&&u):pt}u=e[0];var f=-1,p=c[0];e:for(;++f<i&&l.length<d;){var m=u[f],_=m;if(m=0!==m?m:0,!(p?g(p,_):a(l,_,n))){for(s=r;--s;){var h=c[s];if(!(h?g(h,_):a(e[s],_,n)))continue e}p&&p.push(_),l.push(m)}}return l}(t):[]}),Li=X(function(e,t){return Ne(e)?R(e,t):[]}),ki=function(e){return function(t,n,a){var i=Object(t);if(!Re(t)){var r=_e(n,3);t=et(t),n=function(e){return r(i[e],e,i)}}var o=e(t,n,a);return o>-1?i[r?t[o]:o]:pt}}(ke),Mi=function(e,t){return function(t,n){return(Fi(t)?i:U)(t,e,_e(n,2),{})}}(function(e,t,n){Aa.call(e,n)?e[n].push(t):F(e,n,[t])}),Pi=X(function(e,t){if(null==e)return[];var n=t.length;return n>1&&De(e,t[0],t[1])?t=[]:n>2&&De(t[0],t[1],t[2])&&(t=[t[0]]),function(e,t,n){t=t.length?c(t,function(e){return Fi(e)?function(t){return j(t,1===e.length?e[0]:e)}:e}):[st];var a=-1;return t=c(t,b(_e())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].c;return e}(function(e,t){var n=-1,a=Re(e)?Array(e.length):[];return bi(e,function(e,i,r){a[++n]=t(e)}),a}(e,function(e,n,i){return{a:c(t,function(t){return t(e)}),b:++a,c:e}}),function(e,t){return function(e,t,n){for(var a=-1,i=e.a,r=t.a,o=i.length,s=n.length;++a<o;){var c=ce(i[a],r[a]);if(c)return a>=s?c:c*("desc"==n[a]?-1:1)}return e.b-t.b}(e,t,n)})}(e,N(t,1),[])}),Ti=function(){return ua.Date.now()};Fe.Cache=E;var Ui=W(function(){return arguments}())?W:function(e){return ze(e)&&Aa.call(e,"callee")&&!Ba.call(e,"callee")},Fi=Array.isArray,Hi=Ya||ft,Ri=ha?b(ha):function(e){return ze(e)&&Ii(e)==Ut},Ni=ba?b(ba):function(e){return ze(e)&&z(e)==jt},Bi=ga?b(ga):function(e){return ze(e)&&Ii(e)==Vt},ji=va?b(va):function(e){return ze(e)&&je(e.length)&&!!ra[z(e)]},Vi=ue(function(e,t){if(xe(t)||Re(t))return le(t,et(t),e),pt;for(var n in t)Aa.call(t,n)&&P(e,n,t[n])}),zi=ue(function(e,t){le(t,tt(t),e)}),Gi=function(e,t){return function(n,a){return function(e,t,n,a){return B(e,function(e,i,r){t(a,n(e),i,r)}),a}(n,e,t(a),{})}}(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ka.call(t)),e[t]=n},ot(st)),Ki=ue(function(e,t,n){J(e,t,n)}),Wi=function(e){return function(t){var n=Ii(t);return n==Ut?y(t):n==Vt?function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}(t):function(e,t){return c(t,function(t){return[t,e[t]]})}(t,e(t))}}(et),qi=function(e){return function(t){return function(e,t,n,a){for(var i=-1,r=null==e?0:e.length;++i<r;)n=t(n,e[i],i,e);return n}(rt(it(t).replace($n,"")),e,"")}}(function(e,t,n){return t=t.toLowerCase(),e+(n?at(t):t)}),Qi=function(e){var t=v(e=Xe(e))?I(e):pt,n=t?t[0]:e.charAt(0),a=t?ie(t,1).join(""):e.slice(1);return n.toUpperCase()+a},Yi=function(e){var t=Math.round;return function(e,n){if(e=Ye(e),(n=null==n?0:$a(Qe(n),292))&&Ja(e)){var a=(Xe(e)+"e").split("e");return+((a=(Xe(t(a[0]+"e"+(+a[1]+n)))+"e").split("e"))[0]+"e"+(+a[1]-n))}return t(e)}}();C.assign=Vi,C.assignIn=zi,C.before=Te,C.chunk=function(e,t,n){t=(n?De(e,t,n):t===pt)?1:Za(Qe(t),0);var a=null==e?0:e.length;if(!a||t<1)return[];for(var i=0,r=0,o=Array(Wa(a/t));i<a;)o[r++]=$(e,i,i+=t);return o},C.constant=ot,C.debounce=Ue,C.difference=Oi,C.differenceBy=wi,C.differenceWith=Ei,C.flatten=function(e){return null!=e&&e.length?N(e,1):[]},C.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,a={};++t<n;){var i=e[t];a[i[0]]=i[1]}return a},C.groupBy=Mi,C.intersection=Ai,C.invert=Gi,C.iteratee=ct,C.keys=et,C.keysIn=tt,C.memoize=Fe,C.merge=Ki,C.once=function(e){return Te(2,e)},C.property=lt,C.set=function(e,t,n){return null==e?e:Z(e,t,n)},C.sortBy=Pi,C.throttle=function(e,t,n){var a=!0,i=!0;if("function"!=typeof e)throw new TypeError(_t);return Ve(n)&&(a="leading"in n?!!n.leading:a,i="trailing"in n?!!n.trailing:i),Ue(e,t,{leading:a,maxWait:t,trailing:i})},C.toArray=function(e){if(!e)return[];if(Re(e))return Ke(e)?I(e):de(e);if(za&&e[za])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[za]());var t=Ii(e);return(t==Ut?y:t==Vt?D:nt)(e)},C.toPairs=Wi,C.toPlainObject=Je,C.uniq=function(e){return e&&e.length?te(e):[]},C.uniqBy=function(e,t){return e&&e.length?te(e,_e(t,2)):[]},C.unset=function(e,t){return null==e||function(e,t){return null==(e=function(e,t){return t.length<2?e:j(e,$(t,0,-1))}(e,t=ae(t,e)))||delete e[Ae(Me(t))]}(e,t)},C.update=function(e,t,n){return null==e?e:function(e,t,n,a){return Z(e,t,n(j(e,t)),void 0)}(e,t,function(e){return"function"==typeof e?e:st}(n))},C.values=nt,C.without=Li,C.words=rt,C.entries=Wi,C.extend=zi,C.camelCase=qi,C.capitalize=at,C.clone=function(e){return H(e,vt)},C.cloneDeep=function(e){return H(e,bt|vt)},C.cloneDeepWith=function(e,t){return H(e,bt|vt,t="function"==typeof t?t:pt)},C.deburr=it,C.eq=He,C.escape=function(e){return(e=Xe(e))&&cn.test(e)?e.replace(on,Da):e},C.escapeRegExp=function(e){return(e=Xe(e))&&pn.test(e)?e.replace(fn,"\\$&"):e},C.find=ki,C.findIndex=ke,C.findKey=function(e,t){return function(e,t,n){var a;return n(e,function(e,n,i){if(t(e,n,i))return a=n,!1}),a}(e,_e(t,3),B)},C.forEach=Pe,C.forIn=function(e,t){return null==e?e:gi(e,_e(t,3),tt)},C.get=Ze,C.has=function(e,t){return null!=e&&ge(e,t,G)},C.hasIn=$e,C.identity=st,C.isArguments=Ui,C.isArray=Fi,C.isArrayLike=Re,C.isArrayLikeObject=Ne,C.isBuffer=Hi,C.isElement=function(e){return ze(e)&&1===e.nodeType&&!Ge(e)},C.isEmpty=function(e){if(null==e)return!0;if(Re(e)&&(Fi(e)||"string"==typeof e||"function"==typeof e.splice||Hi(e)||ji(e)||Ui(e)))return!e.length;var t=Ii(e);if(t==Ut||t==Vt)return!e.size;if(xe(e))return!Y(e).length;for(var n in e)if(Aa.call(e,n))return!1;return!0},C.isEqual=function(e,t){return q(e,t)},C.isFunction=Be,C.isLength=je,C.isMap=Ri,C.isObject=Ve,C.isObjectLike=ze,C.isPlainObject=Ge,C.isRegExp=Ni,C.isSet=Bi,C.isString=Ke,C.isSymbol=We,C.isTypedArray=ji,C.last=Me,C.stubArray=ut,C.stubFalse=ft,C.noop=dt,C.now=Ti,C.random=function(e,t,n){if(n&&"boolean"!=typeof n&&De(e,t,n)&&(t=n=pt),n===pt&&("boolean"==typeof t?(n=t,t=pt):"boolean"==typeof e&&(n=e,e=pt)),e===pt&&t===pt?(e=0,t=1):(e=qe(e),t===pt?(t=e,e=0):t=qe(t)),e>t){var a=e;e=t,t=a}if(n||e%1||t%1){var i=ti();return $a(e+i*(t-e+sa("1e-"+((i+"").length-1))),t)}return function(e,t){return e+qa(ti()*(t-e+1))}(e,t)},C.round=Yi,C.sumBy=function(e,t){return e&&e.length?function(e,t){for(var n,a=-1,i=e.length;++a<i;){var r=t(e[a]);r!==pt&&(n=n===pt?r:n+r)}return n}(e,_e(t,2)):0},C.times=function(e,t){if((e=Qe(e))<1||e>It)return[];var n=Ot,a=$a(e,Ot);t=_e(t),e-=Ot;for(var i=h(a,t);++n<e;)t(n);return i},C.toFinite=qe,C.toInteger=Qe,C.toNumber=Ye,C.toString=Xe,C.trimEnd=function(e,t,n){if((e=Xe(e))&&(n||t===pt))return e.slice(0,x(e)+1);if(!e||!(t=ee(t)))return e;var a=I(e);return ie(a,0,function(e,t){for(var n=e.length;n--&&f(t,e[n],0)>-1;);return n}(a,I(t))+1).join("")},C.trimStart=function(e,t,n){if((e=Xe(e))&&(n||t===pt))return e.replace(mn,"");if(!e||!(t=ee(t)))return e;var a=I(e);return ie(a,function(e,t){for(var n=-1,a=e.length;++n<a&&f(t,e[n],0)>-1;);return n}(a,I(t))).join("")},C.truncate=function(e,t){var n=30,a="...";if(Ve(t)){var i="separator"in t?t.separator:i;n="length"in t?Qe(t.length):n,a="omission"in t?ee(t.omission):a}var r=(e=Xe(e)).length;if(v(e)){var o=I(e);r=o.length}if(n>=r)return e;var s=n-function(e){return v(e)?function(e){for(var t=ta.lastIndex=0;ta.test(e);)++t;return t}(e):ya(e)}(a);if(s<1)return a;var c=o?ie(o,0,s).join(""):e.slice(0,s);if(i===pt)return c+a;if(o&&(s+=c.length-s),Ni(i)){if(e.slice(s).search(i)){var d,l=c;for(i.global||(i=RegExp(i.source,Xe(gn.exec(i))+"g")),i.lastIndex=0;d=i.exec(l);)var u=d.index;c=c.slice(0,u===pt?s:u)}}else if(e.indexOf(ee(i),s)!=s){var f=c.lastIndexOf(i);f>-1&&(c=c.slice(0,f))}return c+a},C.unescape=function(e){return(e=Xe(e))&&sn.test(e)?e.replace(rn,Ia):e},C.upperFirst=Qi,C.each=Pe,C.VERSION="4.17.21";var Ji={};return C.each(Object.keys(C),function(e){Ji[e]=C[e]}),Ji},n.exports=a()}).call(this,n(48),n(49)(e))},function(e,t,n){"use strict";function a(e,t,n){return fetch(e,Object.assign(Object.assign({},!n&&{credentials:"include"}),{redirect:"manual",headers:Object.assign({Accept:"application/json","Content-Type":"application/json"},t)}))}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});const a="BrokerLogon",i="/_layouts/15/brokerlogon.aspx"},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a,i,r=n(6);!function(e){e.Name="Route.Config",e.RouteStoreName="Route",e.RouteStoreKeyPath="path",e.RouteStoreLastReadIndex="lastRead"}(a||(a={})),function(e){e[e.MaxRoutes=160]="MaxRoutes"}(i||(i={}));class o extends r.t{constructor(){super(a.Name,1)}getAllRoutes(){const e=this.store(a.RouteStoreName);return super.getAll(e)}saveRoute(e){const t=this.store(a.RouteStoreName,r.e.ReadWrite);return this.put(e,t)}saveRoutes(e){const t=this.store(a.RouteStoreName,r.e.ReadWrite);return this.putMany(e,t)}deleteRoute(e){const t=this.store(a.RouteStoreName,r.e.ReadWrite);return this.delete(e,t)}maintain(){return Promise.all([this.trimStore(this.store(a.RouteStoreName,r.e.ReadWrite),a.RouteStoreLastReadIndex,i.MaxRoutes)]).then(void 0)}upgrade(e){this.createStore(a.RouteStoreName,a.RouteStoreKeyPath,e).createIndex(a.RouteStoreLastReadIndex,a.RouteStoreLastReadIndex)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});const a=/[?&]debug=true/.test(self.location.href);self.location.host.endsWith(".mcas.ms");class i{constructor(){this.router=this.createRouter()}start(){this._parseConfig(),this._config.applications&&!self._shouldBypass&&this._config.applications.forEach(this.enableApplication.bind(this)),this.router.start()}get config(){return this._config}enableApplication(e){this.router.register(this.createController(e.id))}_parseConfig(){let e;const t=new URL(self.location.href).searchParams.get("applications");if(t)try{e=JSON.parse(t)}catch(e){console.error(e)}this._config={applications:e}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});class a{constructor(e){this._ua=e||self.navigator.userAgent}get mobile(){return a._mobile.test(this._ua)}get inTune(){return-1!==this._ua.indexOf("ManagedBrowser")}get teams(){return a._teamsWebView.test(this._ua)}get webView(){return this.teams||a._iosWebView.test(this._ua)||a._androidWebView.test(this._ua)||a._androidLollipop.test(this._ua)}get chromeless(){return this.webView&&!this.inTune}get firefox(){return a._firefox.test(this._ua)}get lang(){if(void 0===this._language){const e=(self.navigator.language||"").split("-"),t=e.length;t>1&&(e[t-1]=e[t-1].toUpperCase(),t>2&&(e[1]=e[1].charAt(0).toUpperCase()+e[1].slice(1))),this._language=e.join("-")}return this._language}}a.current=new a,a._mobile=/(Android|iPhone|iPod|iPad)/,a._teamsWebView=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/,a._iosWebView=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/,a._androidWebView=/(Android ).*; wv/,a._androidLollipop=/(Android ).* Version\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/,a._firefox=/Firefox\/([0-9]+)\./},function(e,t,n){"use strict";n.d(t,"e",function(){return a});class a{get loaded(){return this._loaded}install(){return this._install||(this._install=this.sync())}sync(){return Promise.resolve()}willMaintain(){return this._maintain=void 0}maintain(e){if(this._maintain&&!e)return this._maintain;const t=this.createDatabase();return this._maintain=t.open().then(this.maintainDatabase.bind(this,t)).then(t.close.bind(t))}load(e){if(this._load&&!e)return this._load;const t=this.createDatabase();return this._load=t.open().then(this.loadConfig.bind(this,t)).then(()=>{t.close(),this._loaded=!0})}maintainDatabase(e){return e.maintain()}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(16);function i(e){const t=Object(a.n)();t&&t.postMessage(e)}},function(e,t,n){"use strict";var a;function i(e){return e&&(!e.status||302===e.status||e.type===a.OpaqueRedirect||301===e.status)}n.d(t,"e",function(){return i}),function(e){e.Basic="basic",e.Cors="cors",e.Error="error",e.Opaque="opaque",e.OpaqueRedirect="opaqueredirect"}(a||(a={}))},function(e,t,n){"use strict";function a(e,t){const n=e.split("."),a=t.split(".");for(let e=0;e<n.length;e++){const t=parseInt(n[e],10),i=parseInt(a[e],10);if(t>i)return 1;if(t<i)return-1}return 0}function i(e,t){return-1!==a(e,t)}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e.TeamSite="64",e.CommunicationSite="68"}(a||(a={})),function(e){e.Version="x-odsp-web-version"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(40);class i{constructor(){this.config=a.e.current}initialize(){return this.config.load().then(()=>this)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(9),i=n(34),r=n(31);class o extends i.e{constructor(){super(),this._exactPaths=new Map,this._regexPaths=new Map,this._loadRoute=e=>{e.regex?this._regexPaths.set(new RegExp(e.path),e.applicationId):this._exactPaths.set(e.path,e.applicationId)}}lookupRoute(e){const t=Object(a.e)(e),n=this._exactPaths.get(t);if(n)return n;const i=this._regexPaths.entries();let r;for(;!(r=i.next()).done;)if(r.value[0].test(t))return r.value[1]}saveRoute(e,t){const n=Object(a.e)(e),i={path:n,applicationId:t,lastRead:new Date};this._exactPaths.set(n,t);const o=new r.e;return o.open().then(()=>o.saveRoute(i).then(()=>(o.close(),i)))}saveRoutes(e){e.forEach(this._loadRoute);const t=new r.e;return t.open().then(()=>t.saveRoutes(e).then(()=>{t.close()}))}deleteRoute(e){this._exactPaths.delete(e=Object(a.e)(e));const t=new r.e;return t.open().then(()=>t.deleteRoute(e).then(()=>{t.close()}))}createDatabase(){return new r.e}loadConfig(e){return e.getAllRoutes().then(e=>{e.forEach(this._loadRoute)})}}o.current=new o},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.Audio="audio",e.Video="video",e.Track="track",e.Script="script",e.Style="style",e.Font="font",e.Image="image",e.Fetch="fetch",e.Worker="worker",e.Embed="embed",e.Document="document"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(36);function i(e){return{code:Object(a.e)(e)?"Redirect":e?e.status.toString():"NoResponse",correlationId:e&&e.headers.get("request-id")}}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a,i=n(5),r=n(11),o=n(9),s=n(17),c=n(3),d=n(18),l=n(20);!function(e){e.Audio="audio",e.AudioWorklet="audioworklet",e.Document="document",e.Embed="embed",e.Font="font",e.Image="image",e.Manifest="manifest",e.Object="object",e.PaintWorklet="paintworklet",e.Report="report",e.Script="script",e.ServiceWorker="serviceworker",e.SharedWorker="sharedworker",e.Style="style",e.Track="track",e.Video="video",e.Worker="worker",e.Xslt="xslt"}(a||(a={}));var u=n(10);class f{get context(){return this._context||(this._context=this.createContext().initialize())}install(){return Promise.resolve(this.precache())}precache(e){return this.context.then(t=>this.precacheWithContext(t,e))}activate(){return this.context.then(e=>this.willMaintain(e).then(this.maintain.bind(this,e)))}deactivate(){}willSync(e){if(e.tag===d.e.Maintain)return this.context.then(e=>this.willMaintain(e))}sync(e){var t,n,a;switch(e.tag){case d.e.Precache:return this.precache();case d.e.Maintain:return this.context.then(e=>this.maintain(e));case d.e.ReloadConfigs:return this.context.then(e=>Promise.all([e.routeConfig.load(),e.config.load(!0)]).then());case d.e.Prerender:return this.prerender(null===(t=e.args)||void 0===t?void 0:t.path);case d.e.SavePage:return this.savePage(null===(n=e.args)||void 0===n?void 0:n.page,null===(a=e.args)||void 0===a?void 0:a.overwrite)}}message(e){}navigate(e,t,n,a){return this.context.then(i=>this.createNavigationHandler(i).navigate(e,t,n,a))}fetch(e){const t=e.request,n=Object(o.e)(t.url);this._resourceRoutes||(this._resourceRoutes=this.resourceRoutes());const a=this._resourceRoutes.length;for(let o=0;o<a;o++)if(this._resourceRoutes[o].match(n,t)){const a="POST"===t.method?t.clone():t;return this._resourceRoutes[o].fetch(e).catch(t=>{if(t&&!(t instanceof SyntaxError||t instanceof TypeError||"NetworkError"===t.name)){const a=Object(i.t)("BaseApplicationController.fetch",e);Object(r.t)(a,t,void 0,void 0,{App:this.applicationId,name:n.substring(n.lastIndexOf("/")+1)})}return fetch(a)})}}loopbackFilename(e){return e.substring(e.indexOf(c.n)+c.n.length)}isLoopback(e){return 0===e.indexOf(c.n)}fetchLoopback(e){}isCacheable(e,t){switch(t.destination){case a.Script:if(0===t.url.indexOf("https://localhost:")||0===t.url.indexOf("https://odspwebdevdeploy.blob.core.windows.net"))return!1;case a.Font:case a.Style:return 0===t.url.indexOf("https://")}return!1}fetchCacheable(e){return this.context.then(t=>Object(u.t)(e,t.config.state.cache))}js(e){return new Response(e,{headers:{"Content-Type":"application/javascript","Access-Control-Allow-Origin":"*","Cache-Control":"public, max-age=31536000"}})}precacheWithContext(e,t){}willMaintain(e){return Promise.all([e.routeConfig.willMaintain(),e.config.willMaintain()]).then()}maintain(e){return Object(s.e)([e.routeConfig.maintain(),e.config.maintain(),Object(u.a)(c.a,e.config.state&&e.config.state.cache)]).then()}prerender(e){const t=`${c.e}${e}`;return this.context.then(e=>{const n=this.createNavigationHandler(e),a=Object(l.i)(t),i=new FetchEvent("fetch",{request:new Request(t)});return n.navigate(i,a,void 0,!1).then()})}savePage(e,t){return this.context.then(n=>n.config.getPage(e.path).then(a=>n.config.savePage(Object.assign(!t&&a||{},e))))}resourceRoutes(){return[{match:this.isLoopback.bind(this),fetch:this.fetchLoopback.bind(this)},{match:this.isCacheable.bind(this),fetch:this.fetchCacheable.bind(this)}]}}},,function(e,t,n){"use strict";function a(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}n.d(t,"e",function(){return a})},,function(e,t,n){e.exports=n(50)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"IsMySiteHost",function(){return bt}),n.d(t,"IsIsolatedAppHost",function(){return gt}),n.d(t,"IsPortal",function(){return vt}),n.d(t,"IsListV2",function(){return yt}),n.d(t,"default",function(){return St});var a=n(5),i=function(){var e,t;this.promise=new Promise(function(n,a){e=n,t=a}),this.resolve=e,this.reject=t},r=n(32),o=n(20),s=n(0),c=n(43),d=n(33),l=n(40),u=n(23);class f extends class{constructor(){this.userAgent=d.e.current,this.routeConfig=l.e.current}initialize(){return this.config.load().then(()=>this)}}{constructor(){super(...arguments),this.config=u.e.current}}var p=n(22),m=n(27);class _ extends m.t{constructor(e,t){super(e,t)}trimEndHtml(e){return e.replace(_._endHtml,"")}parseHtml(e){return{html:this.trimEndHtml(e)}}parseNavigationResult(e){return e.text().then(e=>(this._spPageContext=JSON.parse(Object(p.e)(e,"var _spPageContextInfo=",";_spPageContextInfo.")),this.parseHtml(e)))}get spPageContext(){return this._spPageContext}createPage(){return Object.assign(Object.assign({},super.createPage()),this.navigationResult)}renderHtml(e){e.write(this.navigationResult.html),e.flush()}html(){return this.navigationResultReady.then(()=>this.renderHtml.bind(this))}renderPhases(){return[this.html()]}}_._endHtml=/<\/(body|html)>/g;class h extends _{constructor(e,t){super(e,t),this.startOffline=!0}updateModels(e){e===this._navigationResultFromConfig&&(this._page=this.createPage())}initialize(e,t){return super.initialize(e,t)}parseNavigationResult(e){return e.text().then(e=>({html:e}))}renderHtml(e){e.write(this._renderResponse),e.endHtml(),e.close()}html(){return this.preloadResponse.then(()=>(this._renderResponse=this.navigationResult.html,this.renderHtml.bind(this))).catch(e=>this.navigationResult&&this.url.search.toLocaleLowerCase().includes("vivaconnections=true")?(this._renderResponse=this.navigationResult.html.replace("isAuthRequired = true","isAuthRequired = false"),this.renderHtml.bind(this)):this._redirectToBypass.bind(this))}get spPageContext(){return{}}get title(){return"Loading..."}get navigationResultKey(){return this.url.pathname+this.url.search}_redirectToBypass(e){return this.redirect(this.bypassUrl(),e)}}const b="TeamsLogon";class g extends c.e{constructor(){super(),this.applicationId=b}knownPaths(){return[{path:"/_layouts/15/teamslogon.aspx"}]}createContext(){return new f}createNavigationHandler(e){return new h(this,e)}}var v=n(10);class y extends o.t{constructor(e){super(e),this._interceptiblePostUrl=/_layouts\/15\/(FilePicker|FileBrowser)\.aspx/i,this._bypassRequestUrl=/\/teamslogon\.aspx/,o.a.active=Object(s.t)(s.e.reorderBypassUrl),o.n.active=Object(s.t)(s.e.preserveClients),v.r.active=Object(s.t)(s.e.precacheDeduplication)}get enablePeriodicSync(){return!Object(s.t)(s.e.periodicMaintenance)}isNavigationIntercepted(e){return!(!this._applications.has(b)&&this._bypassRequestUrl.test(e.url))&&(super.isNavigationIntercepted(e)||"POST"===e.method&&this._interceptiblePostUrl.test(e.url))}getNavigationPreloadResponse(e){const{request:t}=e;return"POST"===t.method?fetch(t,{headers:Object.assign(Object.assign({},Object(a.n)(t.headers)),{"x-override-origin":t.headers.get("origin")})}):super.getNavigationPreloadResponse(e)}}var S,D=n(30),I=n(18),x=n(14),C=n(25),O=n(4);!function(e){e.Script="Script"}(S||(S={}));class w extends x.t{install(){return C.t.current.install().then(()=>super.install())}sync(e){switch(e.tag){case S.Script:return this.context.then(t=>t.spfxConfig.syncManifests(e.langs,e.force));case I.e.ReloadConfigs:return this.context.then(t=>Promise.all([super.sync(e),t.spfxConfig.load(!0)]).then())}return super.sync(e)}message(e){}precacheWithContext(e,t){const n=this.precachedComponents(e),a=e.config.state,i=new Set;if(n&&e.spfxConfig.scriptSyncState&&e.spfxConfig.scriptSyncState.langs){const a=n.length,r=e.spfxConfig.scriptSyncState.langs.values();let o;for(;!(o=r.next()).done;)for(let r=0;r<a;r++){const a=e.spfxConfig.scriptUrl(n[r],o.value);t&&!t(a,o.value)||i.add(a)}}return Promise.all([super.precacheWithContext(e),Object(v.i)(Array.from(i),a.cache)]).then()}willMaintain(e){return super.willMaintain(e).then(()=>e.spfxConfig.willMaintain())}maintain(e){return Promise.all([e.spfxConfig.maintain(),super.maintain(e)]).then()}isComponentFetch(e){return e.endsWith("/_api/web/getclientsidecomponents")}fetchComponents(e){return Promise.all([e.request.clone().json(),this.context]).then(t=>{const n=t[0].components;return t[1].spfxConfig.findComponents(n,e,!C.t.durableGen2Killswitch&&t[1].config.isFlightEnabled(O.e.SpfxDurableN1)).then(e=>{const t=e.map(e=>({ComponentType:this._toComponentType(e.componentType),Id:e.id,Manifest:JSON.stringify(e),ManifestType:1,Name:e.id,Status:0}));return new Response(JSON.stringify({value:t}),{headers:{"Content-Type":"application/json"}})})})}isWebPartFetch(e){return e.endsWith("/_api/web/getclientsidewebparts")}fetchWebParts(e){return this._fetchComponents(e,[C.e.WebPart])}isComponentFetchByType(e){return e.includes("/_api/web/getclientsidecomponentsbycomponenttype(")}fetchComponentsByType(e){const t=(Object(p.e)(e.request.url,"componentTypesString='","'")||"").split(",").map(e=>parseInt(e,10));return this._fetchComponents(e,t)}resourceRoutes(){return super.resourceRoutes().concat([{match:this.isComponentFetch.bind(this),fetch:this.fetchComponents.bind(this)},{match:this.isComponentFetchByType.bind(this),fetch:this.fetchComponentsByType.bind(this)},{match:this.isWebPartFetch.bind(this),fetch:this.fetchWebParts.bind(this)}])}_fetchComponents(e,t){return Promise.all([fetch(e.request,{credentials:"include"}).then(e=>e.json()),this.context]).then(n=>{if(!C.t.durableGen2Killswitch&&n[1].config.isFlightEnabled(O.e.SpfxDurableN1))return n[1].spfxConfig.getGeneration(e).then(e=>{const a=n[0].value.filter(e=>-1!==t.indexOf(e.ComponentType)).map(t=>{const a=n[1].spfxConfig.getComponent(t.Id,void 0,e);return(null==a?void 0:a.isInternal)&&(t.Manifest=JSON.stringify(a)),t});return new Response(JSON.stringify({value:a}),{headers:{"Content-Type":"application/json"}})});{const a=n[1].spfxConfig.old_getGeneration(e),i=n[0].value.filter(e=>-1!==t.indexOf(e.ComponentType)).map(e=>{const t=n[1].spfxConfig.getComponent(e.Id,void 0,a);return(null==t?void 0:t.isInternal)&&(e.Manifest=JSON.stringify(t)),e});return new Response(JSON.stringify({value:i}),{headers:{"Content-Type":"application/json"}})}})}_toComponentType(e){switch(e){case"Library":return 3;case"WebPart":return 1;case"Application":return 2;case"Extension":return 4;case"AdaptiveCardExtension":return 7;case"ProviderHostedApp":return 5;case"Assembly":return 6}}}class E extends f{constructor(){super(...arguments),this.spfxConfig=C.t.current}initialize(){return this.spfxConfig.load().then(super.initialize.bind(this))}}var A=n(2),L=n(7),k=n(15);class M extends k.e{constructor(e,t){super(e,t),this.componentId=A.e.SPBrokerLoginApplication,this.assemblyId=A.e.BrokerLoginAssembly,this.startOffline=!0}get preloadedData(){return this.navigationResult}get isUserAuthenticated(){var e,t,n;return null===(n=null===(t=null===(e=this.preloadedData)||void 0===e?void 0:e.page)||void 0===t?void 0:t.Content)||void 0===n?void 0:n.isUserAuthenticated}get homeSiteUrl(){var e,t,n,a;return(null===(n=null===(t=null===(e=this.preloadedData)||void 0===e?void 0:e.page)||void 0===t?void 0:t.Content)||void 0===n?void 0:n.homeSiteUrl)||(null===(a=this.page)||void 0===a?void 0:a.homeSiteUrl)}renderPhases(){return[this.shell(),this.start(),this._redirectToDest()]}renderSplash(e){}get abandonUnlessRedirected(){return!1}requiresAuthentication(){return!1}createPage(){return Object.assign(Object.assign({},super.createPage()),{homeSiteUrl:this.homeSiteUrl})}saveConfig(){return this.isUserAuthenticated&&(this.preloadedData.page.Content.isUserAuthenticated=!1),super.saveConfig()}_renderRedirectToDest(e){let t=this.url.searchParams.get("dest");const n=this.isUserAuthenticated,a=!t&&"true"===this.url.searchParams.get("vivahome"),i=!a&&"true"===this.url.searchParams.get("vivaconnections");if(i||a){const a=this.homeSiteUrl;if(a&&(t=i?a:("/"===a[a.length-1]?a.substring(0,a.length-1):a)+"/_layouts/15/VivaHome.aspx",!n))return e.inlineScript(`window.__vivaDest='${L.e.htmlEncode(t,!0)}'`,!0),void e.flush()}if(t&&n)return this.redirect(t,e)}_redirectToDest(){return this.preloadResponseReady.then(()=>this._renderRedirectToDest.bind(this))}}class P extends w{constructor(){super(),this.applicationId=D.e}knownPaths(){return[{path:D.t}]}precachedComponents(e){return[A.e.BrokerLoginAssembly,A.e.SPBrokerLoginApplication]}createContext(){return new E}createNavigationHandler(e){return new M(this,e)}}var T=n(1),U=n(3),F=n(9),H=n(8);class R extends f{}const N='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" mask-type="alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16"><path d="M0 4l4-4h11.2a.8.8 0 01.8.8V12l-4 4H.8a.8.8 0 01-.8-.8V4z" fill="#40E6E8"/></mask><g mask="url(#a)"><path d="M12 16l4-4H0v3.238c0 .42.341.762.762.762H12z" fill="#974B8B"/><path d="M0 12h4v4H.762A.762.762 0 010 15.238V12z" fill="#773C6E"/><g filter="url(#filter0_d)"><path fill="#D83B01" d="M0 8v4h16V8z"/></g><path fill="#BF3207" d="M0 8h4v4H0z"/><g filter="url(#filter1_d)"><path fill="#F18C0A" d="M0 4v4h16V4z"/></g><path fill="#E25A01" d="M0 4h4v4H0z"/><g filter="url(#filter2_d)"><path d="M4 0L0 4h16V.762A.762.762 0 0015.238 0H4z" fill="#FED912"/></g></g><defs><filter id="filter0_d" x="-5" y="4" width="26" height="14" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2.5"/><feColorMatrix type="matrix" values="0 0 0 0 0.521569 0 0 0 0 0.290196 0 0 0 0 0.505882 0 0 0 0.8 0"/><feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/></filter><filter id="filter1_d" x="-5" y="0" width="26" height="14" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2.5"/><feColorMatrix type="matrix" values="0 0 0 0 0.74902 0 0 0 0 0.196078 0 0 0 0 0.027451 0 0 0 1 0"/><feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/></filter><filter id="filter2_d" x="-6" y="-5" width="28" height="16" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="3"/><feColorMatrix type="matrix" values="0 0 0 0 0.964706 0 0 0 0 0.619608 0 0 0 0 0.0745098 0 0 0 1 0"/><feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/></filter></defs></svg>',B='<svg viewBox="0 0 100 65" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M55.544 40.121c-4.872-4.839-9.358-9.173-13.457-13.004a606.642 606.642 0 00-5.293-4.738 106.685 106.685 0 00-4.99-4.183c-1.545-1.244-2.906-2.235-4.082-2.974-1.21-.773-2.117-1.16-2.722-1.16h-.302a31.006 31.006 0 014.94-5.745 28.642 28.642 0 016.148-4.436 30.377 30.377 0 017.157-2.873A30.388 30.388 0 0150.806 0c3.63 0 7.09.588 10.384 1.764 3.293 1.176 6.266 2.823 8.92 4.94a30.699 30.699 0 016.805 7.46 31.014 31.014 0 014.133 9.324 4.653 4.653 0 00-.655-.05h-.706c-.37 0-.99.252-1.864.756a50.06 50.06 0 00-3.125 1.864 92.506 92.506 0 00-3.932 2.672 335.95 335.95 0 00-4.234 3.074 610.21 610.21 0 00-10.988 8.317z" fill="#0364B8"/><path d="M59.123 30.343l-16.23 24.244-38.407-1.26a24.554 24.554 0 01-3.276-6.654C.403 44.254 0 41.717 0 39.063c0-3.428.655-6.637 1.966-9.628 1.277-3.024 3.04-5.662 5.292-7.913 2.218-2.285 4.822-4.082 7.813-5.393 2.99-1.31 6.2-2 9.627-2.067 2.52 0 4.905.32 7.157.958a24.806 24.806 0 016.25 2.772l21.018 12.55z" fill="#0078D4"/><path d="M81.048 23.488c2.655.168 5.141.823 7.46 1.966a20.466 20.466 0 015.998 4.385c1.714 1.814 3.058 3.914 4.032 6.3.975 2.386 1.462 4.923 1.462 7.611 0 1.747-.202 3.427-.605 5.04a21.746 21.746 0 01-1.814 4.587l-31.603 1.865-6.855-24.9 12.5-5.241a24.802 24.802 0 013.881-1.21 19.004 19.004 0 014.183-.453h.706c.202 0 .42.016.655.05z" fill="#1490DF"/><path d="M97.58 53.378a21.149 21.149 0 01-3.175 4.335 20.896 20.896 0 01-4.133 3.377 21.503 21.503 0 01-4.99 2.218c-1.814.504-3.68.756-5.594.756H25c-2.117 0-4.167-.252-6.15-.756a24.464 24.464 0 01-5.594-2.167 25.485 25.485 0 01-4.839-3.377 27.328 27.328 0 01-3.931-4.436l54.637-22.934 20.716 12.35L97.58 53.377z" fill="#28A8EA"/></svg>',j='<svg width="93" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M88.538 16.286a2.417 2.417 0 01-1.842-.656 2.81 2.81 0 01-.615-1.977V9.408h-2.895v6.676H81.22V9.41h-1.38V7.814h1.38V6.662a2.875 2.875 0 01.848-2.136 2.98 2.98 0 012.172-.83c.21-.001.418.01.626.035.164.02.326.058.482.11v1.681a1.785 1.785 0 00-.337-.136 1.762 1.762 0 00-.554-.08 1.178 1.178 0 00-.94.384 1.697 1.697 0 00-.33 1.13v.995h2.895v-1.86l1.951-.595v2.455H90v1.593h-1.968v3.87c-.037.38.06.761.275 1.078a1.109 1.109 0 00.871.314 1.32 1.32 0 00.406-.08c.144-.05.283-.114.413-.193v1.608c-.194.094-.401.16-.614.194-.278.057-.561.087-.845.087zm-13.208 0a4.131 4.131 0 01-3.048-1.13 4.192 4.192 0 01-1.128-3.085 4.505 4.505 0 011.156-3.25 4.27 4.27 0 013.212-1.2 3.972 3.972 0 013.021 1.154 4.392 4.392 0 011.089 3.118 4.418 4.418 0 01-1.157 3.201 4.201 4.201 0 01-3.145 1.192zm.096-7.024a2.041 2.041 0 00-1.659.715 3.119 3.119 0 00-.59 2.032c-.047.708.161 1.41.586 1.978a2.1 2.1 0 001.679.683 1.963 1.963 0 001.614-.683c.409-.594.604-1.309.554-2.028a3.072 3.072 0 00-.574-2.015 2.002 2.002 0 00-1.61-.682zm-8.422 7.024a5.775 5.775 0 01-1.137-.125 4.965 4.965 0 01-1.056-.318V13.93a4.78 4.78 0 001.14.588c.355.135.73.21 1.109.22.334.022.668-.042.971-.185a.663.663 0 00.316-.623.865.865 0 00-.33-.68 4.793 4.793 0 00-1.233-.64 3.831 3.831 0 01-1.525-1.014 2.232 2.232 0 01-.45-1.432 2.272 2.272 0 01.89-1.838 3.55 3.55 0 012.3-.72c.327.005.652.037.972.097.308.05.61.134.9.25v1.85a4.177 4.177 0 00-.9-.443 3.006 3.006 0 00-1.02-.185 1.492 1.492 0 00-.863.22.692.692 0 00-.308.595.839.839 0 00.264.656c.36.255.755.456 1.173.599.623.21 1.184.57 1.633 1.05.317.401.483.901.47 1.412a2.282 2.282 0 01-.895 1.875 3.815 3.815 0 01-2.421.705zm-7.42 0a4.132 4.132 0 01-3.048-1.13 4.19 4.19 0 01-1.129-3.086 4.505 4.505 0 011.157-3.25 4.272 4.272 0 013.213-1.2 3.972 3.972 0 013.021 1.155 4.38 4.38 0 011.088 3.117 4.418 4.418 0 01-1.154 3.202 4.2 4.2 0 01-3.148 1.192zm.097-7.024a2.042 2.042 0 00-1.659.715 3.118 3.118 0 00-.59 2.032c-.047.708.16 1.41.586 1.978a2.097 2.097 0 001.678.683 1.964 1.964 0 001.614-.683c.41-.594.605-1.31.554-2.03a3.072 3.072 0 00-.574-2.015 2 2 0 00-1.61-.68zm-12.994 7.024a3.932 3.932 0 01-4.105-4.103 4.744 4.744 0 011.164-3.287 4.23 4.23 0 013.3-1.291 4.53 4.53 0 011.105.14c.308.071.606.18.887.326V9.94a4.05 4.05 0 00-.92-.51 2.67 2.67 0 00-.96-.181 2.441 2.441 0 00-1.854.748 2.834 2.834 0 00-.707 2.02c-.04.715.204 1.417.68 1.952a2.456 2.456 0 001.843.7c.329-.009.653-.077.956-.202.344-.132.668-.31.964-.53v1.81c-.33.184-.687.32-1.056.402-.426.095-.86.141-1.297.138zm-19.892-.2h-1.847V4.548h2.866l3.31 8.551h.047l3.493-8.552h2.747v11.536h-2V7.042h-.032l-3.573 9.042H30.48L26.82 7.042h-.024v9.043zm25.65 0H50.5v-8.27h1.944v1.301h.032a2.29 2.29 0 01.803-1.058c.38-.26.833-.395 1.293-.384.14-.002.28.01.418.032.107.017.212.044.314.08v1.97a1.73 1.73 0 00-.446-.212 2.21 2.21 0 00-.71-.1 1.514 1.514 0 00-1.21.604c-.37.545-.544 1.2-.494 1.858v4.178zm-11.219 0h-1.94v-8.27h1.943v8.268l-.003.001zm-.963-9.543a1.173 1.173 0 01-1.094-.686 1.06 1.06 0 01-.087-.432 1.066 1.066 0 01.35-.81c.223-.212.522-.329.83-.325a1.165 1.165 0 011.104.7c.058.137.087.285.086.435a1.05 1.05 0 01-.346.796c-.228.214-.53.33-.843.322z" fill="#7B7B7A"/><path d="M0 9.618h9.339V.28H0v9.34z" fill="#E95A0C"/><path d="M10.07 9.618h9.339V.28h-9.34v9.34z" fill="#94C01F"/><path d="M0 19.708h9.339V10.37H0v9.34z" fill="#009EE2"/><path d="M10.07 19.708h9.339V10.37h-9.34v9.34z" fill="#FCC200"/></svg>';class V extends _{constructor(e,t){super(e,t),this.startOffline=!0}getModuleLink(){if(!this._moduleLink){const e=Object(p.e)(this.navigationResult.html,'">\r\n\twindow["_spModuleLink"]=',";\r\n<\/script>");this._moduleLink=JSON.parse(e)}return this._moduleLink}createPage(){const e=this.getModuleLink();return Object.assign({moduleLink:e},super.createPage())}createState(){const e=bt&&"ListsHomeFileBrowserWebPack"===this.getModuleLink().manifestName,t=this.state.isPwaInstalled||e;return Object.assign(Object.assign({},super.createState()),{isPwaInstalled:t,isPwaPrecached:this.state.isPwaPrecached})}parseHtml(e){V._body.lastIndex=0;const t=V._body.exec(e);if(t){const n=t[0],a=n.endsWith("/>");return{html:e,fragment1:e.substring(0,t.index+n.length-(a?2:1))+">",fragment2:this.trimEndHtml(e.substring(t.index+n.length))}}return super.parseHtml(e)}renderSplash(e){switch(this.page.moduleLink.manifestName){case"ODBLightSpeedWebPack":case"SPListsHomeWebPack":const t="ODBLightSpeedWebPack"===this.page.moduleLink.manifestName;e.write(`<div id="splash"><div style="z-index:99;position:absolute;width:100px;left:calc(50% - 50px);height:${t?"65":"100"}px;top:50%;filter: drop-shadow(1px 1px 10px rgba(0, 0, 0, 0.4));">${t?B:N}</div><div style="z-index:99;position:absolute;width:92px;left:calc(50% - 46px);height:20px;bottom:24px;">${j}</div></div>`);break;default:super.renderSplash(e)}}renderHtml(e){this.navigationResult.fragment1&&this.navigationResult.fragment2?(e.write(this.navigationResult.fragment1),this.renderSplash(e),e.write(this.navigationResult.fragment2)):super.renderHtml(e)}renderPostRender(e){return e.inlineScript(`window.__pageFromServiceWorker=true;window.__serviceWorkerBaseUrl='${self._cdnBaseUrl}'`,!0),super.renderPostRender(e)}finalize(e){const t=this.state.isPwaInstalled&&!this.state.isPwaPrecached;return Promise.all([super.finalize(e),t&&Promise.resolve(this.controller.precache(e=>e.includes("listshomefilebrowser"))).then(()=>this.context.config.saveState({isPwaPrecached:!0}))]).then()}}V._body=/<body\s*.*?>/g;const z="STS",G=`${U.n}availablelists`;class K extends x.t{constructor(){super(...arguments),this.applicationId=z}knownPaths(){const e=new URL("https://lists.microsoft.com/").toString()===new URL(U.e).toString();return[{path:"/_layouts/15/createlist.aspx"},{path:"/_layouts/15/lists.aspx"},{path:"/_layouts/15/onedrive.aspx"},{path:G},{path:"/_layouts/15/(createlist|listallitems|lists|onedrive|filepicker|filebrowser|modernframe|listsview).aspx$",regex:!0},...e?[{path:"/"}]:[]]}navigate(e,t,n,a){return Object(F.e)(e.request.url).includes(G)?this._availableLists():super.navigate(e,t,n,a)}createContext(){return new R}createNavigationHandler(e){return new V(this,e)}precacheWithContext(e,t){if(t||(t=t=>e.config.state.isPwaInstalled||!t.includes("listshomefilebrowser")),self._resourcesToPrefetch&&self._prefetchBaseUrls){const n=[],a=Object.keys(self._resourcesToPrefetch),i=a.length;for(let r=0;r<i;r++){const i=a[r],o=self._prefetchBaseUrls[i];if(o){const a=Array.from(self._resourcesToPrefetch[i]).map(e=>`${o}brotli/${e}`).filter(e=>t(e));n.push(Object(v.i)(a,e.config.state.cache))}}return Promise.all(n).then()}}_getListPages(){const e=new H.e;let t;return e.open().then(e.getPages.bind(e)).then(e=>{t=e.filter(e=>e.applicationId===z)}).then(()=>(e.close(),t))}_availableLists(){return Object(T.t)(this,void 0,void 0,function*(){const e=new L.e;e.startHtml("en"),e.startBody();const t=yield this._getListPages(),n=[],a=new TextEncoder;return yield Promise.all(t.map(e=>crypto.subtle.digest("SHA-256",a.encode(e.path)).then(e=>{const t=Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("");n.push(t)}))),e.inlineScript("window.parent.postMessage('"+JSON.stringify(n)+'\', "*");',!0),e.endHtml(),e.close(),Promise.resolve(new Response(e.readableStream,{headers:{"Content-Type":"text/html"}}))})}}var W=n(12),q=n(16),Q=n(21),Y=n(45);function J(e,t,n=!1){const a=n?e.toLowerCase():e,i=n?t.toLowerCase():t;return-1!==a.indexOf(i,a.length-i.length)}function X(e){const{url:t,handleQueryString:n,keepCasing:a}=e;let i;if(n)i=n(t);else{const e=new URL(!Object(s.t)(s.e.useCaseSensitiveResourceFetching)&&a?t:t.toLowerCase());i=new URL(e.pathname,e).toString()}return i}const Z=new RegExp("<script([^\\n]*\\n+)+?[^\\n]*?<\/script>","mg");var $,ee,te;function ne(e,t,n){var a,i,r;const o=new URL(e);let c=new URL(o.pathname,o.href);const d=c.href,l=J(d,"/_layouts/15/onedrive.aspx",!0),u=J(d,"/_layouts/15/filepicker.aspx",!0),f=J(d,"/_layouts/15/listallitems.aspx",!0),p=J(d,"/_layouts/15/filebrowser.aspx",!0),{search:m}=o,_=Object(Y.e)(m.startsWith("?")?m.substr(1):m),h=function(e,t=!1){let n=e[te.queryTypeParamKey];return!n&&t&&(n=e[te.parentQueryTypeParamKey]),n?Number(n):ee.Files}(_);let b={};if(u&&"POST"===t&&(c=new URL("/_layouts/15/filepicker.aspx",c.origin)),!Object(s.t)(s.e.hostedAppGlobalCache)&&p&&"none"===o.searchParams.get("auth"))return"/_layouts/15/filebrowser.aspx";if(f||p||u){const e={};o.searchParams.forEach((t,n)=>{const a=n.toLowerCase();e[a]=t});const{app:c,listurl:d,lc:l,locale:f,csplookuphint:m}=e;if(b=p||u?Object.assign(Object.assign({},c?{app:c}:{}),f?{locale:f}:{}):Object.assign(Object.assign(Object.assign(Object.assign({},c?{app:c}:{}),d?{listurl:d}:{}),l?{lc:l}:{}),f?{locale:f}:{}),!Object(s.t)(s.e.scopedFilebrowserCache)&&p&&e.filebrowser)try{const t=JSON.parse(e.filebrowser);(null===(r=null===(i=null===(a=null==t?void 0:t.entry)||void 0===a?void 0:a.sharePoint)||void 0===i?void 0:i.byPath)||void 0===r?void 0:r.list)&&(b=Object.assign(Object.assign({},b),{listurl:t.entry.sharePoint.byPath.list}))}catch(e){}if(n&&p&&("POST"===t||!Object(s.t)(s.e.reloadListsIframe)&&"ListsHome"===c)){const e=Object(s.t)(s.e.reloadListsIframe)?n.get("origin"):m||n.get("origin");b=Object.assign(Object.assign({},b),e?{origin:e}:{})}}else{void 0===h||h===ee.Files||l||(b[te.queryTypeParamKey]=_[te.queryTypeParamKey]),!l&&_[te.isPowerAppView]&&(b[te.isPowerAppView]=_[te.isPowerAppView]);const e=_[te.idParamKey],t=_[te.parentIdParamKey];e&&t&&(b[te.idParamKey]=e,b[te.parentIdParamKey]=t);const n=_[te.envParamKey];n&&(b[te.envParamKey]=n);const a=_[te.pageParamKey];if(a)switch(Number(a)){case $.FilePicker:case $.TextFileEditor:case $.Share:case $.Embed:case $.Restore:case $.Settings:b[te.pageParamKey]=a}}const g=c;for(const e of Object.keys(b))g.searchParams.set(e,b[e]);return g.toString().toLowerCase()}!function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}($||($={})),function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.Discover=16]="Discover",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane"}(ee||(ee={})),function(e){e.idParamKey="id",e.parentIdParamKey="parent",e.queryTypeParamKey="view",e.pageParamKey="p",e.parentQueryTypeParamKey="parentview",e.windowNameJsonKey="ODBParams",e.queryParamKey="q",e.conversationIdParamKey="cvid",e.uniqueParamKey="u",e.dateFilterKey="dateFilter",e.typeFiltersKey="typeFilters",e.userFiltersKey="userFilters",e.viewIdKey="viewid",e.viewPathKey="viewpath",e.isPowerAppView="isPowerAppView",e.listIdKey="listid",e.listUrlKey="listurl",e.sortFieldKey="sortField",e.isAscendingKey="isAscending",e.policyTipKey="policyTipForListItemId",e.sharingKey="sharingDialogForListItemId",e.managePermissionsKey="managePermissionsForListItemId",e.pseudoPolicyTipKey="showpolicytips",e.groupByKey="groupBy",e.envParamKey="env",e.useFiltersInViewXmlKey="useFiltersInViewXml",e.needsAttentionViewKey="needsAttentionView",e.requiredColumnsKey="required",e.pickerLinkTypeKey="link_type",e.pickerAADClientIdKey="aad_client_id",e.pickerMSAClientIdKey="msa_client_id",e.pickerSelectionModeKey="selection_mode",e.pickerViewTypeKey="view_type",e.pickerAccessLevelKey="access",e.pickerReturnUrlKey="ru",e.remoteItem="remoteItem",e.stateParamKey="state",e.listItemIdKey="ID",e.rootFolderParamKey="RootFolder",e.sourceKey="Source",e.isDialogKey="IsDlg",e.contentTypeId="ContentTypeId",e.newTargetListUrlKey="newTargetListUrl",e.shareLinkId="slrid",e.settingKey="setting",e.userExpirationPanelKey="userExpiration",e.sharedLibraryCreated="sharedLibraryCreated",e.expandPageRowLimitKey="rowLimit"}(te||(te={}));var ae=n(36),ie=n(35),re=n(39);class oe{constructor(){this._offline=!1,this._setupCache(),Object(s.t)(s.e.additionalKeysRouteConfig)||(this._context=(new re.e).initialize())}cleanupCache(){return this._cache.clean()}_getResponseFromCache(e){const{key:t,qosName:n,fetchEvent:a}=e,i=n&&this._getLogQos(`SPServiceWorker.ListController.${n}.getResponseFromCache`,a);return this._cache.read(t).then(e=>{if(void 0!==e){if(this._checkIsExpired(e,t)&&navigator.onLine)return void(i&&i({resultType:Q.e.Failure,resultCode:"cache expired",extraData:{url:t}}));const n=this._generateResponse(e);return i&&i({resultType:Q.e.Success,extraData:{url:t}}),n}i&&i({resultType:Q.e.Failure,resultCode:"cache miss",extraData:{url:t}})}).catch(e=>{i&&i({resultType:Q.e.Failure,error:e&&e.toString(),resultCode:"cache error",extraData:{url:t}})})}_doNetworkFetch(e){const{request:t}=e;return Promise.resolve(e.preloadResponse).then(e=>e||fetch(t)).catch(()=>fetch(t))}_cacheResponse(e){const{clonedResponse:t,key:n,qosName:a,fetchEvent:i,isNavigate:r}=e,o=a&&this._getLogQos(`SPServiceWorker.ListController.${a}.cacheResponse`,i);if(t&&200===t.status&&["basic","cors"].indexOf(t.type)>=0){const e=t;return this._processResponse(e,n).then(e=>e?this._saveInCache({key:n,content:e.cacheValue}).then(()=>{if(e.additionalKeys&&e.additionalKeys.length){const t=e.additionalKeys.filter(e=>e!==n);Promise.all(t.map(t=>{const n=ne(t,i.request.method,i.request.headers);return Object(s.t)(s.e.additionalKeysRouteConfig)||this._saveRoute(t),this._saveInCache({key:n,content:e.cacheValue})})).then(()=>{o&&o({resultType:Q.e.Success,extraData:{isAdditionalKey:!0}})}).catch(e=>{o({resultType:Q.e.ExpectedFailure,error:JSON.stringify(e),resultCode:"cache error on additional key"})})}else o&&o({resultType:Q.e.Success})}).then(()=>{r&&this._serviceSucceeded()}).catch(e=>{o&&o({resultType:Q.e.Failure,error:JSON.stringify(e),resultCode:"cache error"})}):(o&&o({resultType:Q.e.Success}),"true"===new URL(i.request.url).searchParams.get(Object(s.t)(s.e.reloadListsIframe)?"noCache":"noCacheClear")?Promise.resolve():this._cache.remove(n)))}return r&&t&&404!==t.status&&!Object(ae.e)(t)&&this._serviceError(),o&&o({resultType:Q.e.Failure,resultCode:`code:${t.status},type:${t.type}`}),Promise.resolve()}_getLogQos(e,t){return n=>{if(e){const a=self._telemetry.startQos({start:e,event:t}).then(e=>e(n));return t&&t.waitUntil(a),a}return Promise.resolve()}}_serviceError(){const e=this._offline;this._offline=!0,e!==this._offline&&this._sendOfflineUpdateEvent()}_serviceSucceeded(){const e=this._offline;this._offline=!1,e!==this._offline&&this._sendOfflineUpdateEvent()}_sendOfflineUpdateEvent(){const e={name:q.e.OfflineNotification,data:{offline:this._offline}};Object(ie.e)(e)}_saveInCache(e){const{key:t,content:n}=e;return this._cache.update(t,n)}_saveRoute(e){return Object(s.t)(s.e.additionalKeysRouteConfig)?Promise.resolve():this._context.then(t=>t.config.saveRoute(e,z).catch(e=>{console.error(e)}))}}function se(e){const{response:t,fetchEvent:n}=e,a=t.clone();return 200===t.status&&"basic"===t.type?a.text().then(e=>{if(e){const t=function(e){const t=/var\s?g_payload\s?=\s?(.*?);\s?var\s?g_listData\s?=\s?(([^\n]*\n+)+?[^\n]*?);if\s?\(typeof\s?DeferredListDataComplete/m,n=e.match(Z);if(n)for(const e of n){const n=e.match(t);if(n){const e=n[1],t=n[2];return{listData:JSON.parse(t),payload:JSON.parse(e)}}}}(e);if(t)return performance.mark("EUPL.flushedListDataReceivedInServiceWorker"),self._postMessageController.postDataToClient({clientId:n.resultingClientId||n.clientId,getData:()=>Promise.resolve({isSWPrefetchListData:!0,prefetchedListData:t})})}}):Promise.resolve()}var ce=n(17);class de{constructor(){this._openCache()}read(e){return this._openCache().then(t=>t.match(e))}update(e,t){return this._openCache().then(n=>n.put(e,t))}remove(e){return this._openCache().then(t=>t.delete(e)).then(()=>{})}clean(){const e=Object(a.t)("SPServiceWorker.ListController.caches.cleanup");return this._cleanInternal().then(t=>t.needsClean&&!t.cleaned?e({resultType:Q.e.Failure,extraData:Object.assign({},t)}):e({resultType:Q.e.Success,extraData:Object.assign({},t)})).catch(t=>e({resultType:Q.e.Failure,error:JSON.stringify(t)}))}_openCache(){return this._cache?Promise.resolve(this._cache):self.caches.open("STSRESOURCECACHE").then(e=>(this._cache=e,e))}_cleanInternal(){const e={needsClean:!1,cleaned:!1,size:0,count:0};return this._openCache().then(e=>e.matchAll()).then(t=>(e.count=t.length,e.size=t.reduce((e,t)=>e+Number(t.headers.get("content-length")),0),e.needsClean=e.count>5e3||e.size>805306368,!!e.needsClean&&this._clearPreviousBuildScripts())).then(t=>(e.cleaned=t,e))}_clearPreviousBuildScripts(){return this._openCache().then(e=>e.keys().then(t=>Object(ce.e)(t.map(t=>{for(const e in self._resourcesToPrefetch)if(self._resourcesToPrefetch.hasOwnProperty(e)){const n=self._prefetchBaseUrls[e];if(t.url.includes(n))return}return e.delete(t)})).then(()=>!0)))}}class le extends oe{constructor(){super()}_setupCache(){this._cache=new de}_processResponse(e,t){return Object(T.t)(this,void 0,void 0,function*(){if("font/woff"===e.headers.get("content-type")||"application/font-woff"===e.headers.get("content-type"))return{cacheValue:e};const t=yield e.text(),n=Object(a.n)(e.headers);return n["content-encoding"]&&delete n["content-encoding"],n.date||(n.date=(new Date).toUTCString()),n["content-length"]=t.length.toString(),{cacheValue:new Response(t,{headers:n,status:200,statusText:"OK"})}})}_generateResponse(e){return e}}const ue=self.location.search.includes("&defaultBrotli=true");class fe extends le{constructor(){super()}prefetch(e){return Object(T.t)(this,void 0,void 0,function*(){const t=Object(a.t)("SPServiceWorker.ListController.resources.prefetch");if(this._setListPrefetchCompleted(!1),Object(s.t)(s.e.breakOutStreamPrefetch))return this._getResourcesToPrefetch(e).then(e=>{const n=e.map(e=>fetch(e).then(t=>({response:t.clone(),key:Object(s.t)(s.e.useCaseSensitiveResourceFetching)?e:e.toLowerCase()})));return Promise.all(n).then(e=>e.reduce((t,n,a)=>t.then(()=>{const t=[],{response:i,key:r,saved:o}=n;if(o)return Promise.resolve();if(n.saved=!0,t.push(this._cacheResponse({key:r,isNavigate:!1,clonedResponse:i})),a<e.length-1){const n=e[a+1];n.saved=!0;const{response:i,key:r}=n;t.push(this._cacheResponse({key:r,isNavigate:!1,clonedResponse:i}))}return Promise.all(t).then(()=>{})}),Promise.resolve())).then(()=>(this._setListPrefetchCompleted(!0),t({resultType:Q.e.Success})))}).catch(e=>t({resultType:Q.e.Failure,error:Object(s.t)(s.e.resourceExceptionToString)?JSON.stringify(e):e.toString(),resultCode:"resources prefetch error"}));this._prefetchAndCache(this._getListResourcesToPrefetch(e)).then(()=>this._setListPrefetchCompleted(!0)).then(()=>this._prefetchAndCache(this._getStreamResourcesToPrefetch())).then(()=>t({resultType:Q.e.Success})).catch(e=>t({resultType:Q.e.Failure,error:Object(s.t)(s.e.resourceExceptionToString)?JSON.stringify(e):e.toString(),resultCode:"resources prefetch error"}))})}prefetchIfNotCompleted(){return new W.t({cacheAppName:"sts-user-settings"}).read("isPrefetchComplete").then(e=>e&&e.data?Promise.resolve():this.prefetch())}handleFetchRequest(e){return Promise.resolve({})}shouldHandleFetchRequest(e){return!1}_setupCache(){this._cache=new de}_checkIsExpired(e,t){return!1}_setListPrefetchCompleted(e){new W.t({cacheAppName:"sts-user-settings"}).update("isPrefetchComplete",e).then().catch()}_getResourcesToPrefetch(e){return Object(T.t)(this,void 0,void 0,function*(){const t=[],n=yield this._readIsListsPWAInstalled();if(self._resourcesToPrefetch&&self._prefetchBaseUrls)for(const a in self._resourcesToPrefetch)if(self._resourcesToPrefetch.hasOwnProperty(a)){const i=self._prefetchBaseUrls[a];i&&self._resourcesToPrefetch[a].forEach(a=>{if(a.includes("listshomefilebrowser")&&!n)return;if(e&&!e(a))return;const r=X(ue?{url:new URL(a,i).toString(),keepCasing:!Object(s.t)(s.e.useCaseSensitiveResourceFetching)}:{url:new URL(a,new URL("brotli/",i)).toString(),keepCasing:!Object(s.t)(s.e.useCaseSensitiveResourceFetching)});t.push(r)})}const a=`${self._cdnBaseUrl}${ue?"":"brotli/"}@ms/stream-bundle/chunks/`,i=[`${a}onePlayer.js`,`${a}streamWebApp.js`,`${a}onePlayer~streamWebApp.js`,`${a}onePlayer~streamWebApp~webRecorderLoader.js`,`${a}vendors~onePlayer~streamWebApp.js`,`${a}vendors~onePlayer~streamWebApp~webRecorderLoader.js`,`${a}vendors~onePlayer~streamWebApp~web_recorder_v2.js`,`${a}defThinRes.js`,`${a}uiManager.js`,`${a}navigationPanel.js`];if(!Object(s.t)(s.e.keepFlightCheckInPrefetch)){const e=u.e.current;e&&e.isFlightEnabled&&(e.isFlightEnabled(O.e.OnePlayerFastNextGenEngineEnabled)||e.getExperimentVariant(O.e.OnePlayerFastNextGenEngineSPExperimentEnabled)>0)?(i.push(`${a}shakaengine.js`),i.push(`${a}vendors~shakaengine.js`),i.push(`${a}nextGenEngine.js`)):(i.push(`${a}aRes11.js`),i.push(`${a}vendors~azuremediaplayer.js`),i.push(`${a}pskin.js`)),e&&e.isFlightEnabled&&e.isFlightEnabled(O.e.PrefetchOnePlayerFluentMTC)&&(i.push(`${a}fluentMtc.js`),i.push(`${a}vendors~fluentMtc.js`),i.push(`${a}vendors~flipcameraltst~fluentMtc.js`)),e&&e.isFlightEnabled&&e.isFlightEnabled(O.e.PrefetchOnePlayerMediaSettingsEditEmptyState)&&i.push(`${a}mediaSettingsEditEmptyState.js`)}return t.push(...i),Promise.resolve(t)})}_getListResourcesToPrefetch(e){return Object(T.t)(this,void 0,void 0,function*(){const t=[],n=yield this._readIsListsPWAInstalled();if(self._resourcesToPrefetch&&self._prefetchBaseUrls)for(const a in self._resourcesToPrefetch)if(self._resourcesToPrefetch.hasOwnProperty(a)){const i=self._prefetchBaseUrls[a];i&&self._resourcesToPrefetch[a].forEach(a=>{if(a.includes("listshomefilebrowser")&&!n)return;if(e&&!e(a))return;const r=X(ue?{url:new URL(a,i).toString(),keepCasing:!Object(s.t)(s.e.useCaseSensitiveResourceFetching)}:{url:new URL(a,new URL("brotli/",i)).toString(),keepCasing:!Object(s.t)(s.e.useCaseSensitiveResourceFetching)});t.push(r)})}return t})}_getStreamResourcesToPrefetch(){return Object(T.t)(this,void 0,void 0,function*(){const e=`${self._cdnBaseUrl}${ue?"":"brotli/"}@ms/stream-bundle/chunks/`,t=[`${e}onePlayer.js`,`${e}streamWebApp.js`,`${e}onePlayer~streamWebApp.js`,`${e}onePlayer~streamWebApp~webRecorderLoader.js`,`${e}vendors~onePlayer~streamWebApp.js`,`${e}vendors~onePlayer~streamWebApp~webRecorderLoader.js`,`${e}vendors~onePlayer~streamWebApp~web_recorder_v2.js`,`${e}defThinRes.js`,`${e}uiManager.js`,`${e}navigationPanel.js`];if(!Object(s.t)(s.e.keepFlightCheckInPrefetch)){const n=u.e.current;n&&n.isFlightEnabled&&(n.isFlightEnabled(O.e.OnePlayerFastNextGenEngineEnabled)||n.getExperimentVariant(O.e.OnePlayerFastNextGenEngineSPExperimentEnabled)>0)?(t.push(`${e}shakaengine.js`),t.push(`${e}vendors~shakaengine.js`),t.push(`${e}nextGenEngine.js`)):(t.push(`${e}aRes11.js`),t.push(`${e}vendors~azuremediaplayer.js`),t.push(`${e}pskin.js`)),n&&n.isFlightEnabled&&n.isFlightEnabled(O.e.PrefetchOnePlayerFluentMTC)&&(t.push(`${e}fluentMtc.js`),t.push(`${e}vendors~fluentMtc.js`),t.push(`${e}vendors~flipcameraltst~fluentMtc.js`)),n&&n.isFlightEnabled&&n.isFlightEnabled(O.e.PrefetchOnePlayerMediaSettingsEditEmptyState)&&t.push(`${e}mediaSettingsEditEmptyState.js`)}return t})}_prefetchAndCache(e){return Object(T.t)(this,void 0,void 0,function*(){const t=yield e,n=yield Promise.all(this._fetchResources(t));return this._cacheResources(n)})}_fetchResources(e){return e.map(e=>fetch(e).then(t=>({response:t.clone(),key:Object(s.t)(s.e.useCaseSensitiveResourceFetching)?e:e.toLowerCase()})))}_cacheResources(e){return e.reduce((t,n,a)=>t.then(()=>{const t=[],{response:i,key:r,saved:o}=n;if(o)return Promise.resolve();if(n.saved=!0,t.push(this._cacheResponse({key:r,isNavigate:!1,clonedResponse:i})),a<e.length-1){const n=e[a+1];n.saved=!0;const{response:i,key:r}=n;t.push(this._cacheResponse({key:r,isNavigate:!1,clonedResponse:i}))}return Promise.all(t).then(()=>{})}),Promise.resolve())}_readIsListsPWAInstalled(){return new W.t({cacheAppName:"sts-user-settings"}).read("listsPWAInstalled").then(e=>!!e&&e.data)}}const pe="https://lists.microsoft.com/",me=["ODBLightSpeedWebPack","SPListWebPack"];function _e(e){const t=`window\\[\\"_spModuleLink\\"\\].*\\"manifestName\\":\\"(${e.join("|")})\\".*\\"scenarioName\\":\\"(\\w+)\\"`;return new RegExp(t)}const he=_e(["SPList","SPListForItemsScope","SPListWebPack","SpartanList","ListsEnterprise","CreateListWebPack","ListAllItemsWebPack","SPListsHomeWebPack","ODBOneDrive","ODBLightSpeed","ODBLightSpeedWebPack","WebTemplatesGalleryWebPack","SPAppBarWebPack","SPOFilePickerWebPack","ListsHomeFileBrowserWebPack","FreemiumListsHomeWebPack","SPTeamSiteFileBrowserWebPack","TeamsSPFileBrowserWebPack","ModernFrame"]),be="sts-page-response-cache";class ge extends oe{constructor(){super(),self._postMessageController.registerPostMessageReceiver(0,e=>function(e,t){const{url:n,pageContext:a,type:i}=e;if(0===i){const e=ne(n);return e&&a?t.read(e).then(e=>function(e,t){const n=JSON.parse(t),a=n.content.replace(/(var\s?_spPageContextInfo\s?=\s?)([^;]*?)(;\s?_spPageContextInfo.)/m,(t,n,a,i)=>{const r=JSON.parse(a),o=Object.assign(Object.assign({},r),e);return`${n}${JSON.stringify(o)}${i}`});return n.content=a,JSON.stringify(n)}(a,e.data)).then(n=>t.update(e,n)).then(()=>!0).catch(e=>!1):Promise.resolve(!0)}return Promise.resolve(void 0)}(e,this._cache)),self._postMessageController.registerPostMessageReceiver(2,e=>function(e,t){const{url:n,type:i}=e;if(2===i){const e=ne(n);if(e){const n=Object(a.t)("SPServiceWorker.ListController.invalidateCacheByFBAAuthError");return t.read(e).then(n=>{if(n)return t.remove(e)}).then(()=>(n({resultType:Q.e.Success}),!0)).catch(e=>(n({resultType:Q.e.Failure}),!1))}return Promise.resolve(!0)}return Promise.resolve(!1)}(e,this._cache)),Object(q.n)().addEventListener("message",e=>{const t=e.data;t&&t.name===q.e.CheckOffline&&t.data.lastKnownOffline!==this._offline&&this._sendOfflineUpdateEvent()})}static extractNonce(e){const t=e.match(/nonce=['"]([a-zA-Z0-9\-]+)['"]/);if(t[1])return t[1]}handleFetchRequest(e,t){const n=ne(e.request.url,e.request.method,e.request.headers),a="unsafe-url"===e.request.referrerPolicy,i=!a&&this._getLogQos("SPServiceWorker.ListController.page.handleFetchRequest",e);return this._getResponseFromCache({key:n,qosName:!a&&"page",fetchEvent:e}).then(r=>{if(r){const{response:o,manifest:s}=r;return console.log(`pageResponse served from serviceworker cache, key: ${n}, time: ${Date.now()}`),e.waitUntil(this._doNetworkAndCacheRefresh({event:e,preloadResponse:t,key:n,qosName:!a&&"page",onResponseReceived:t=>this._onNavigationPreloadResponse({fetchEvent:e,key:n,response:t,manifest:s})})),i&&i({resultType:Q.e.Success,extraData:{source:"cache"}}),o}return this._doNetworkAndCacheRefresh({event:e,preloadResponse:t,key:n,qosName:"page"}).then(e=>(i&&i({resultType:Q.e.Success,extraData:{source:"network"}}),e))}).catch(e=>{throw i&&i({resultType:Q.e.Failure,error:JSON.stringify(e)}),e})}shouldHandleFetchRequest(e){const t=X({url:e.url});return!self._shouldBypass&&(J(t,".aspx",!0)?!(t.indexOf("/_layouts/")>=0)||J(t,"createlist.aspx",!0)||J(t,"listallitems.aspx",!0)||J(t,"lists.aspx",!0)||J(t,"onedrive.aspx",!0)||J(t,"spappbar.aspx",!0)||J(t,"webtemplatesgallery.aspx",!0)||J(t,"filepicker.aspx",!0)||J(t,"filebrowser.aspx",!0)||J(t,"modernframe.aspx",!0)||J(t,"listsview.aspx",!0):!!t.includes("/lists/")||t===pe)}_setupCache(){this._cache=new W.t({cacheAppName:be})}_processResponse(e,t){return ve(e,t)}_checkIsExpired(e,t){const{cacheStats:{lastModified:n}}=e;return!isNaN(n)&&Date.now()-n>W.e}_generateResponse(e){const{data:t}=e,n=JSON.parse(t),{content:a,manifest:i,headers:r}=n;return{response:new Response(this._addOfflineInformation(a),{headers:r}),manifest:i}}_addOfflineInformation(e){const t=new L.e(ge.extractNonce(e));return t.write(e),Object(s.t)(s.e.addPrefetchedToSWStats)?t.inlineScript(`window.__swstats={offline:${this._offline}};`,!0):(t.inlineScript(`window.__swstats={offline:${this._offline},prefetched:${this._lastKnownPrefetched}};`,!0),this._refreshPrefetched()),t.flush(),t.close(),t.readableStream}_onNavigationPreloadResponse(e){const{key:t,response:n,fetchEvent:a,manifest:i}=e;let r=Promise.resolve();return Object(s.t)(s.e.waitListDataPrefetch)?r=se({response:n,fetchEvent:a}):a.waitUntil(se({response:n,fetchEvent:a})),X({url:a.request.url})===pe&&200===n.status&&"basic"===n.type?r=r.then(()=>this._handleLMCAuth({key:t,fetchEvent:a,response:n})):Object(s.t)(s.e.listEnableAuthRedirect)&&!Object(s.t)(s.e.cookieRedirectKillSwitch)&&-1!==me.indexOf(i)||"opaqueredirect"!==n.type||n.ok||(r=r.then(()=>this._handleAuthRedirect({key:t,fetchEvent:a}))),r}_handleLMCAuth(e){const{response:t}=e,n=Object(T.i)(e,["response"]);return t.clone().text().then(e=>{const t=_e(["ListsHost"]),a=e.match(t);if(a&&"ListsHostWelcome"===a[2])return this._handleAuthRedirect(n)})}_handleAuthRedirect(e){const{key:t,fetchEvent:n}=e,a=this._getLogQos("SPServiceWorker.ListController.page.handleAuthRedirect",n);return this._cache.remove(t).then(()=>(a({resultType:Q.e.Success,extraData:{url:t}}),self._postMessageController.postDataToClient({clientId:n.resultingClientId||n.clientId,getData:()=>Promise.resolve({shouldRefresh:!0})}))).catch(e=>{a({resultType:Q.e.Failure,error:JSON.stringify(e),extraData:{url:t}})})}_doNetworkAndCacheRefresh(e){const{event:t,preloadResponse:n,key:a,qosName:i,onResponseReceived:r}=e;return n.then(e=>{const n=e.clone();let o=Promise.resolve();return r&&(o=r(e)),t.waitUntil(o.then(()=>this._cacheResponse({key:a,clonedResponse:n,qosName:i,isNavigate:!0,fetchEvent:t}))),e}).catch(e=>{throw this._serviceError(),e})}_refreshPrefetched(){new W.t({cacheAppName:"sts-user-settings"}).read("isPrefetchComplete").then(e=>{this._lastKnownPrefetched=e&&e.data})}}function ve(e,t){return e.text().then(n=>{if(function(e,t){if("true"===e.headers.get("service-worker-skip-caching"))return!1;const n=new URL(e.url),a=e.headers.get("content-security-policy");if(n.pathname.toLowerCase().indexOf("/filebrowser.aspx")>-1){if("none"===n.searchParams.get("auth"))return!0;const e=new URL(t);if(null===a||-1===a.indexOf(e.searchParams.get("origin")))return!1}return!0}(e,t)){const i=function(e,t){const n=e.match(he);if(n){const a=n[1],i=n[2];let r;const o=new RegExp("<html([^\\n]*\\n+)+[^\\n]*</html>","m"),c=e.match(o);if(c){const o=c[0];if(n.index>=c.index&&n.index<=c.index+o.length){let n=function(e){const t=e.match(/<script\stype=\"text\/javascript\"(\snonce=\"([\w-]+)\")?>/);if(t){const n=`${t[0]}window.__pageFromServiceWorker=true;window.__serviceWorkerBaseUrl='${self._cdnBaseUrl}';<\/script>`;return e.replace("</html>",`${n}</html>`)}return e}(e.substring(0,c.index+o.length));"SPListsHomeWebPack"===a?n=De(n,N):"ODBLightSpeedWebPack"===a&&(n=De(n,B,65)),"ListsHomeFileBrowserWebPack"===a&&self.setTimeout(ye,5e3);const d=e.substring(c.index+o.length);let l=d||"";const u=d.match(Z);if(u)for(const e of u){const t=Se(e);l=l.replace(e,t)}return"SPListWebPack"===a&&(r=function(e,t){const n=e.match(/"DefaultView"\:(true|false)/),a=e.match(/"serverRedirectedUrl"\:"(.+?)"/);try{if(n&&"true"===n[1]&&a&&a[1])return[a[1].toLocaleLowerCase()]}catch(e){return}if(!Object(s.t)(s.e.additionalKeysRouteConfig))try{if(n&&"true"===n[1]){const e=new URL(t),n=e.pathname.slice(0,e.pathname.lastIndexOf("/"));return[e.origin+n+e.search]}}catch(e){return}}(e,t)),"SpartanListEmbedded"===i&&(n=Object(s.t)(s.e.keepIsSiteListsHost)?n.replace(/var\s?_spPageContextInfo\s?=.*_spPageContextInfo;}\);}/,""):n.replace(/(var\s?_spPageContextInfo\s?=\s?)([^;]*?)(;\s?_spPageContextInfo.)/m,(e,t,n,a)=>{try{const e=JSON.parse(n);return`${t}${JSON.stringify({isSiteListsHost:!!e.isSiteListsHost,ExpFeatures:e.ExpFeatures,killSwitches:e.killSwitches})}${a}`}catch(e){return""}})),{content:`${n}\n${l}`,manifest:a,additionalKeys:r}}}}}(n,t);if(i){const t=Object(a.n)(e.headers),n={content:i.content,manifest:i.manifest,headers:t};return{cacheValue:JSON.stringify(n),additionalKeys:i.additionalKeys}}}})}function ye(){const e=new W.t({cacheAppName:"sts-user-settings"});e.read("listsPWAInstalled").then(t=>{if(!t||!t.data)return e.update("listsPWAInstalled",!0).then(()=>(new fe).prefetch(e=>e.includes("listshomefilebrowserwebpack")))}).then().catch()}function Se(e){let t=e;return e.indexOf("var g_payload =")>=0&&e.indexOf("var g_listData =")>=0&&(t=""),t=t.replace("var g_needFetchTeamsToken = true;",""),t=Object(s.t)(s.e.updateFilePickerBrowserClaimName)?t.replace(/var\sg_fileBrowserClaim\s=\s'[^']+';/,""):t.replace(/var\sg_filePickerBrowserClaim\s=\s'[^']+';/,""),t}function De(e,t,n=100,a=100){const i=`<div id="splash">\n<style>#splash{display:none;} @media(display-mode:standalone),(display-mode: minimal-ui){#splash{display:block;}}</style>\n<div style="z-index:99;position:absolute;width:${a}px;left:calc(50% - ${a/2}px);height:${n}px;top:50%;filter: drop-shadow(1px 1px 10px rgba(0, 0, 0, 0.4));">\n${t}\n</div>\n<div style="z-index:99;position:absolute;width:92px;left:calc(50% - 46px);height:20px;bottom:24px;">\n${j}\n</div>\n</div>`;return e.replace("</html>",`${i}</html>`)}const Ie="/_api/SP.Directory.DirectorySession/me?$select=mySite";class xe extends le{constructor(){super()}handleFetchRequest(e){const t=e.request.url,n=X({url:t});let a=n;return this._isMysiteRequest(e.request)&&(a=new URL(Ie,n).toString()),this._isFaviconRequest(n)&&(a=n+new URL(t).search),this._getResponseFromCache({key:a,fetchEvent:e}).then(t=>t?this._isShellRequest(n)?(this._doNetworkAndCacheUpdateInBackground({event:e,key:a}),t):t:this._doNetworkAndCacheUpdate({event:e,key:a})).catch(t=>this._doNetworkAndCacheUpdate({event:e,key:a}))}shouldHandleFetchRequest(e){const t=X({url:e.url});return this._cdnCachable(t)||this._isMysiteRequest(e)||this._isFaviconRequest(t)}_setupCache(){this._cache=new de}_checkIsExpired(e,t){return!!navigator.onLine&&!!(this._isShellRequest(X({url:t}))&&+new Date(e.headers.get("date"))<+new Date-6048e5)}_cdnCachable(e){return(J(e,".js",!0)||J(e,".woff",!0)||J(e,".svg",!0))&&(this._checkCDNBaseUrl(e)||this._checkPrefetchBaseUrl(e))||this._isShellRequest(e)}_isMysiteRequest(e){return e.url.endsWith(Ie)}_isFaviconRequest(e){return e.endsWith("listshomefavicon.ico")}_isShellRequest(e){return 0===e.indexOf("https://shell.cdn.office.net")||0===e.indexOf(" https://webshell.suite.office.com")}_checkPrefetchBaseUrl(e){if(Object(s.t)(s.e.acceptFetchRequestForPrefetchUrl)||!self._prefetchBaseUrls)return!1;const t=new URL(e);return Object.keys(self._prefetchBaseUrls).some(e=>new URL(self._prefetchBaseUrls[e]).origin===t.origin)}_checkCDNBaseUrl(e){const t=new URL(e),n=new URL(self._cdnBaseUrl);if(!Object(s.t)(s.e.hostedAppGlobalCache)&&("dev"===self._swBuildNumber||self._swBuildNumber.startsWith("dev-")))return!1;if(t.origin===n.origin||"dev"===self._swBuildNumber||self._swBuildNumber.startsWith("dev-")){if(Object(s.t)(s.e.cookieRedirectKillSwitch)){const a=t.pathname.split("/").filter(e=>!!e),i=n.pathname.split("/").filter(e=>!!e);return e.startsWith(self._cdnBaseUrl)||a[0]===i[0]&&(a[1].startsWith("odsp-next")||a[1].startsWith("dev-"))}return!0}return!1}_doNetworkAndCacheUpdate(e){const{event:t,key:n}=e;return this._doNetworkFetch(t).then(e=>{const a=e.clone();return t.waitUntil(this._cacheResponse({key:n,clonedResponse:a,isNavigate:!1,fetchEvent:t})),e})}_doNetworkAndCacheUpdateInBackground(e){const{event:t,key:n}=e;return this._doNetworkFetch(t).then(e=>{const a=e.clone();return this._cacheResponse({key:n,clonedResponse:a,isNavigate:!1,fetchEvent:t})})}}class Ce extends oe{constructor(){super(),self._postMessageController.registerPostMessageReceiver(1,e=>function(e,t,n){const{url:a,type:i}=e;if(1===i&&self._needPagePreload){const e=ne(a);return e?t.read(e).then(e=>{if(!e)return n({pageUrl:a,qosName:"SPServiceWorker.ListController.page.preloadWhenInstallSW"})}).then(()=>(self._needPagePreload=!1,!0)).catch(e=>!1):Promise.resolve(!0)}return Promise.resolve(void 0)}(e,this._cache,this.prefetchSinglePage.bind(this)))}prefetch(){return this._getUrlsWithMostReads({count:15}).then(e=>{const t=e.map(e=>!Object(s.t)(s.e.skipPrefetchOfFilebrowser)&&e.includes("filebrowser.aspx")?Promise.resolve():this.prefetchSinglePage({pageUrl:e,qosName:"SPServiceWorker.ListController.page.prefetch"}));return Promise.all(t)}).then(()=>{})}prefetchSinglePage(e){const{pageUrl:t,qosName:n}=e,i=X({url:t});console.log("page to prefetch: ",i);const r=Object(a.t)(n),o=new URL(i);o.searchParams.set("skipSignal","true");const s=o.toString();return fetch(s).then(e=>{if(200!==e.status)return r({resultType:Q.e.Failure,resultCode:`${e.status}`,extraData:{url:i}});const t=e.clone();return this._cacheResponse({key:i,clonedResponse:t,isNavigate:!1,qosName:"page-prefetch"}).then(()=>r({resultType:Q.e.Success}))}).catch(e=>r({resultType:Q.e.Failure,resultCode:`${JSON.stringify(e)}`,extraData:{url:i}}))}handleFetchRequest(e){return Promise.resolve({})}shouldHandleFetchRequest(e){return!1}_setupCache(){this._cache=new W.t({cacheAppName:"sts-page-response-cache"})}_processResponse(e,t){return ve(e,t)}_checkIsExpired(e,t){return!1}_generateResponse(e){}_getUrlsWithMostReads(e){const{count:t}=e;return this._cache.rangeQuery({index:"app_reads",range:IDBKeyRange.bound([be,0],[be,1/0]),direction:"prev",count:t}).then(e=>e.data.map(e=>e.original.key))}}const Oe=`${U.n}availablelists`;class we{constructor(){this.applicationId=z,this._onMessage=e=>{self._postMessageController.onMessageReceived(e)},this._pageRequestHandler=new ge,this._resouceRequestHandler=new xe,this._pagePrefetchHandler=new Ce,this._resourcePrefetchHandler=new fe}knownPaths(){const e=new URL(pe).toString()===new URL(U.e).toString();return[{path:"/_layouts/15/createlist.aspx"},{path:"/_layouts/15/lists.aspx"},{path:"/_layouts/15/onedrive.aspx"},{path:Oe},{path:"/_layouts/15/(createlist|listallitems|lists|onedrive|filepicker|filebrowser|modernframe|listsview).aspx$",regex:!0},...e?[{path:"/"}]:[]]}install(){console.log(`${Math.round(performance.now())} installing STS service worker @ ${self._swBuildNumber}`);const e=Object(a.t)("SPServiceWorker.ListController.install");return self.skipWaiting().then(()=>this._prefetch()).then(()=>Promise.all([this._pageRequestHandler.cleanupCache(),this._resouceRequestHandler.cleanupCache()])).then(()=>(self._needPagePreload=!0,e({resultType:Q.e.Success}))).catch(t=>e({resultType:Q.e.Failure,error:t}))}precache(){}activate(){self.addEventListener("message",this._onMessage),console.log(`${Math.round(performance.now())} activating STS service worker @ ${self._swBuildNumber}`);const e=Object(a.t)("SPServiceWorker.ListController.activate");return self.clients.claim().then(()=>{const e=self.registration.navigationPreload;return e&&e.getState().then(e=>e.enabled?Promise.resolve():Promise.reject())}).then(()=>e({resultType:Q.e.Success})).catch(t=>e({resultType:Q.e.Failure,error:t}))}deactivate(){self.removeEventListener("message",this._onMessage)}willSync(e){}sync(e){}message(e){}navigate(e,t){const n=e.request;return X({url:n.url}).indexOf(Oe)>-1?class{static getResponse(){return Object(T.t)(this,void 0,void 0,function*(){const e=new L.e;e.startHtml("en"),e.startBody();const t=new W.t({cacheAppName:"sts-user-settings"}),n=yield t.read("isPrefetchComplete").then(e=>!!e&&e.data),a=new W.t({cacheAppName:"sts-page-response-cache"}),i=n?yield a.keys():[],r=[],o=new TextEncoder;return yield Promise.all(i.map(e=>crypto.subtle.digest("SHA-256",o.encode(e)).then(e=>{const t=Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("");r.push(t)}))),e.inlineScript("window.parent.postMessage('"+JSON.stringify(r)+'\', "*");',!0),e.endHtml(),e.close(),Promise.resolve(new Response(e.readableStream,{headers:{"Content-Type":"text/html"}}))})}}.getResponse():this._pageRequestHandler.shouldHandleFetchRequest(n)?(e.waitUntil(t.then(this._onPreloadCompleted.bind(this)).catch(()=>{})),this._pageRequestHandler.handleFetchRequest(e,t)):void 0}fetch(e){if(this._resouceRequestHandler.shouldHandleFetchRequest(e.request))return this._resouceRequestHandler.handleFetchRequest(e)}_prefetch(){const e=this._prefetchPage(),t=this._prefetchResources();return Promise.all([e,t]).then(()=>{})}_onPreloadCompleted(){return this._resourcePrefetchHandler.prefetchIfNotCompleted().catch(()=>{})}_prefetchPage(){return self.setTimeout(()=>this._pagePrefetchHandler.prefetch(),3e4),Promise.resolve()}_prefetchResources(){return this._resourcePrefetchHandler.prefetch()}}var Ee,Ae,Le=n(26),ke=n(38);!function(e){e[e.Metadata=0]="Metadata",e[e.WebPartZone=3]="WebPartZone",e[e.RTE=4]="RTE",e[e.TwoColumns=5]="TwoColumns",e[e.ThreeColumns=6]="ThreeColumns",e[e.OneThirdColumnRight=7]="OneThirdColumnRight",e[e.OneThirdColumnLeft=8]="OneThirdColumnLeft",e[e.FullWidth=9]="FullWidth",e[e.OneColumn=10]="OneColumn"}(Ee||(Ee={})),function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(Ae||(Ae={}));class Me extends k.e{constructor(e,t){super(e,t),this.componentId=A.e.SiteApplication,this.assemblyId=A.e.SiteAssembly}get title(){return this.page.title}get preloadedData(){return this.navigationResult}get isOfflineEnabled(){return this.isFlightEnabled(O.e.OfflineSiteController)||this.isFlightEnabled(O.e.WEXClassHomeOffline)&&this._isTeamsClassHome}get startOffline(){var e;return this.isOfflineEnabled&&!!(null===(e=this.page)||void 0===e?void 0:e.reads)}get appDataEnabled(){return!0}renderPhases(){var e;const t=null===(e=this.page)||void 0===e?void 0:e.lkgEnabled;return[this.shell(),this.start(),Promise.resolve(t&&this.lkgData()),Promise.resolve(t&&this.newData())]}renderSplash(e){this.canonicalPath!==Te.Preload&&super.renderSplash(e)}renderStart(e){var t;if(this.scriptSyncPending&&!this.isFlightEnabled(O.e.RemoveBypassOnDashboardWithScriptSyncPending)&&!this.isFlightEnabled(O.e.DashboardPassThrough)){const e=null===(t=this.page)||void 0===t?void 0:t.webParts;if(e&&-1!==e.indexOf(A.e.DashboardWebPart))throw new Le.e({code:"DashboardWithScriptSyncPending",isExpected:!0})}super.renderStart(e)}createPage(){const e=this.preloadedData;if(!e.page)return super.createPage();const t=Object.assign({},e.item,e.page.Content),n=t.PageLayoutType,a=new Set,i=new Set;return this._scanWebPartData(t.LayoutWebpartsContent,a,i),this._scanCanvasContent(t.CanvasContent1,a,i),this._scanForUpdates(t),Me._guid.test(n)&&i.add(n),Object.assign({version:t.Version,pageLayoutType:n,title:t.Title,lkgEnabled:this._lkgEnabled(a),webParts:Array.from(a),dynamicComponents:Array.from(i),audienceFilteredWebPartComponentIds:t.CanvasContent1?e.page.PreloadWebPartComponentIds:void 0},super.createPage())}postRender(){return Promise.resolve(this.startOffline&&this.navigationResultFromConfig&&this._requiresUpdate&&this._renderUpdateContent.bind(this))}_getNewComponentsAfterUpdate(){const e=new Set,t=this.components;let n=t.length;for(let a=0;a<n;a++)e.add(t[a].id);const a=this.getComponents(),i=[];n=a.length;for(let t=0;t<n;t++)e.has(a[t].id)||i.push(a[t]);return i.length&&i}_renderUpdateContent(e){const t=Object.assign({},this.page.navigationResult.item,this.page.navigationResult.page.Content),n=[],a=this._hasContentChanged&&this._getNewComponentsAfterUpdate();a&&n.push(`spModuleLoader._bundledComponents['${A.e.Loader}'].SPComponentLoader.registerManifests(${e.xssStringify(a)});\n`);const i=e.xssStringify(t);n.push(`spModuleLoader._bundledComponents['${A.e.SiteApplication}'].PageManager._actions.coreActions.setFieldsFromListItem(${i})`),e.inlineScript(n.join(""),!0),e.flush()}_scanForUpdates(e){var t;const n=null===(t=this.page)||void 0===t?void 0:t.navigationResult;if(n){const t=Object.assign({},n.item,n.page.Content);this._requiresUpdate=(this._hasContentChanged=e.CanvasContent1!==t.CanvasContent1||e.LayoutWebpartsContent!==t.LayoutWebpartsContent)||e.PromotedState!==t.PromotedState}}_getDependencies(e,t){const n=this.context.spfxConfig.getComponents([e.id],this.scriptLang),a=n.length;for(let e=0;e<a;e++)switch(n[e].id){case A.e.WebPartShared:case A.e.DataProviders:t.add(n[e].id)}const i=e.serverProcessedContent&&e.serverProcessedContent.componentDependencies;if(i){const e=Object.keys(i);for(let n=0;n<e.length;n++)t.add(i[e[n]])}}_getAllDependencies(e,t,n){const a=e.length||0;for(let i=0;i<a;i++){const a=e[i];if(a&&this._isNotAudienceFiltered(a.id)){t.add(a.id);const e=this.context.spfxConfig.getComponent(a.id);e&&(e.isInternal||this.extensions().has(a.id))?this._getDependencies(a,n):this.deleteManifest(a.id)}}}_defaultContent(e,t){switch(this.spPageContext.webTemplate){case ke.t.CommunicationSite:e.add(A.e.HeroWebPart).add(A.e.NewsWebPart).add(A.e.EventsWebPart).add(A.e.HighlightedContentWebPart).add(A.e.QuickLinksWebPart).add(A.e.PeopleWebPart),t.add(A.e.HeroLayout).add(A.e.FlexLayout).add(A.e.CarouselLayout);break;case ke.t.TeamSite:e.add(A.e.NewsWebPart).add(A.e.SiteActivityWebPart).add(A.e.QuickLinksWebPart).add(A.e.HighlightedContentWebPart),t.add(A.e.GridLayout)}}_scanCanvasContent(e,t,n){if(e){const a=JSON.parse(e),i=a.length||0,r=[];for(let e=0;e<i;e++){const n=a[e];n&&n.controlType===Ee.WebPartZone&&(n.webPartData?r.push(n.webPartData):n.webPartId&&this._isNotAudienceFiltered(n.webPartId)&&t.add(n.webPartId))}this._getAllDependencies(r,t,n)}else this._defaultContent(t,n)}_scanWebPartData(e,t,n){if(e){const a=JSON.parse(e);this._getAllDependencies(a,t,n)}}_lkgEnabled(e){const t=Me.lkgEnabledWebParts.entries();let n;for(;!(n=t.next()).done;)if(e.has(n.value[1]))return!0;const a=e.values();let i;for(;!(i=a.next()).done;){const e=this.context.spfxConfig.getComponent(i.value);if(e&&"AdaptiveCardExtension"===e.componentType)return!0}}_isNotAudienceFiltered(e){const t=this.preloadedData.page;return!(this.isFlightEnabled(O.e.WebPartAudienceTargeting)&&t&&t.PreloadWebPartComponentIds)||-1!==t.PreloadWebPartComponentIds.indexOf(e)}get _isTeamsClassHome(){return"true"===this.url.searchParams.get("classhome")}}Me.lkgEnabledWebParts=[A.e.ConnectorWebPart,A.e.HighlightedContentWebPart,A.e.EventsWebPart,A.e.FieldsWebPart,A.e.GroupCalendarWebPart,A.e.ImageGalleryWebPart,A.e.ContentCenterWebPart,A.e.RecentDocumentsWebPart,A.e.NewsWebPart,A.e.NewsfeedWebPart,A.e.CompanyFeedWebPart,A.e.OfficeFeedWebPart,A.e.SavedForLaterWebPart,A.e.SiteActivityWebPart,A.e.SitesWebPart,A.e.YammerHighlightsWebPart,A.e.YammerWebPart],Me._guid=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;const Pe="SitePages";var Te;!function(e){e.Preload="/_layouts/15/preload.aspx"}(Te||(Te={}));class Ue extends w{constructor(){super(...arguments),this.applicationId=Pe}knownPaths(){return[{path:Te.Preload}]}fetch(e){if(!this.isSavePage(e.request))return super.fetch(e);this.fetchSavePage(e)}createContext(){return new E}precachedComponents(){return[A.e.SiteAssembly,A.e.SiteApplication,A.e.WebPartShared,A.e.DataProviders,A.e.CompanyFeedWebPart,A.e.DocumentEmbedWebPart,A.e.EventsWebPart,A.e.HeroWebPart,A.e.HighlightedContentWebPart,A.e.ImageWebPart,A.e.ImageGalleryWebPart,A.e.NewsfeedWebPart,A.e.NewsLinkWebPart,A.e.NewsWebPart,A.e.OfficeFeedWebPart,A.e.PageTitle,A.e.PeopleWebPart,A.e.QuickLinksWebPart,A.e.RecentDocumentsWebPart,A.e.SavedForLaterWebPart,A.e.SitesWebPart,A.e.SiteActivityWebPart,A.e.YammerWebPart]}createNavigationHandler(e){return new Me(this,e)}isSavePage(e){return"POST"===e.method&&Ue._editMode.test(e.referrer)&&Ue._savePage.test(e.url)}fetchSavePage(e){e.waitUntil(this.context.then(t=>{const n=e.request.clone();return n.json().then(e=>t.config.getPage(n.referrer).then(n=>{if(n&&n.navigationResult&&n.navigationResult.page&&n.navigationResult.item)return n.navigationResult.page.Content.CanvasContent1=e.CanvasContent1,n.navigationResult.item.Title=e.Title,t.config.savePage(n)}))}))}}Ue._editMode=/[?&]Mode=Edit/,Ue._savePage=/_api\/sitepages\/pages\(\d+\)\/SavePage/;var Fe=n(29);class He extends k.e{constructor(e,t){super(e,t),this.spfxPreloads=[A.e.ComponentUtilities],this.componentId=A.e.SPHomeApplication,this.assemblyId=A.e.SPHomeAssembly,this.startOffline=!0}get preloadedData(){return this.navigationResult.spfxContext}createPage(){const e=super.createPage();return this._transformAppContext(e),e}renderPhases(){return[this.shell(),this.start()]}renderStart(e){const t=this.navigationResult,n=`window._spHomePageContext=${e.xssStringify(t.appContext._spHomePageContext)};\nwindow._spHomePageDataCache=${e.xssStringify(t.appContext._spHomePageDataCache)};\nwindow._spHomeCompanyPortalHeaderContext=${e.xssStringify(t.appContext._spHomeCompanyPortalHeaderContext)};`;e.inlineScript(n,!0),super.renderStart(e)}postRender(){return this._fetchServiceContext().catch(()=>{}).then(e=>t=>{e&&this._renderServiceContext(e,t)})}_microserviceFailed({cacheValue:e}){return!e||e.includes('"Items":[]')||e.includes('"Activities":[]')}_transformAppContext(e){const t=e.navigationResult.appContext,n=t&&t._spHomePageDataCache,a=n&&n.length||0;if(t){const e=t._spHomePageContext&&t._spHomePageContext.isGraphEnabled;if(t._spHomeCompanyPortalHeaderContext&&0===Object.keys(t._spHomeCompanyPortalHeaderContext).length&&(t._spHomeCompanyPortalHeaderContext=this.page.navigationResult.appContext._spHomeCompanyPortalHeaderContext),t._spHomePageContext&&0===Object.keys(t._spHomePageContext).length&&(t._spHomePageContext=this.page.navigationResult.appContext._spHomePageContext),e){if(this.page&&n){const e=this.page.navigationResult.appContext._spHomePageDataCache,a=Object.assign({},e);for(const{Key:e,Value:t}of n)t&&!this._microserviceFailed(t)&&(a[e]=t);return void(t._spHomePageDataCache=a)}if(!n)return void(t._spHomePageDataCache=this.page.navigationResult.appContext._spHomePageDataCache)}}const i={};for(let e=0;e<a;e++){const t=n[e];i[t.Key]=t.Value}t._spHomePageDataCache=i}_renderServiceContext(e,t){const n=`window._spHomeServiceContext=${t.xssStringify(e)};`;t.inlineScript(n,!0),t.flush()}_fetchServiceContext(){const e=new URL("/_api/sphomeservice/context?$expand=Token,Payload",this.url.origin);return Object(Fe.e)(e.href,{ACCEPT:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":"Web"}).then(e=>e.json())}}const Re="SPHome";class Ne extends w{constructor(){super(...arguments),this.applicationId=Re}knownPaths(){return[{path:"/_layouts/15/sharepoint.aspx"}]}createContext(){return new E}precachedComponents(e){return[A.e.SPHomeAssembly,A.e.SPHomeApplication,A.e.PagesPreloads]}createNavigationHandler(e){return new He(this,e)}}class Be extends _{constructor(e,t){super(e,t),this.startOffline=!1}renderMark(e,t){}}const je="Embed",Ve=self.location.search.includes("&defaultBrotli=true");class ze extends x.t{constructor(){super(...arguments),this.applicationId=je}knownPaths(){return[{path:"/_layouts/15/embed.aspx$",regex:!0},...Object(s.t)(s.e.addStreamToEmbedControllerKnownPaths)?[]:[{path:"/_layouts/15/stream.aspx$",regex:!0}]]}createContext(){return new f}createNavigationHandler(e){return new Be(this,e)}precacheWithContext(e){const t=`${self._cdnBaseUrl}${Ve?"":"brotli/"}@ms/stream-bundle/chunks/`,n=[`${t}onePlayer.js`,`${t}streamWebApp.js`,`${t}onePlayer~streamWebApp.js`,`${t}onePlayer~streamWebApp~webRecorderLoader.js`,`${t}vendors~onePlayer~streamWebApp.js`,`${t}vendors~onePlayer~streamWebApp~webRecorderLoader.js`,`${t}vendors~onePlayer~streamWebApp~web_recorder_v2.js`,`${t}defThinRes.js`,`${t}uiManager.js`,`${t}navigationPanel.js`];return e.config.isFlightEnabled(O.e.OnePlayerFastNextGenEngineEnabled)||e.config.getExperimentVariant(O.e.OnePlayerFastNextGenEngineSPExperimentEnabled)>0?(n.push(`${t}shakaengine.js`),n.push(`${t}vendors~shakaengine.js`),n.push(`${t}nextGenEngine.js`)):(n.push(`${t}aRes11.js`),n.push(`${t}vendors~azuremediaplayer.js`),n.push(`${t}pskin.js`)),e.config.isFlightEnabled(O.e.PrefetchOnePlayerFluentMTC)&&(n.push(`${t}fluentMtc.js`),n.push(`${t}vendors~fluentMtc.js`),n.push(`${t}vendors~flipcameraltst~fluentMtc.js`)),e.config.isFlightEnabled(O.e.PrefetchOnePlayerMediaSettingsEditEmptyState)&&n.push(`${t}mediaSettingsEditEmptyState.js`),Object(v.i)(n,e.config.state.cache)}}class Ge extends _{constructor(e,t){super(e,t),this.startOffline=!0}}const Ke="CreateGroup";class We extends x.t{constructor(){super(...arguments),this.applicationId=Ke}knownPaths(){return[{path:"/_layouts/15/creategroup.aspx"}]}createContext(){return new f}createNavigationHandler(e){return new Ge(this,e)}}const qe="componentId";class Qe extends k.e{constructor(e,t){super(e,t),this.componentId=A.e.IsolatedWebPartApplication,this.assemblyId=A.e.IsolatedWebPartAssembly,this.startOffline=!0}get preloadedData(){return this.navigationResult}preloads(){return[this.loaderUrl(),...this.context.spfxConfig.scriptUrls(this.webpartComponentIds,this.scriptLang)]}additionalComponents(){return super.additionalComponents().concat(this.webpartComponentIds)}get webpartComponentIds(){const e=this.url.searchParams.get(qe);return e?e.split(","):[]}renderChrome(e){}renderSplash(e){}renderPhases(){return[this.shell(),this.start()]}get navigationResultKey(){if(void 0===this._key){const e=this.url.searchParams,t=e.get("webPartInstanceId")||e.get("newWebPartInstanceId"),n=e.get("listId");this._key=n?`${n}/${e.get("id")}/${e.get(qe)}/${t}`:`${e.get(qe)}/${t}`}return this._key}}const Ye="SingleWebPart";class Je extends w{constructor(){super(...arguments),this.applicationId=Ye}knownPaths(){return[{path:"/_layouts/15/webpart.aspx"}]}precachedComponents(e){return[]}createContext(){return new E}createNavigationHandler(e){return new Qe(this,e)}}const Xe="_layouts/15/vivahome.aspx",Ze="disableredirect",$e="disableoptout";class et extends k.e{constructor(e,t){super(e,t),this.componentId=A.e.VivaHomeApplication,this.assemblyId=A.e.VivaHomeAssembly,this.startOffline=!Object(s.t)(s.e.vivaHomeStartsOffline),this.useInlineAuthentication=!Object(s.t)(s.e.vivaHomeInlineAuth),this._isRedirectionEvaluated=!1,this._isRedirectingToVivaHome=!1,this._isRedirectingToSpPages=!1,this._isRedirectingToCachedUrl=!1}get isNewScrollForVivaHomePageLayoutKSActivated(){return Object(s.t)(s.e.newScrollForVivaHomePageLayout)}get isVivaHomeTopBarHeightFixKSActivated(){return Object(s.t)(s.e.vivaHomeTopBarHeightFix)}get isFixMainContentWidthKSActivated(){return Object(s.t)(s.e.vivaHomeFixMainContentWidth)}get isVivaHomeAccessibilityFixesKSActivated(){return Object(s.t)(s.e.vivaHomeAccessibilityFixes)}get preloadedData(){return this.navigationResult}get redirectUrl(){var e,t,n;return null===(n=null===(t=null===(e=this.preloadedData)||void 0===e?void 0:e.page)||void 0===t?void 0:t.Content)||void 0===n?void 0:n.redirectUrl}get optOutFlag(){var e,t,n;return null===(n=null===(t=null===(e=this.preloadedData)||void 0===e?void 0:e.page)||void 0===t?void 0:t.Content)||void 0===n?void 0:n.isVivaHomeOptedOut}get chromeless(){return!0}get appDataEnabled(){return!0}renderPhases(){return!this.redirectUrl||!this._allowRedirect||Object(s.t)(s.e.vivaHomeNavResultKeys)&&this._hasConflictingOptOut?[this.shell(),this.start(),this.lkgData(),this.authenticate(),this.newData(),this._redirectToUpdatedDest()]:[this._redirectToCachedDest()]}renderStart(e){e.inlineScript("window.__vivaHomeHandlerRedirect = true;",!0),super.renderStart(e)}renderAppChrome(e){if(!this._removeSWRenderKSActivated)return super.renderAppChrome(e);e.write(`<div class="spAppAndPropertyPanelContainer">\n        <div class="${this.isVivaHomeTopBarHeightFixKSActivated?"SPPageChrome-app VivaHome":"SPPageChrome-app VivaHome VivaHomeFlexDisplay"}" id="spPageChromeAppDiv" data-sp-feature-tag="Page Chrome" data-sp-feature-instance-id="_Page Chrome" data-sp-a11y-navigatebyhierarchy="true">\n        ${this.isVivaHomeAccessibilityFixesKSActivated?"<div id='VivaHomeTopBar' class='VivaHomeTopBar StickyTopBar'></div>":"<nav id='VivaHomeTopBar' class='VivaHomeTopBar StickyTopBar'></nav>"}\n            <div id="VivaHomePageContain" class="${this.isNewScrollForVivaHomePageLayoutKSActivated?"VivaHomePageContainOldScroll":"VivaHomePageContain"}">\n              <div id="VivaHomeHero" class="VivaHomeHero">\n                <div id="VivaHomeHeroContent" class="VivaHomeHeroContent"></div>\n              </div>\n              ${this.isVivaHomeAccessibilityFixesKSActivated?'<div id="VivaHomeContent" class="VivaHomeContent">':'<main id="VivaHomeContent" class="VivaHomeContent">'}\n              ${this.isNewScrollForVivaHomePageLayoutKSActivated?'<div id="VivaHomeMainContent" class="VivaHomeMainContentOldScroll VivaHomeScroll"></div>\n                <div id="VivaHomeRightRail" class="VivaHomeRightRail VivaHomeScroll"></div>':'<div id="VivaHomeMainContent" class="VivaHomeMainContent">\n                  <div id="VivaHomeSticky" class="VivaHomeSticky"></div>\n                </div>\n                <div id="VivaHomeRightRail" class="VivaHomeRightRail VivaHomeScroll"></div>'}\n              ${this.isVivaHomeAccessibilityFixesKSActivated?"</div>":"</main>"}\n            </div>\n          </div>\n        </div>`)}style(){if(this._removeSWRenderKSActivated){const e={neutralLighter:"#f5f5f5",neutralQuaternary:"#ebebeb",black:"#242424",blackTranslucent40:"rgba(0,0,0,.4)",bodyBackgroundColor:"#ffffff"};return super.style()+`\n      .VivaHome{flex-direction:column; font-family:'Segoe UI', -apple-system, BlinkMacSystemFont; background-color: ${e.neutralLighter};}\n      .VivaHomeFlexDisplay{display: flex;}\n      .VivaHome .VivaHomeTopBar{flex-grow:0;}\n      .VivaHomeTopBar{display:flex; flex:0 0 60px; align-items:center; padding:0 24px;}\n      .StickyTopBar{z-index: 2; position: sticky; -webkit-position: sticky; top: 0px; background-color: ${e.neutralLighter}; border-bottom: 1px solid ${e.neutralQuaternary};}\n      .VivaHomeHero{min-height:204px; margin:0 24px; font-size:24px; color:${e.black};}\n      .VivaHomeHeroContent{min-height: 132px; padding: 36px 35px 0 35px; margin-bottom: 36px; border-radius: 8px; background-image: linear-gradient(to right top, #dff5fe, #dcf4fe, #d8f4fe, #d5f3fe, #d1f3fe, #cbf0fd, #c6edfd, #c0eafc, #b9e3fa, #b2dcf8, #aed5f6, #aacef4); background-repeat:no-repeat; background-size:cover;}\n      .VivaHomeRightRail{flex:0 0 300px; margin-top:33px; margin-top:33px;}\n      .VivaHomeContent{flex:1; min-height:0; display:flex;}\n      .VivaHomeMainContent ${this.isFixMainContentWidthKSActivated?"{}":"{width: calc(100% - 360px);}"}\n      ${this.isNewScrollForVivaHomePageLayoutKSActivated?`.VivaHomeMainContentOldScroll{flex-grow:1; background:${e.bodyBackgroundColor}; padding:32px 48px; border-radius:8px; margin:0 60px;}\n      .VivaHomePageContainOldScroll{display:flex;flex:1; min-height:0; flex-direction:column; position:relative;}`:`.VivaHomeSticky{position:sticky;position: -webkit-sticky;top:0;background:${e.bodyBackgroundColor}; padding:32px 48px; border-radius:8px; margin:0 60px;}\n      .VivaHome .VivaHomePageContain{flex: 1;position: relative;overflow-y: auto;display: block; padding-top:24px;}`}\n      .VivaHomeScroll::-webkit-scrollbar{width: 6px; height: 6px;}\n      .VivaHomeScroll::-webkit-scrollbar-thumb{background-color: ${e.blackTranslucent40}; border-radius: 10px;}\n      @media(max-width: 1298px) {\n        .VivaHome {overflow-y: auto;}\n        .VivaHomeContent {flex-wrap: wrap;}\n        .VivaHomeMainContent {overflow: visible; flex-basis: 100%;}\n        .VivaHomeRightRail {margin: 33px 60px 0 60px;padding: 0 64px;overflow: visible;}\n      }`}return super.style()}renderSplash(e){}get navigationResultKey(){return Object(s.t)(s.e.vivaHomeNavResultKeys)?super.navigationResultKey:this._isOptOutDisabled?"disableOptOut":"default"}qosData(){return Object(s.t)(s.e.vivaHomeTelemetry)?super.qosData():Object.assign(Object.assign({},super.qosData()),{evaluatedRedirection:this._isRedirectionEvaluated,redirectingToVivaHome:this._isRedirectingToVivaHome,redirectingToSpPages:this._isRedirectingToSpPages,redirectingToCachedUrl:this._isRedirectingToCachedUrl})}get _isNonVivaHomeRedirect(){return this.redirectUrl&&-1===this.redirectUrl.toLowerCase().indexOf(Xe)}_renderRedirectToDest(e,t){if((t||this.redirectUrl)&&this._allowRedirect){const n=new URL(t||this.redirectUrl);n.searchParams.set("useSecureBroker","true"),this.url.searchParams.forEach((e,t)=>{n.searchParams.set(t,e)});const a=n.origin;return this._isNonVivaHomeRedirect&&a!==this.url.origin&&(n.pathname=`${n.pathname}${n.pathname.endsWith("/")?"":"/"}${Xe}`),this._isRedirectingToSpPages=this._isNonVivaHomeRedirect,this._isRedirectingToVivaHome=!this._isNonVivaHomeRedirect,this.redirect(n.href,e)}}get _allowRedirect(){return"true"!==new URL(this.url.toString().toLowerCase()).searchParams.get(Ze)}get _isOptOutDisabled(){return"true"===new URL(this.url.toString().toLowerCase()).searchParams.get($e)}get _hasConflictingOptOut(){const e=this.optOutFlag;return"true"===new URL(this.url.toString().toLowerCase()).searchParams.get($e)&&e}_redirectToCachedDest(){return this._isRedirectingToCachedUrl=!0,this._isRedirectionEvaluated=!0,Promise.resolve(this._renderRedirectToDest.bind(this))}_redirectToUpdatedDest(){return this._isRedirectionEvaluated=!0,this.preloadResponseReady.then(()=>e=>{if(this.redirectUrl){const t=new URL(this.redirectUrl.toLowerCase());t.searchParams.set(Ze,"true"),this._renderRedirectToDest(e,t.toString())}})}get _removeSWRenderKSActivated(){return Object(s.t)(s.e.removeVHSWRender)}}const tt="VivaHome";class nt extends w{constructor(){super(...arguments),this.applicationId=tt}knownPaths(){return[{path:"/_layouts/15/vivahome.aspx"}]}createContext(){return new E}precachedComponents(e){return[A.e.VivaHomeAssembly,A.e.VivaHomeApplication,A.e.DashboardWebPart,A.e.ACEWebpart,A.e.IsolatedACEWebpart,A.e.CompanyFeedWebPart]}createNavigationHandler(e){return new et(this,e)}}class at extends k.e{constructor(e,t){super(e,t),this.componentId=A.e.VinciApplication,this.assemblyId=A.e.VinciAssembly,this.startOffline=!0}get preloadedData(){return this.navigationResult}renderPhases(){return[this.shell(),this.start()]}renderStart(e){super.renderStart(e)}}const it="Vinci";class rt extends w{constructor(){super(...arguments),this.applicationId=it}knownPaths(){return[{path:"/_layouts/15/Vinci.aspx"}]}createContext(){return new E}precachedComponents(e){return[A.e.VinciAssembly,A.e.VinciApplication]}createNavigationHandler(e){return new at(this,e)}}var ot,st=n(6);!function(e){e.Name="Clipchamp.Cache",e.AssetStoreName="assets",e.AssetStoreKeyPath="permanentUrl"}(ot||(ot={}));class ct extends st.t{constructor(){super(ot.Name,1)}getAssetObject(e){const t=this.store(ot.AssetStoreName);return this.get(e,t)}deleteAssetObject(e){const t=this.store(ot.AssetStoreName,st.e.ReadWrite);return this.delete(e,t)}upgrade(e,t){t.oldVersion<1&&this.createStore(ot.AssetStoreName,ot.AssetStoreKeyPath,e)}}class dt extends class{constructor(){this.memoryCache=new Map}delete(e){this.memoryCache.delete(e)}get(e){const t=this.memoryCache.get(e);if(t&&t.size>0)return t;this.delete(e)}}{cache(e,t){const n=t instanceof File?new Blob([t],{type:t.type}):t;this.memoryCache.set(e,n)}}const lt=/^bytes=(?<fromByte>[\d]+)\-(?<toByte>[\d]+)?$/,ut="public, immutable, max-age=31536000";function ft(e,t,n,a){return new self.Response(e,{status:206,headers:{"Cache-Control":ut,"Accept-Ranges":"bytes","Content-Range":`bytes ${t}-${n}/${a}`}})}class pt{constructor(e){this.database=e,this.memoryCache=new dt}routeRequestMethod(e){switch(e.request.method){case"GET":return this._serveAssetGetRequest(e);case"DELETE":return this._serveAssetDeleteRequest(e);default:return Promise.resolve(new self.Response(null,{status:405,statusText:"invalid method"}))}}_serveAssetGetRequest(e){return Object(T.t)(this,void 0,void 0,function*(){try{const t=yield this._retrieveAssetObject(e.request.url);return function(e,t){const n=e.request.headers.get("Range");if(n){const e=function(e){var t,n;const a=lt.exec(e);return a.length>=3?{fromByte:parseInt(null!==(t=a[1])&&void 0!==t?t:"",0),toByte:parseInt(null!==(n=a[2])&&void 0!==n?n:"",0)}:null}(n);if(e)return function(e,t,n){if(Number.isNaN(n)&&(n=e.size-1),t>0||n<e.size-1){if(t<e.size){const a=e.slice(t,n+1,e.type||"application/octet-stream");return ft(a,t,t+a.size-1,e.size)}return new self.Response(null,{status:416})}return ft(new Blob([e],{type:e.type}),0,e.size-1,e.size)}(t,e.fromByte,e.toByte)}return new self.Response(new Blob([t],{type:t.type}),{status:200,headers:{"Cache-Control":ut,"Accept-Ranges":"bytes"}})}(e,t.blob)}catch(a){try{throw new Error("Not Implemented.")}catch(a){return t=e.request.url,n=a,console.warn(`Permanently failed to serve resource ${t}`,n),new self.Response(null,{status:410,statusText:"failed to rehydrate"})}}var t,n})}_retrieveAssetObject(e){return Object(T.t)(this,void 0,void 0,function*(){const t=this.memoryCache.get(e);if(t)return{permanentUrl:e,blob:t};yield this.database.open();const n=yield this.database.getAssetObject(e);return this.database.close(),this.memoryCache.cache(e,n.blob),n})}_serveAssetDeleteRequest(e){return Object(T.t)(this,void 0,void 0,function*(){try{return yield this._deleteAssetObject(e.request.url),new self.Response(null,{status:200})}catch(e){const t=this._toErrorObject(e,"Delete request failed");return new self.Response(null,{status:503,statusText:t.message})}})}_deleteAssetObject(e){return Object(T.t)(this,void 0,void 0,function*(){this.memoryCache.delete(e),yield this.database.open(),this.database.deleteAssetObject(e),this.database.close()})}_toErrorObject(e,t){return e instanceof Error?e:new Error(t)}}class mt extends _{constructor(e,t){super(e,t),this.startOffline=!1}}const _t="Clipchamp";class ht extends x.t{constructor(){super(),this.applicationId=_t,this.database=new ct,this.assetCacheRequestHandler=new pt(this.database)}knownPaths(){return[{path:"/_layouts/15/videoeditor.aspx$",regex:!0}]}isFetchFromLocalCache(e){return e.includes("/local-cache/")}fetchFromLocalCache(e){return this.assetCacheRequestHandler.routeRequestMethod(e)}resourceRoutes(){return super.resourceRoutes().concat([{match:this.isFetchFromLocalCache.bind(this),fetch:this.fetchFromLocalCache.bind(this)}])}createContext(){return new f}createNavigationHandler(e){return new mt(this,e)}}const bt=self.location.host.includes("-my.sharepoint"),gt=!bt&&/microsoft-app[0-f]{32}.sharepoint.com/.test(self.location.host),vt=!bt&&!gt,yt=self.location.search.includes("&list=v2");class St extends r.t{createController(e){if(vt)switch(e){case Re:return new Ne;case tt:return new nt;case it:return new rt}if(vt||bt)switch(e){case z:return yt?new K:new we;case Pe:return new Ue;case je:return new ze;case Ke:return new We;case b:return new g;case D.e:return new P;case _t:return new ht}if((vt||gt)&&e===Ye)return new Je}createRouter(){return new y(this)}}self._postMessageController=new class{constructor(){this._serviceWorkerPostMessageReceivers=new Set,this._clients=new Map}onMessageReceived(e){if(e.data.openServiceWorkerChannel){let t=e.source.id;const n={port:e.ports[0],url:e.source.url.toLowerCase(),id:t};if(this._clients.has(t))this._clients.get(t).resolve(n);else{const e=new i;e.resolve(n),this._clients.set(t,e)}self.clients.matchAll().then(e=>{const n=e.map(e=>e.id);for(t of Array.from(this._clients.keys()))-1===n.indexOf(t)&&this._clients.delete(t)})}for(const t of Array.from(this._serviceWorkerPostMessageReceivers))t(e)}postDataToClient(e){const{getData:t,clientId:n}=e;return this._waitForChannelOpenForClient({clientId:n}).then(e=>{const{port:a,url:i}=e;return t().then(e=>{a.postMessage({isServiceWorkerPostMessageData:!0,data:e,client:{id:n,url:i}})})})}registerPostMessageReceiver(e,t){const n=n=>{const a=n.data;if(a.isAdhocPost&&a.postId&&a.postData.type===e){const e=n.ports[0];return t(a.postData).then(t=>{const n={isAdhocPost:!0,postId:a.postId,replyData:t};e.postMessage(n)})}return Promise.resolve()};return this._serviceWorkerPostMessageReceivers.add(n),()=>{this._serviceWorkerPostMessageReceivers.delete(n)}}_waitForChannelOpenForClient(e){const{clientId:t}=e;let n;return this._clients.has(t)?n=this._clients.get(t):(n=new i,this._clients.set(t,n)),n.promise}},self._telemetry=new a.e,(new St).start()}])});